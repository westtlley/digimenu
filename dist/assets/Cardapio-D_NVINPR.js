import{c as la,p as ze,u as is,j as e,d as Ye,e as ca,X as ge,P as pe,B as V,R as da,z as w,r as f,g as I,i as ns,L as ls,m as ma,S as Oe,F as Ut,n as ua}from"./main-AonIQAES.js";import{u as Z}from"./useQuery-1B__UZCp.js";import{u as jt}from"./useMutation--pPw_T_d.js";import{L as K,I as H}from"./input-BZMCG3xh.js";import{u as xa,N as ha,P as pa,U as ga}from"./useUpsell-By5upzyX.js";import{D as cs,u as ds,a as fa,b as ba,C as ya,c as ja,o as Pe}from"./useCart-CW5LrpbV.js";import{D as va,a as wa}from"./dialog-LI6mGNSb.js";import{b as ne}from"./base44Client-DnnNNlVu.js";import{B as Te}from"./badge-VNLW5sw5.js";import{A as me}from"./index-C7_vRD1M.js";import{m as E}from"./proxy-DNI-KLs9.js";import{C as Re}from"./clock-C5Rng7N-.js";import{S as Na}from"./settings-86dQDP0i.js";import{B as ka}from"./ticket-DIxUtuYp.js";import{C as Bt}from"./circle-check-big-BQQ24GbH.js";import{M as Xe}from"./map-pin-u_JGe0km.js";import{T as Je}from"./truck-D6zUN2Zr.js";import{f as _a}from"./format-DzdVs_Wz.js";import{P as Ca}from"./plus-BWjW9AHH.js";import{C as ms}from"./chevron-left-CGYPxvKO.js";import{C as us}from"./chevron-right-Rddi3YzB.js";import{B as Sa,P as Pa,a as za,S as pt,I as Wt,F as Vt,M as Ht,b as $a,c as Da,d as Fa,e as Aa,w as gt}from"./whatsappService-QA_X1zh_.js";import{f as he}from"./formatters-CvOEClq0.js";import{Z as xs}from"./zap-D-FDPwOP.js";import"./alert-dialog-CykeUtNX.js";import{T as Ea}from"./textarea-DMRLefWJ.js";import{C as oe,a as Qe,b as Ze,d as ft,c as ie}from"./card-GW57779a.js";import"./separator-DMZSH5Dc.js";import{a as bt,b as Oa,C as Ma}from"./dateUtils-DeGNBYqD.js";import"./progress-BYauDPAX.js";import{u as Ta}from"./useSlugContext-CNsGQFhv.js";import{U as ve}from"./user-BGJXDF4u.js";import{C as Ra}from"./camera-CSWVa72F.js";import{M as Kt}from"./mail-DRqPzMLJ.js";import{A as Gt}from"./award-MUUfRoIl.js";import{H as Qt}from"./history-Bm8QX0qR.js";import{M as $e}from"./message-square-OwMCnJSp.js";import{P as hs}from"./phone-CVcoPlft.js";import{S as Ia}from"./save-DRNwR1Re.js";import{L as La}from"./log-out-DfGDd85T.js";import{C as Zt}from"./credit-card-Baa4ESW4.js";import{T as Yt}from"./trending-up-CEWXgtY8.js";import{S as kt}from"./star-4jmeOV9l.js";import{T as yt}from"./ThemeToggle-HIuoPqx2.js";import{v as qa}from"./cpfValidator-BjAD6qbQ.js";import{G as we}from"./gift-CnUYH84S.js";import{C as Ua}from"./circle-check-Bh8q0Br5.js";import{I as Jt}from"./InstallAppButton-D58KAayQ.js";import{S as ps}from"./sparkles-BpSaorR-.js";import{S as ye}from"./shopping-cart-Ur_1HrJq.js";import{M as Ba}from"./message-circle-s-Hh0I0Z.js";import{S as Wa,u as Va,H as Ha,L as Ka}from"./useDocumentHead-BHKxsTKl.js";import{C as Ga}from"./check-CPlY7ZZw.js";import{l as Qa}from"./index-CL3SdtP1.js";import{S as Xt}from"./search-Sb5SY96K.js";import{C as Za}from"./calendar-BWMBrEkL.js";import"./index-CXHrl_Fq.js";import"./play-DZUzSGam.js";import"./chevron-down-W9Dhjl9M.js";import"./shopping-bag-5XiLebFV.js";import"./chef-hat-DUqumxLr.js";import"./minus-BcVwmOP2.js";import"./differenceInCalendarDays-DRQCwW68.js";import"./constants-CG7Neo-X.js";import"./trash-2-eTZTaYxL.js";import"./select-BsJPtTd1.js";import"./index-CaNfpB9J.js";import"./index-BQa84rXG.js";import"./index-BBieB--f.js";import"./index-Diz3LxqQ.js";import"./navigation-C5CV02Fx.js";import"./dollar-sign-B5ekxtL2.js";import"./cepService-BFcvLHg_.js";import"./store-DsTxvmXo.js";import"./sun-CfH9NmRq.js";import"./download-DZ9qjCkK.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],vt=la("Heart",Ya),es={new:{label:"Novo",color:"bg-blue-500",icon:Re},accepted:{label:"Aceito",color:"bg-green-500",icon:pe},preparing:{label:"Preparando",color:"bg-yellow-500",icon:pe},ready:{label:"Pronto",color:"bg-purple-500",icon:Bt},going_to_store:{label:"Entregador indo ao Restaurante",color:"bg-blue-400",icon:Je},arrived_at_store:{label:"Entregador no Restaurante",color:"bg-blue-500",icon:pe},picked_up:{label:"Pedido Coletado",color:"bg-green-500",icon:pe},out_for_delivery:{label:"Saiu para Entrega",color:"bg-indigo-500",icon:Je},arrived_at_customer:{label:"Entregador Chegou",color:"bg-green-500",icon:Xe},delivered:{label:"Entregue",color:"bg-green-600",icon:Bt},cancelled:{label:"Cancelado",color:"bg-red-500",icon:ka}};function Ja({isOpen:t,onClose:i,primaryColor:o="#f97316",onReorder:x=null}){const[l,h]=ze.useState(!1),[s,u]=ze.useState(null),[a,r]=ze.useState(0),[c,d]=ze.useState(0),[p,N]=ze.useState(""),k=is(),{data:P=[],isLoading:v}=Z({queryKey:["myOrders"],queryFn:async()=>{try{const y=await ne.auth.me();return h(y?.role==="admin"),(await ne.entities.Order.list("-created_date")).filter(Y=>Y.customer_email===y.email||Y.created_by===y.email)}catch{return[]}},enabled:t,refetchInterval:3e3}),b=jt({mutationFn:async({orderId:y,ratings:T})=>{const Y=P.find(J=>J.id===y);Y.entregador_id&&T.deliveryRating>0&&await ne.entities.DeliveryRating.create({order_id:y,entregador_id:Y.entregador_id,rating:T.deliveryRating,comment:T.comment,rated_by:"customer"}),await ne.entities.Order.update(y,{...Y,restaurant_rating:T.restaurantRating,rating_comment:T.comment})},onSuccess:()=>{k.invalidateQueries({queryKey:["myOrders"]}),u(null),r(0),d(0),N(""),alert("AvaliaÃ§Ã£o enviada! Obrigado pelo feedback.")}}),z=()=>{if(a===0){alert("Por favor, avalie o restaurante");return}b.mutate({orderId:s.id,ratings:{restaurantRating:a,deliveryRating:s.delivery_method==="delivery"?c:0,comment:p}})},$=y=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(y||0);return t?e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsx(E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center md:items-stretch md:justify-end justify-center p-4 md:p-0",onClick:i,children:e.jsxs(E.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"tween",duration:.3},onClick:y=>y.stopPropagation(),className:"bg-white md:rounded-none rounded-2xl shadow-2xl w-full md:w-[400px] max-w-lg md:max-w-none h-auto md:h-full max-h-[85vh] md:max-h-none overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5",style:{color:o}}),e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Meus Pedidos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l&&e.jsx(Ye,{to:ca("Admin"),children:e.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",title:"Acessar Admin",children:e.jsx(Na,{className:"w-5 h-5 text-gray-600"})})}),e.jsx("button",{onClick:i,className:"p-2 rounded-lg hover:bg-gray-100",children:e.jsx(ge,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):P.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(pe,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum pedido encontrado"})]}):P.map(y=>{const T=es[y.status]||es.new,Y=T.icon;return e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-sm",children:["Pedido #",y.order_code||y.id?.slice(-6)]}),e.jsx("p",{className:"text-xs text-gray-500",children:y.created_date&&_a(new Date(y.created_date),"dd/MM/yyyy HH:mm")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Te,{className:`${T.color} text-white flex items-center gap-1`,children:[e.jsx(Y,{className:"w-3 h-3"}),T.label]}),y.status==="delivered"&&!y.restaurant_rating&&e.jsx("button",{onClick:()=>u(y),className:"text-xs px-3 py-1 bg-amber-500 text-white rounded-full hover:bg-amber-600 transition-colors",children:"â­ Avaliar"}),y.restaurant_rating&&e.jsxs("span",{className:"text-xs text-amber-600",children:["â­ ",y.restaurant_rating,"/5"]})]})]}),y.status==="arrived_at_customer"&&y.delivery_code&&e.jsxs("div",{className:"bg-yellow-100 border-2 border-yellow-400 rounded-lg p-3 mb-3 text-center",children:[e.jsx("p",{className:"text-xs text-yellow-800 font-medium mb-1",children:"CÃ³digo de ValidaÃ§Ã£o"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900 tracking-widest",children:y.delivery_code}),e.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"ForneÃ§a ao entregador"})]}),e.jsx("div",{className:"space-y-2 mb-3",children:y.items?.map((J,re)=>e.jsxs("div",{className:"text-xs border-l-2 border-gray-300 pl-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-500 font-medium",children:[J.quantity||1,"x"]}),e.jsx("span",{className:"text-gray-900 font-semibold flex-1",children:J.dish?.name}),e.jsx("span",{className:"text-gray-900 font-medium",children:$(J.totalPrice*(J.quantity||1))})]}),J.selections&&Object.keys(J.selections).length>0&&e.jsx("div",{className:"ml-5 mt-1 space-y-0.5 text-gray-600",children:Object.entries(J.selections).map(([fe,le])=>Array.isArray(le)?le.map((B,ee)=>e.jsxs("p",{children:["â€¢ ",B.name]},ee)):le?e.jsxs("p",{children:["â€¢ ",le.name]},fe):null)})]},re))}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total"}),e.jsx("span",{className:"font-bold text-base",style:{color:o},children:$(y.total)})]}),y.delivery_method==="delivery"&&y.address&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500 flex items-start gap-1",children:[e.jsx(Je,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"line-clamp-1",children:y.address})]}),y.status==="delivered"&&x&&y.items&&y.items.length>0&&e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsxs(V,{onClick:()=>{x&&(x(y),w.success(`${y.items.length} itens adicionados ao carrinho!`),i())},variant:"outline",size:"sm",className:"w-full",children:[e.jsx(da,{className:"w-4 h-4 mr-2"}),"Pedir Novamente"]})})]},y.id)})})]})})}),s&&e.jsx(E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center p-4",onClick:()=>u(null),children:e.jsxs(E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:y=>y.stopPropagation(),className:"bg-white rounded-2xl p-6 max-w-md w-full shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Avalie sua experiÃªncia"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Pedido #",s.order_code]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("label",{className:"font-medium",children:"Restaurante"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(y=>e.jsx("button",{onClick:()=>r(y),className:"text-3xl transition-transform hover:scale-110",children:y<=a?"â­":"â˜†"},y))})]}),s.delivery_method==="delivery"&&e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("label",{className:"font-medium",children:"Entregador"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(y=>e.jsx("button",{onClick:()=>d(y),className:"text-3xl transition-transform hover:scale-110",children:y<=c?"â­":"â˜†"},y))})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("label",{className:"font-medium",children:"ComentÃ¡rio (opcional)"}),e.jsx("textarea",{value:p,onChange:y=>N(y.target.value),placeholder:"Conte-nos sobre sua experiÃªncia...",className:"w-full p-3 border rounded-lg resize-none",rows:3})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>u(null),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{onClick:z,disabled:a===0||b.isPending,className:"flex-1 px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 disabled:opacity-50",children:b.isPending?"Enviando...":"Enviar"})]})]})})]}):null}function gs(){return e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm border animate-pulse",children:[e.jsx("div",{className:"relative h-48 bg-gray-200"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded mb-2 w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-3 w-full"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-9 bg-gray-200 rounded w-24"})]})]})]})}function Xa({dishes:t,onDishClick:i,primaryColor:o,textPrimaryColor:x,loading:l=!1,stockUtils:h,slug:s=null}){return l?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-3 lg:gap-4",children:[1,2,3,4,5,6,7,8].map(u=>e.jsx(gs,{},u))}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-3 lg:gap-4",children:t.map((u,a)=>{const r=h?.isOutOfStock?.(u.stock),c=h?.isLowStock?.(u.stock);return e.jsx(cs,{dish:u,onClick:i,index:a,isOutOfStock:r,isLowStock:c,primaryColor:o,textPrimaryColor:x,slug:s},u.id)})})}function er({dishes:t,onDishClick:i,primaryColor:o,textPrimaryColor:x,textSecondaryColor:l,loading:h=!1,stockUtils:s,formatCurrency:u}){return h?e.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(a=>e.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-800 rounded-lg animate-pulse"},a))}):e.jsx("div",{className:"space-y-3",children:t.map((a,r)=>{const c=s?.isOutOfStock?.(a.stock);return s?.isLowStock?.(a.stock),e.jsxs(E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:r*.05},onClick:()=>!c&&i(a),className:`
              flex items-center gap-4 p-4 rounded-xl border-2 transition-all cursor-pointer
              ${c?"opacity-50 cursor-not-allowed border-gray-200 dark:border-gray-700":"hover:shadow-lg border-gray-200 dark:border-gray-700 hover:border-opacity-80"}
            `,style:c?{}:{borderColor:"transparent"},children:[e.jsxs("div",{className:"w-24 h-24 md:w-28 md:h-28 rounded-lg overflow-hidden flex-shrink-0",children:[a.image?e.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-3xl",children:"ðŸ½ï¸"}),c&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"Esgotado"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("h3",{className:"font-bold text-base md:text-lg line-clamp-2",style:{color:x||"inherit"},children:a.name}),a.is_highlight&&e.jsx("span",{className:"text-yellow-500 text-sm",children:"â­"}),a.is_new&&e.jsx("span",{className:"text-green-500 text-xs font-bold bg-green-100 dark:bg-green-900 px-2 py-0.5 rounded",children:"NOVO"})]}),a.description&&e.jsx("p",{className:"text-sm line-clamp-2 mb-2",style:{color:l||"inherit"},children:a.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xl font-bold",style:{color:o},children:u?.(a.price)||`R$ ${a.price?.toFixed(2)||"0,00"}`}),!c&&e.jsx("button",{onClick:d=>{d.stopPropagation(),i(a)},className:"p-2 rounded-lg transition-colors",style:{backgroundColor:o,color:"white"},children:e.jsx(Ca,{className:"w-5 h-5"})})]})]})]},a.id)})})}function tr({dishes:t,onDishClick:i,primaryColor:o,textPrimaryColor:x,textSecondaryColor:l,loading:h=!1,stockUtils:s,formatCurrency:u}){const a=f.useRef(null),r=c=>{if(a.current){const d=window.innerWidth<768?280:320;a.current.scrollBy({left:c==="left"?-d:d,behavior:"smooth"})}};return h?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-3 lg:gap-4",children:[1,2,3,4].map(c=>e.jsx(gs,{},c))}):e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>r("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 p-2 md:p-3 rounded-full bg-white dark:bg-gray-800 shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all",style:{color:o},children:e.jsx(ms,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx("div",{ref:a,className:"flex gap-3 md:gap-4 overflow-x-auto scrollbar-hide scroll-smooth pb-4 px-10 md:px-12",style:{scrollSnapType:"x mandatory"},children:t.map((c,d)=>{const p=s?.isOutOfStock?.(c.stock);return s?.isLowStock?.(c.stock),e.jsx("div",{className:"flex-shrink-0 w-[280px] md:w-72",style:{scrollSnapAlign:"start"},children:e.jsxs(E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:d*.1},onClick:()=>!p&&i(c),className:`
                  bg-white dark:bg-gray-900 rounded-xl overflow-hidden shadow-md border-2 transition-all cursor-pointer
                  ${p?"opacity-50 cursor-not-allowed border-gray-200 dark:border-gray-700":"hover:shadow-xl border-gray-200 dark:border-gray-700 hover:scale-[1.02]"}
                `,style:p?{}:{borderColor:"transparent"},children:[e.jsxs("div",{className:"w-full h-56 md:h-48 bg-gray-100 dark:bg-gray-800 overflow-hidden",children:[c.image?e.jsx("img",{src:c.image,alt:c.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-5xl",children:"ðŸ½ï¸"}),p&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:"Esgotado"})}),e.jsxs("div",{className:"absolute top-2 left-2 flex flex-col gap-1",children:[c.is_new&&e.jsx("span",{className:"px-2 py-1 bg-green-500 text-white text-xs font-bold rounded-full",children:"âœ¨ NOVO"}),c.is_popular&&e.jsx("span",{className:"px-2 py-1 bg-purple-500 text-white text-xs font-bold rounded-full",children:"ðŸ”¥ POPULAR"})]}),c.original_price&&c.original_price>c.price&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs("span",{className:"px-2 py-1 bg-red-500 text-white text-xs font-bold rounded-full",children:["-",Math.round((c.original_price-c.price)/c.original_price*100),"%"]})})]}),e.jsxs("div",{className:"p-4 md:p-3",children:[e.jsx("h3",{className:"font-bold text-base md:text-sm mb-2 line-clamp-2 min-h-[2.5rem] md:min-h-[2rem]",style:{color:x||"inherit"},children:c.name}),c.description&&e.jsx("p",{className:"text-xs line-clamp-2 mb-3 md:mb-2",style:{color:l||"inherit"},children:c.description}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[c.original_price&&c.original_price>c.price&&e.jsx("span",{className:"text-sm text-gray-400 line-through",children:u?.(c.original_price)}),e.jsx("span",{className:"text-xl md:text-lg font-bold",style:{color:o},children:u?.(c.price)||"R$ 0,00"})]})]})]})},c.id)})}),e.jsx("button",{onClick:()=>r("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 p-2 md:p-3 rounded-full bg-white dark:bg-gray-800 shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all",style:{color:o},children:e.jsx(us,{className:"w-5 h-5 md:w-6 md:h-6"})})]})}function sr({dishes:t,onDishClick:i,primaryColor:o,textPrimaryColor:x,textSecondaryColor:l,loading:h=!1,stockUtils:s,formatCurrency:u}){const[a,r]=f.useState(0),c=t.length;if(h)return e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"w-full max-w-md h-96 bg-gray-200 dark:bg-gray-800 rounded-lg animate-pulse"})});if(t.length===0)return e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-muted-foreground",children:"Nenhum prato encontrado"})});const d=t[a],p=s?.isOutOfStock?.(d?.stock),N=()=>{a<c-1&&r(a+1)},k=()=>{a>0&&r(a-1)},P={enter:y=>({x:y==="next"?"100%":"-100%",opacity:0,rotateY:y==="next"?90:-90}),center:{x:0,opacity:1,rotateY:0},exit:y=>({x:y==="next"?"-100%":"100%",opacity:0,rotateY:y==="next"?-90:90})},[v,b]=f.useState("next"),z=()=>{b("next"),N()},$=()=>{b("prev"),k()};return e.jsxs("div",{className:"relative w-full",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[e.jsx(Sa,{className:"w-4 h-4",style:{color:o}}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["PÃ¡gina ",a+1," de ",c]})]}),e.jsxs("div",{className:"relative w-full max-w-4xl mx-auto",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"relative aspect-[4/3] bg-white dark:bg-gray-900 rounded-2xl shadow-2xl overflow-hidden border-2 border-gray-200 dark:border-gray-700",children:e.jsx(me,{mode:"wait",custom:v,children:e.jsxs(E.div,{custom:v,variants:P,initial:"enter",animate:"center",exit:"exit",transition:{duration:.6,ease:[.4,0,.2,1]},className:"absolute inset-0 flex",style:{perspective:"1000px"},children:[e.jsxs("div",{className:"w-1/2 relative overflow-hidden",children:[d?.image?e.jsx("img",{src:d.image,alt:d.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-gray-800 text-6xl",children:"ðŸ½ï¸"}),p&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"Esgotado"})})]}),e.jsxs("div",{className:"w-1/2 p-8 flex flex-col justify-between bg-gradient-to-br from-gray-50 to-white dark:from-gray-900 dark:to-gray-800",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",style:{color:x||"inherit"},children:d?.name}),d?.description&&e.jsx("p",{className:"text-base mb-6 leading-relaxed",style:{color:l||"inherit"},children:d.description}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[d?.is_highlight&&e.jsx("span",{className:"text-2xl",children:"â­"}),d?.is_new&&e.jsx("span",{className:"px-3 py-1 bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded-full text-xs font-bold",children:"NOVO"}),d?.is_popular&&e.jsx("span",{className:"px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded-full text-xs font-bold",children:"ðŸ”¥ POPULAR"})]})]}),e.jsxs("div",{className:"flex items-baseline gap-3",children:[d?.original_price&&d.original_price>d.price&&e.jsx("span",{className:"text-xl text-gray-400 line-through",children:u?.(d.original_price)}),e.jsx("span",{className:"text-4xl font-bold",style:{color:o},children:u?.(d?.price)||"R$ 0,00"})]})]})]},a)})})}),e.jsx("div",{className:"md:hidden",children:e.jsx("div",{className:"relative min-h-[70vh] bg-white dark:bg-gray-900 rounded-2xl shadow-2xl overflow-hidden border-2 border-gray-200 dark:border-gray-700",children:e.jsx(me,{mode:"wait",custom:v,children:e.jsxs(E.div,{custom:v,variants:{enter:y=>({y:y==="next"?"100%":"-100%",opacity:0,rotateX:y==="next"?90:-90}),center:{y:0,opacity:1,rotateX:0},exit:y=>({y:y==="next"?"-100%":"100%",opacity:0,rotateX:y==="next"?-90:90})},initial:"enter",animate:"center",exit:"exit",transition:{duration:.6,ease:[.4,0,.2,1]},className:"absolute inset-0 flex flex-col",style:{perspective:"1000px"},children:[e.jsxs("div",{className:"w-full h-64 relative overflow-hidden",children:[d?.image?e.jsx("img",{src:d.image,alt:d.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-gray-800 text-5xl",children:"ðŸ½ï¸"}),p&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:"Esgotado"})})]}),e.jsxs("div",{className:"flex-1 p-6 flex flex-col justify-between bg-gradient-to-br from-gray-50 to-white dark:from-gray-900 dark:to-gray-800",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-3",style:{color:x||"inherit"},children:d?.name}),d?.description&&e.jsx("p",{className:"text-sm mb-4 leading-relaxed",style:{color:l||"inherit"},children:d.description}),e.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[d?.is_highlight&&e.jsx("span",{className:"text-xl",children:"â­"}),d?.is_new&&e.jsx("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded-full text-xs font-bold",children:"NOVO"}),d?.is_popular&&e.jsx("span",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded-full text-xs font-bold",children:"ðŸ”¥ POPULAR"})]})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[d?.original_price&&d.original_price>d.price&&e.jsx("span",{className:"text-lg text-gray-400 line-through",children:u?.(d.original_price)}),e.jsx("span",{className:"text-3xl font-bold",style:{color:o},children:u?.(d?.price)||"R$ 0,00"})]})]})]},a)})})})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-6",children:[e.jsx("button",{onClick:$,disabled:a===0,className:"p-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg",style:{backgroundColor:a===0?"transparent":o,color:a===0?"#9ca3af":"white"},children:e.jsx(ms,{className:"w-6 h-6"})}),e.jsx("div",{className:"flex gap-2",children:Array.from({length:Math.min(c,10)}).map((y,T)=>e.jsx("button",{onClick:()=>{b(T>a?"next":"prev"),r(T)},className:`w-2 h-2 rounded-full transition-all ${T===a?"opacity-100 scale-125":"opacity-30"}`,style:{backgroundColor:o}},T))}),e.jsx("button",{onClick:z,disabled:a===c-1,className:"p-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg",style:{backgroundColor:a===c-1?"transparent":o,color:a===c-1?"#9ca3af":"white"},children:e.jsx(us,{className:"w-6 h-6"})})]})]})}function ar({dishes:t,onDishClick:i,primaryColor:o,textPrimaryColor:x,textSecondaryColor:l,loading:h=!1,stockUtils:s,formatCurrency:u}){if(h)return e.jsx("div",{className:"columns-2 md:columns-3 lg:columns-4 gap-4",children:[1,2,3,4,5,6,7,8].map(r=>e.jsx("div",{className:"mb-4 h-64 bg-gray-200 dark:bg-gray-800 rounded-lg animate-pulse break-inside-avoid"},r))});const a=(r,c)=>{const p=c%4*30,N=r.description?40:0;return 200+p+N};return e.jsx("div",{className:"columns-2 md:columns-3 lg:columns-4 gap-4 md:gap-6",children:t.map((r,c)=>{const d=s?.isOutOfStock?.(r.stock),p=a(r,c);return e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:c*.05},onClick:()=>!d&&i(r),className:`
              mb-4 md:mb-6 rounded-xl overflow-hidden border-2 transition-all cursor-pointer break-inside-avoid
              bg-white dark:bg-gray-900 shadow-md hover:shadow-xl
              ${d?"opacity-50 cursor-not-allowed border-gray-200 dark:border-gray-700":"hover:scale-[1.02] border-gray-200 dark:border-gray-700"}
            `,style:d?{}:{borderColor:"transparent"},children:[e.jsxs("div",{className:"w-full overflow-hidden bg-gray-100 dark:bg-gray-800 relative",style:{height:`${p}px`},children:[r.image?e.jsx("img",{src:r.image,alt:r.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-5xl",children:"ðŸ½ï¸"}),d&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"Esgotado"})}),e.jsxs("div",{className:"absolute top-2 left-2 flex flex-col gap-1",children:[r.is_new&&e.jsx("span",{className:"px-2 py-1 bg-green-500 text-white text-xs font-bold rounded-full shadow-lg",children:"âœ¨ NOVO"}),r.is_popular&&e.jsx("span",{className:"px-2 py-1 bg-purple-500 text-white text-xs font-bold rounded-full shadow-lg",children:"ðŸ”¥ POPULAR"})]}),r.original_price&&r.original_price>r.price&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs("span",{className:"px-2 py-1 bg-red-500 text-white text-xs font-bold rounded-full shadow-lg",children:["-",Math.round((r.original_price-r.price)/r.original_price*100),"%"]})})]}),e.jsxs("div",{className:"p-3 md:p-4 bg-white dark:bg-gray-900",children:[e.jsx("h3",{className:"font-bold text-sm md:text-base mb-2 line-clamp-2",style:{color:x||"inherit"},children:r.name}),r.description&&e.jsx("p",{className:"text-xs md:text-sm line-clamp-3 mb-3",style:{color:l||"inherit"},children:r.description}),e.jsxs("div",{className:"flex items-baseline gap-2 flex-wrap",children:[r.original_price&&r.original_price>r.price&&e.jsx("span",{className:"text-sm text-gray-400 line-through",children:u?.(r.original_price)}),e.jsx("span",{className:"text-lg md:text-xl font-bold",style:{color:o},children:u?.(r.price)||"R$ 0,00"})]})]})]},r.id)})})}function rr({layout:t="grid",dishes:i,onDishClick:o,primaryColor:x,textPrimaryColor:l,textSecondaryColor:h,loading:s,stockUtils:u,formatCurrency:a,slug:r=null}){const c={dishes:i,onDishClick:o,primaryColor:x,textPrimaryColor:l,textSecondaryColor:h,loading:s,stockUtils:u,formatCurrency:a,slug:r};switch(t){case"list":return e.jsx(er,{...c});case"carousel":return e.jsx(tr,{...c});case"magazine":return e.jsx(sr,{...c});case"masonry":return e.jsx(ar,{...c});case"grid":default:return e.jsx(Xa,{...c})}}function or({promotions:t=[],dishes:i=[],primaryColor:o,onSelectPromotion:x,store:l}){if(t.length===0)return null;const h=l?.free_delivery_threshold&&l.free_delivery_threshold>0;return e.jsxs("section",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xs,{className:"w-5 h-5 fill-yellow-400 text-yellow-400"}),e.jsx("h2",{className:"font-bold text-lg",children:"PromoÃ§Ãµes Ativas"})]}),h&&e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-4 bg-gradient-to-r from-green-500 to-green-600 rounded-2xl overflow-hidden shadow-lg",children:e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 flex-shrink-0 bg-white/20 rounded-xl flex items-center justify-center",children:e.jsx(Je,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{className:"flex-1 text-white",children:[e.jsx("h3",{className:"font-bold text-base md:text-lg mb-1",children:"Entrega grÃ¡tis em algumas regiÃµes"}),e.jsx("p",{className:"text-sm md:text-base opacity-90",children:"Aproveite jÃ¡!"})]})]})}),e.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:t.slice(0,4).map(s=>{const u=i.find(r=>r.id===s.offer_dish_id);if(!u)return null;const a=s.original_price>s.offer_price?Math.round((s.original_price-s.offer_price)/s.original_price*100):0;return e.jsxs(E.div,{whileHover:{y:-4,scale:1.02},className:"relative rounded-2xl overflow-hidden shadow-lg cursor-pointer border-2",style:{borderColor:o+"40",background:`linear-gradient(135deg, ${o}dd, ${o}bb)`},onClick:()=>x&&x(u),children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),e.jsxs("div",{className:"relative p-4 flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 flex-shrink-0 rounded-xl overflow-hidden bg-white/20 shadow-lg",children:u.image?e.jsx("img",{src:u.image,alt:u.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-2xl",children:"ðŸ½ï¸"})}),e.jsxs("div",{className:"flex-1 text-white",children:[e.jsxs(Te,{className:"bg-yellow-400 text-black mb-2 font-bold",children:[e.jsx(Pa,{className:"w-3 h-3 mr-1"}),"-",a,"%"]}),e.jsx("h3",{className:"font-bold text-base mb-1",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.original_price>s.offer_price&&e.jsx("span",{className:"text-sm line-through opacity-75",children:he(s.original_price)}),e.jsx("span",{className:"text-xl font-bold",children:he(s.offer_price)})]})]})]})]},s.id)})})]})}function ir({dishes:t=[],onSelectDish:i,primaryColor:o}){const{data:x=[]}=Z({queryKey:["myRecentOrders"],queryFn:async()=>{try{const a=await ne.auth.me();return(await ne.entities.Order.list("-created_date")).filter(c=>c.customer_email===a.email||c.created_by===a.email).slice(0,3)}catch{return[]}}});if(x.length===0)return null;const l=new Set;x.forEach(a=>{a.items?.forEach(r=>{r.dish?.id&&l.add(r.dish.id)})});const s=(Array.isArray(t)?t:[]).filter(a=>!(!l.has(a.id)||a.is_active===!1||!a.name||a.name.trim()===""||a.product_type!=="pizza"&&(a.price===null||a.price===void 0))).slice(0,4);if(s.length===0)return null;const u=a=>{let r=0;return x.forEach(c=>{c.items?.forEach(d=>{d.dish?.id===a&&(r+=d.quantity||1)})}),r};return e.jsxs("section",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Re,{className:"w-4 h-4",style:{color:o}}),e.jsx("h2",{className:"font-bold text-sm md:text-base text-foreground",children:"PeÃ§a de Novo"})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide pb-1",children:s.map(a=>{const r=u(a.id);return e.jsxs(E.div,{whileHover:{y:-2,scale:1.02},className:"flex-shrink-0 w-28 md:w-32 bg-card rounded-xl overflow-hidden shadow-sm border border-border cursor-pointer",onClick:()=>i(a),children:[e.jsxs("div",{className:"relative h-20 md:h-24 bg-gray-100 dark:bg-gray-800",children:[a.image?e.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xl",children:"ðŸ½ï¸"}),r>1&&e.jsxs("div",{className:"absolute top-1 left-1 bg-black/60 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full backdrop-blur-sm",children:[r,"x"]})]}),e.jsxs("div",{className:"p-2",children:[e.jsx("h3",{className:"font-medium text-xs mb-1 line-clamp-2 min-h-[2rem] text-foreground",children:a.name}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"font-bold text-sm",style:{color:o},children:he(a.price)})})]})]},a.id)})})]})}const ts={new:{label:"Novo",color:"bg-blue-100 text-blue-800"},accepted:{label:"Aceito",color:"bg-purple-100 text-purple-800"},preparing:{label:"Preparando",color:"bg-yellow-100 text-yellow-800"},ready:{label:"Pronto",color:"bg-green-100 text-green-800"},out_for_delivery:{label:"Saiu p/ Entrega",color:"bg-blue-100 text-blue-800"},delivered:{label:"Entregue",color:"bg-gray-100 text-gray-800"},cancelled:{label:"Cancelado",color:"bg-red-100 text-red-800"}},nr={pix:"PIX",dinheiro:"Dinheiro",cartao_credito:"CartÃ£o de CrÃ©dito",cartao_debito:"CartÃ£o de DÃ©bito"};function lr({userEmail:t}){const[i,o]=f.useState(null),{data:x=[],isLoading:l}=Z({queryKey:["customerOrders",t],queryFn:async()=>(await ne.entities.Order.list("-created_date")).filter(u=>u.customer_email===t||u.created_by===t),enabled:!!t}),h=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s||0);return l?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Re,{className:"w-6 h-6 animate-spin text-gray-400"})}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(pe,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"Nenhum pedido ainda"}),e.jsx("p",{className:"text-gray-400",children:"Seus pedidos aparecerÃ£o aqui"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Meus Pedidos"}),x.map(s=>e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border cursor-pointer hover:shadow-md transition-shadow",onClick:()=>o(s),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-xs font-mono bg-gray-100 px-2 py-1 rounded",children:["#",s.order_code||s.id.slice(-6).toUpperCase()]}),e.jsx(Te,{className:ts[s.status||"new"].color,children:ts[s.status||"new"].label})]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.created_date&&bt(s.created_date)})]}),e.jsx("span",{className:"font-bold text-green-600",children:h(s.total)})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"Itens:"})," ",(s.items||[]).length]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"Tipo:"})," ",s.delivery_method==="delivery"?"Entrega ðŸš´":"Retirada ðŸª"]}),s.address&&e.jsxs("p",{className:"text-xs mt-1",children:["ðŸ“ ",s.address]})]})]},s.id))]}),i&&e.jsx(va,{open:!0,onOpenChange:()=>o(null),children:e.jsxs(wa,{className:"max-w-md max-h-[90vh] overflow-y-auto p-0",children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-600 to-green-500 text-white p-4 z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"font-bold text-lg",children:"COMANDA"}),e.jsx("button",{onClick:()=>o(null),className:"text-white",children:e.jsx(ge,{className:"w-5 h-5"})})]}),e.jsxs("p",{className:"text-sm opacity-90",children:["Pedido #",i.order_code||i.id.slice(-6).toUpperCase()]}),e.jsx("p",{className:"text-xs opacity-75",children:bt(i.created_date)})]}),e.jsxs("div",{className:"p-4 space-y-4 font-mono text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold mb-1",children:["Cliente: ",i.customer_name]}),e.jsxs("p",{children:["Contato: ",i.customer_phone]}),e.jsxs("p",{children:["Tipo: ",i.delivery_method==="delivery"?"Entrega ðŸš´":"Retirada ðŸª"]}),i.address&&e.jsxs("p",{children:["EndereÃ§o: ",i.address]}),e.jsxs("p",{children:["Pagamento: ",nr[i.payment_method]||i.payment_method]}),i.payment_method==="dinheiro"&&i.needs_change&&e.jsxs("p",{className:"text-orange-600",children:["Troco para: ",h(i.change_amount),"(Troco: ",h(i.change_amount-i.total),")"]}),i.scheduled_date&&i.scheduled_time&&e.jsxs("p",{className:"text-blue-600 font-bold mt-2",children:["â° AGENDADO: ",Oa(i.scheduled_date,i.scheduled_time)]})]}),i.delivery_method==="delivery"&&i.delivery_code&&i.status==="out_for_delivery"&&e.jsxs("div",{className:"bg-orange-50 border-2 border-orange-500 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-orange-700 mb-1",children:"CÃ“DIGO DE ENTREGA:"}),e.jsx("p",{className:"text-3xl font-bold text-center text-orange-600 tracking-widest",children:i.delivery_code}),e.jsx("p",{className:"text-xs text-orange-600 mt-1 text-center",children:"Informe este cÃ³digo ao entregador"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold mb-2",children:"--- Pedido ---"}),(i.items||[]).map((s,u)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"font-bold",children:["#",u+1," - ",s.dish?.name," x",s.quantity||1]}),s.selections&&Object.keys(s.selections).length>0&&e.jsx("div",{className:"ml-2 text-xs text-gray-600",children:Object.entries(s.selections).map(([a,r])=>Array.isArray(r)?e.jsx("p",{children:r.map(c=>c.name).join(", ")},a):r?e.jsx("p",{children:r.name},a):null)}),e.jsxs("p",{children:["Valor: ",h(s.totalPrice*(s.quantity||1))]})]},u))]}),e.jsxs("div",{className:"border-t-2 border-gray-300 pt-2",children:[e.jsxs("p",{children:["Subtotal itens: ",h(i.subtotal)]}),i.delivery_fee>0&&e.jsxs("p",{children:["Taxa de entrega: ",h(i.delivery_fee)]}),i.discount>0&&e.jsxs("p",{className:"text-green-600",children:["Desconto: -",h(i.discount)]}),e.jsxs("p",{className:"font-bold text-lg mt-1",children:["TOTAL: ",h(i.total)]})]}),e.jsxs("div",{className:"text-xs text-gray-500 text-center pt-3 border-t",children:["Enviado em ",bt(i.created_date)]})]})]})})]})}function cr({isOpen:t,onClose:i,primaryColor:o="#f97316",slug:x=null}){Ta();const[l,h]=f.useState(null),[s,u]=f.useState("profile"),[a,r]=f.useState({name:"",phone:"",email:"",zipcode:"",address:"",address_number:"",complement:"",neighborhood:"",city:"",state:"",profile_picture:""}),[c,d]=f.useState({rating:0,comment:""}),[p,N]=f.useState(!0),[k,P]=f.useState(!1),[v,b]=f.useState(!1),z=async j=>{const _=j.replace(/\D/g,"");if(_.length===8){b(!0);try{const te=await(await fetch(`https://viacep.com.br/ws/${_}/json/`)).json();te.erro?w.error("CEP nÃ£o encontrado"):(r(De=>({...De,address:te.logradouro||"",neighborhood:te.bairro||"",city:te.localidade||"",state:te.uf||"",zipcode:_})),w.success("EndereÃ§o carregado automaticamente!"))}catch(A){console.error("Erro ao buscar CEP:",A),w.error("Erro ao buscar CEP. Tente novamente.")}finally{b(!1)}}};f.useEffect(()=>{t&&$()},[t]);const $=async()=>{try{N(!0);const j=await I.auth.me();h(j);const _=await I.entities.Customer.filter({email:j.email});if(_.length>0){const A=_[0];r({name:A.name||"",phone:A.phone||"",email:A.email||j.email||"",zipcode:A.zipcode||"",address:A.address||A.address_street||"",address_number:A.address_number||"",complement:A.complement||A.address_complement||"",neighborhood:A.neighborhood||"",city:A.city||"",state:A.state||"",profile_picture:A.profile_picture||""})}else r({name:j.full_name||"",phone:"",email:j.email||"",zipcode:"",address:"",address_number:"",complement:"",neighborhood:"",city:"",state:"",profile_picture:""})}catch(j){console.error("Erro ao carregar dados:",j),w.error("Erro ao carregar dados do perfil")}finally{N(!1)}},y=async()=>{try{P(!0);const j=await I.entities.Customer.filter({email:l.email}),_={...a,email:l.email};j.length>0?await I.entities.Customer.update(j[0].id,_):await I.entities.Customer.create(_),w.success("Perfil salvo com sucesso!")}catch(j){console.error("Erro ao salvar:",j),w.error("Erro ao salvar perfil")}finally{P(!1)}},T=async()=>{if(!c.rating||!c.comment.trim()){w.error("Preencha a avaliaÃ§Ã£o e o comentÃ¡rio");return}try{try{await I.entities.Feedback.create({customer_email:l.email,rating:c.rating,comment:c.comment,created_at:new Date().toISOString()})}catch{console.log("Entidade Feedback nÃ£o disponÃ­vel")}w.success("Obrigado pelo seu feedback!"),d({rating:0,comment:""})}catch(j){console.error("Erro ao enviar feedback:",j),w.error("Erro ao enviar feedback")}},Y=()=>{confirm("Deseja realmente sair?")&&I.auth.logout()},J=j=>{const _=j.target.files?.[0];if(!_)return;if(!_.type.startsWith("image/")){w.error("Por favor, selecione uma imagem vÃ¡lida");return}if(_.size>5*1024*1024){w.error("A imagem deve ter no mÃ¡ximo 5MB");return}const A=new FileReader;A.onloadend=()=>{r(te=>({...te,profile_picture:A.result})),w.success('Foto atualizada! Clique em "Salvar AlteraÃ§Ãµes" para confirmar')},A.readAsDataURL(_)},{data:re=[]}=Z({queryKey:["customerOrders",l?.email],queryFn:async()=>{if(!l?.email)return[];try{return await I.entities.Order.filter({customer_email:l.email})}catch{return[]}},enabled:!!l?.email&&t}),fe=re.length,le=re.reduce((j,_)=>j+(parseFloat(_.total)||0),0),B=re.filter(j=>j.status==="completed"||j.status==="delivered").length;if(!t)return null;const ee=[{id:"profile",label:"Meus Dados",icon:ve},{id:"loyalty",label:"Fidelidade",icon:Gt},{id:"history",label:"HistÃ³rico",icon:Qt},{id:"feedback",label:"AvaliaÃ§Ã£o",icon:$e}];return e.jsx(me,{children:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-2 sm:p-4",children:e.jsxs(E.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-gray-900 rounded-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"relative p-5 sm:p-6",style:{background:`linear-gradient(135deg, ${o}, ${o}dd)`},children:[e.jsx("button",{onClick:i,className:"absolute top-4 right-4 p-2.5 rounded-full hover:bg-white/20 transition-colors z-10 backdrop-blur-sm",title:"Fechar",children:e.jsx(ge,{className:"w-5 h-5 text-white"})}),e.jsx("div",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-white/30 backdrop-blur-sm flex items-center justify-center border-3 border-white/60 shadow-xl overflow-hidden",children:a.profile_picture?e.jsx("img",{src:a.profile_picture,alt:"Foto de perfil",className:"w-full h-full object-cover"}):e.jsx(ve,{className:"w-10 h-10 text-white"})}),e.jsx("label",{htmlFor:"photo-upload",className:"absolute -bottom-1 -right-1 w-8 h-8 bg-white rounded-full flex items-center justify-center cursor-pointer shadow-lg hover:scale-110 transition-transform border-2",style:{color:o,borderColor:o},title:"Alterar foto",children:e.jsx(Ra,{className:"w-4 h-4"})}),e.jsx("input",{id:"photo-upload",type:"file",accept:"image/*",onChange:J,className:"hidden"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white drop-shadow-lg",children:a.name||l?.full_name||"Meu Perfil"}),e.jsxs("p",{className:"text-white/90 text-sm flex items-center gap-2 drop-shadow mt-1",children:[e.jsx(Kt,{className:"w-4 h-4"}),l?.email]})]})]})})]}),e.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-800 overflow-x-auto bg-gray-50 dark:bg-gray-900/50 scrollbar-hide",children:ee.map(j=>{const _=j.icon;return e.jsxs("button",{onClick:()=>u(j.id),className:`flex items-center justify-center gap-2 px-4 md:px-6 py-3 font-medium transition-all border-b-2 whitespace-nowrap min-w-fit ${s===j.id?"bg-white dark:bg-gray-900":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800"}`,style:s===j.id?{borderBottomColor:o,color:o}:{},title:j.label,children:[e.jsx(_,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline text-sm",children:j.label})]},j.id)})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-5 bg-gray-50 dark:bg-gray-950",children:p?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:o}}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Carregando..."})]})}):e.jsxs(e.Fragment,{children:[s==="profile"&&e.jsxs("div",{className:"max-w-3xl mx-auto space-y-4",children:[e.jsxs(oe,{children:[e.jsxs(Qe,{children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5",style:{color:o}}),"InformaÃ§Ãµes Pessoais"]}),e.jsx(ft,{children:"Mantenha seus dados atualizados para melhor atendimento"})]}),e.jsx(ie,{className:"space-y-4",children:e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs(K,{htmlFor:"name",className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),"Nome Completo"]}),e.jsx(H,{id:"name",value:a.name,onChange:j=>r(_=>({..._,name:j.target.value})),placeholder:"Seu nome completo",className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"email",className:"flex items-center gap-2",children:[e.jsx(Kt,{className:"w-4 h-4"}),"E-mail"]}),e.jsx(H,{id:"email",type:"email",value:a.email,disabled:!0,className:"mt-1.5 bg-gray-100 dark:bg-gray-800"})]}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"phone",className:"flex items-center gap-2",children:[e.jsx(hs,{className:"w-4 h-4"}),"Telefone / WhatsApp"]}),e.jsx(H,{id:"phone",value:a.phone,onChange:j=>r(_=>({..._,phone:j.target.value.replace(/\D/g,"")})),placeholder:"(00) 00000-0000",maxLength:11,className:"mt-1.5"})]})]})})]}),e.jsxs(oe,{children:[e.jsxs(Qe,{children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5",style:{color:o}}),"EndereÃ§o de Entrega"]}),e.jsx(ft,{children:"Facilite seus prÃ³ximos pedidos salvando seu endereÃ§o"})]}),e.jsx(ie,{className:"space-y-3",children:e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(K,{htmlFor:"zipcode",children:"CEP"}),e.jsxs("div",{className:"relative mt-1.5",children:[e.jsx(H,{id:"zipcode",value:a.zipcode,onChange:j=>{const _=j.target.value.replace(/\D/g,"");r(A=>({...A,zipcode:_})),_.length===8&&z(_)},placeholder:"00000-000",maxLength:8,disabled:v,className:"pr-10"}),v&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2",style:{borderColor:o}})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Digite o CEP e o endereÃ§o serÃ¡ preenchido automaticamente"})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"city",children:"Cidade"}),e.jsx(H,{id:"city",value:a.city,onChange:j=>r(_=>({..._,city:j.target.value})),placeholder:"Cidade",className:"mt-1.5"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx(K,{htmlFor:"address",children:"EndereÃ§o"}),e.jsx(H,{id:"address",value:a.address,onChange:j=>r(_=>({..._,address:j.target.value})),placeholder:"Rua",className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"address_number",children:"NÃºmero"}),e.jsx(H,{id:"address_number",value:a.address_number,onChange:j=>r(_=>({..._,address_number:j.target.value})),placeholder:"123",className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"complement",children:"Complemento"}),e.jsx(H,{id:"complement",value:a.complement,onChange:j=>r(_=>({..._,complement:j.target.value})),placeholder:"Apto, bloco, etc",className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"neighborhood",children:"Bairro"}),e.jsx(H,{id:"neighborhood",value:a.neighborhood,onChange:j=>r(_=>({..._,neighborhood:j.target.value})),placeholder:"Bairro",className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"state",children:"Estado"}),e.jsx(H,{id:"state",value:a.state,onChange:j=>r(_=>({..._,state:j.target.value.toUpperCase()})),placeholder:"UF",className:"mt-1.5",maxLength:2})]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(V,{onClick:y,className:"flex-1",disabled:k,style:{backgroundColor:o},onMouseEnter:j=>j.target.style.opacity="0.9",onMouseLeave:j=>j.target.style.opacity="1",children:[e.jsx(Ia,{className:"w-4 h-4 mr-2"}),k?"Salvando...":"Salvar AlteraÃ§Ãµes"]}),e.jsxs(V,{onClick:Y,variant:"outline",className:"sm:w-auto border-red-300 text-red-600 hover:bg-red-50 dark:border-red-800 dark:text-red-400 dark:hover:bg-red-950",children:[e.jsx(La,{className:"w-4 h-4 mr-2"}),"Sair da Conta"]})]})]}),s==="loyalty"&&e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs(oe,{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-90",style:{background:`linear-gradient(135deg, ${o}, ${o}dd)`}}),e.jsxs(ie,{className:"relative p-8 text-center text-white",children:[e.jsx(Gt,{className:"w-20 h-20 mx-auto mb-4 drop-shadow-lg",fill:"white"}),e.jsx("h3",{className:"text-5xl font-bold mb-2 drop-shadow-md",children:fe}),e.jsx("p",{className:"text-xl opacity-95 font-medium",children:"Pontos de Fidelidade"}),e.jsx("div",{className:"mt-6 pt-6 border-t border-white/30",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-lg p-3",children:[e.jsx(pe,{className:"w-5 h-5 mx-auto mb-1"}),e.jsx("p",{className:"font-semibold",children:B}),e.jsx("p",{className:"text-xs opacity-90",children:"Pedidos Completos"})]}),e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-lg p-3",children:[e.jsx(Zt,{className:"w-5 h-5 mx-auto mb-1"}),e.jsx("p",{className:"font-semibold",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(le)}),e.jsx("p",{className:"text-xs opacity-90",children:"Total Gasto"})]})]})})]})]}),e.jsxs(oe,{children:[e.jsx(Qe,{children:e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(Yt,{className:"w-5 h-5",style:{color:o}}),"Como Funciona"]})}),e.jsxs(ie,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg",style:{backgroundColor:`${o}15`},children:[e.jsx("div",{className:"w-8 h-8 rounded-full text-white flex items-center justify-center font-bold flex-shrink-0",style:{backgroundColor:o},children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"Ganhe Pontos"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"1 ponto por cada pedido realizado"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg",style:{backgroundColor:`${o}15`},children:[e.jsx("div",{className:"w-8 h-8 rounded-full text-white flex items-center justify-center font-bold flex-shrink-0",style:{backgroundColor:o},children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"Acumule"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Seus pontos nÃ£o expiram e crescem a cada compra"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg",style:{backgroundColor:`${o}15`},children:[e.jsx("div",{className:"w-8 h-8 rounded-full text-white flex items-center justify-center font-bold flex-shrink-0",style:{backgroundColor:o},children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"Troque por BenefÃ­cios"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Descontos exclusivos e promoÃ§Ãµes especiais"})]})]})]})]})]}),s==="history"&&e.jsx("div",{className:"max-w-5xl mx-auto",children:l?.email?e.jsx(e.Fragment,{children:re.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[e.jsx(oe,{children:e.jsxs(ie,{className:"p-4 text-center",children:[e.jsx(pe,{className:"w-8 h-8 mx-auto mb-2",style:{color:o}}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:re.length}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total de Pedidos"})]})}),e.jsx(oe,{children:e.jsxs(ie,{className:"p-4 text-center",children:[e.jsx(Yt,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:B}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"ConcluÃ­dos"})]})}),e.jsx(oe,{children:e.jsxs(ie,{className:"p-4 text-center",children:[e.jsx(Zt,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(le)}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Gasto"})]})})]}),e.jsx(lr,{userEmail:l.email})]}):e.jsx(oe,{children:e.jsxs(ie,{className:"p-12 text-center",children:[e.jsx(pe,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Nenhum pedido ainda"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"FaÃ§a seu primeiro pedido e comece a acumular pontos!"})]})})}):e.jsx(oe,{children:e.jsxs(ie,{className:"p-12 text-center",children:[e.jsx(Qt,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"FaÃ§a login para ver seu histÃ³rico de pedidos"})]})})}),s==="feedback"&&e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs(oe,{children:[e.jsxs(Qe,{children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5",style:{color:o}}),"Sua OpiniÃ£o Ã© Importante"]}),e.jsx(ft,{children:"Ajude-nos a melhorar nosso atendimento e qualidade"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-base font-semibold mb-3 block",children:"Como vocÃª avalia nosso serviÃ§o?"}),e.jsx("div",{className:"flex gap-2 justify-center my-4",children:[1,2,3,4,5].map(j=>e.jsx("button",{onClick:()=>d(_=>({..._,rating:j})),className:"transition-all hover:scale-110 active:scale-95",children:e.jsx(kt,{className:`w-12 h-12 ${j<=c.rating?"fill-yellow-400 text-yellow-400":"text-gray-300 dark:text-gray-600"}`})},j))}),c.rating>0&&e.jsxs("p",{className:"text-center text-sm text-gray-600 dark:text-gray-400",children:[c.rating===5&&"ðŸŒŸ Excelente!",c.rating===4&&"ðŸ˜Š Muito bom!",c.rating===3&&"ðŸ‘ Bom",c.rating===2&&"ðŸ˜ Regular",c.rating===1&&"ðŸ˜ž Ruim"]})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"comment",className:"text-base font-semibold",children:"Deixe seu comentÃ¡rio"}),e.jsx(Ea,{id:"comment",value:c.comment,onChange:j=>d(_=>({..._,comment:j.target.value})),placeholder:"Conte-nos sobre sua experiÃªncia: atendimento, qualidade dos produtos, tempo de entrega...",rows:6,className:"mt-2 resize-none"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2",children:[c.comment.length,"/500 caracteres"]})]}),e.jsxs(V,{onClick:T,className:"w-full py-6 text-base font-semibold",style:{backgroundColor:o},onMouseEnter:j=>j.target.style.opacity="0.9",onMouseLeave:j=>j.target.style.opacity="1",disabled:!c.rating||!c.comment.trim(),children:[e.jsx($e,{className:"w-5 h-5 mr-2"}),"Enviar AvaliaÃ§Ã£o"]})]})]})})]})})]})})})}function dr({isStoreClosed:t,isAutoModeClosed:i,isStorePaused:o,getNextOpenTime:x,store:l}){return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:e.jsx(E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 text-center",children:t||i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-4xl",children:"ðŸ”´"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Loja Fechada"}),e.jsx("p",{className:"text-gray-600 mb-6",children:i&&x?`Abriremos ${x}`:"NÃ£o estamos funcionando no momento"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-500",children:[l.opening_time&&l.closing_time&&e.jsxs("p",{children:["â° HorÃ¡rio: ",l.opening_time," - ",l.closing_time]}),l.whatsapp&&e.jsx("a",{href:`https://wa.me/55${l.whatsapp.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-4 px-6 py-3 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition-colors",children:"ðŸ’¬ Falar no WhatsApp"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-4xl",children:"â¸ï¸"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Pedidos Pausados"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l.pause_message||"NÃ£o estamos aceitando pedidos temporariamente"}),l.whatsapp&&e.jsx("a",{href:`https://wa.me/55${l.whatsapp.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-4 px-6 py-3 bg-orange-500 text-white rounded-lg font-medium hover:bg-orange-600 transition-colors",children:"ðŸ’¬ Falar no WhatsApp"})]})})})}function mr({isOpen:t,onClose:i,onSuccess:o,returnUrl:x}){const[l,h]=f.useState(1),[s,u]=f.useState({name:"",email:"",phone:"",password:"",confirmPassword:"",cpf:""}),[a,r]=f.useState(!1),[c,d]=f.useState("");ns();const p=(v,b)=>{u(z=>({...z,[v]:b})),d("")},N=v=>{const b=v.replace(/\D/g,"");return b.length<=11?b.replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2"):v},k=v=>{const b=v.replace(/\D/g,"");return b.length<=11?b.replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"):v},P=async v=>{if(v.preventDefault(),d(""),r(!0),!s.name.trim()){d("Nome Ã© obrigatÃ³rio"),r(!1);return}if(!s.email.trim()||!s.email.includes("@")){d("Email vÃ¡lido Ã© obrigatÃ³rio"),r(!1);return}if(!s.phone.trim()||s.phone.replace(/\D/g,"").length<10){d("Telefone vÃ¡lido Ã© obrigatÃ³rio"),r(!1);return}if(!s.password||s.password.length<6){d("Senha deve ter no mÃ­nimo 6 caracteres"),r(!1);return}if(s.password!==s.confirmPassword){d("As senhas nÃ£o coincidem"),r(!1);return}if(s.cpf&&!qa(s.cpf.replace(/\D/g,""))){d("CPF invÃ¡lido"),r(!1);return}try{const b=await ne.functions.invoke("registerCustomer",{name:s.name.trim(),email:s.email.trim().toLowerCase(),phone:s.phone.replace(/\D/g,""),password:s.password,cpf:s.cpf?s.cpf.replace(/\D/g,""):null,address:"",birth_date:null});if(b?.data?.success){w.success("Cadastro realizado com sucesso!");try{const z=await ne.auth.login(s.email.trim().toLowerCase(),s.password);z.token?(o&&o(z.user||b.data?.user),i(),setTimeout(()=>{window.location.reload()},500)):(i(),setTimeout(()=>{const $=x||window.location.pathname,y=$.match(/^\/s\/([a-z0-9-]+)(?:\/|$)/i),T=y?`/s/${y[1]}/login/cliente?returnUrl=${encodeURIComponent($)}`:`/?returnUrl=${encodeURIComponent($)}`;window.location.href=T},1e3))}catch(z){console.error("Erro ao fazer login automÃ¡tico:",z),i(),setTimeout(()=>{const $=x||window.location.pathname,y=$.match(/^\/s\/([a-z0-9-]+)(?:\/|$)/i),T=y?`/s/${y[1]}/login/cliente?returnUrl=${encodeURIComponent($)}`:`/?returnUrl=${encodeURIComponent($)}`;window.location.href=T},1e3)}}else{const z=b?.data?.error||"Erro ao criar conta. Tente novamente.";d(z),w.error(z)}}catch(b){const z=b?.response?.data?.error||b?.message||"Erro ao criar conta. Tente novamente.";d(z),w.error(z)}finally{r(!1)}};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 flex items-center justify-between rounded-t-2xl",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:l===1?"Cadastre-se e Ganhe BenefÃ­cios!":"Criar Conta"}),e.jsx("button",{onClick:i,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:e.jsx(ge,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"p-6",children:l===1?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-orange-500 to-amber-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(we,{className:"w-8 h-8 text-white"})}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Cadastre-se gratuitamente e aproveite:"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-gradient-to-r from-orange-50 to-amber-50 dark:from-orange-900/20 dark:to-amber-900/20 border border-orange-200 dark:border-orange-800",children:[e.jsx(we,{className:"w-5 h-5 text-orange-600 dark:text-orange-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"Pontos Fidelidade"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Acumule pontos em cada pedido e troque por descontos"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border border-purple-200 dark:border-purple-800",children:[e.jsx(kt,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"PromoÃ§Ãµes Exclusivas"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Acesso a ofertas e cupons especiais"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 border border-blue-200 dark:border-blue-800",children:[e.jsx(Xe,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"EndereÃ§os Salvos"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Salve seus endereÃ§os para checkout mais rÃ¡pido"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border border-green-200 dark:border-green-800",children:[e.jsx(xs,{className:"w-5 h-5 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"HistÃ³rico de Pedidos"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Acompanhe todos os seus pedidos em um sÃ³ lugar"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{variant:"outline",onClick:i,className:"flex-1",children:"Continuar sem cadastro"}),e.jsx(V,{onClick:()=>h(2),className:"flex-1 bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white",children:"Quero me cadastrar"})]})]}):e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(K,{htmlFor:"name",className:"text-gray-700 dark:text-gray-300",children:"Nome Completo *"}),e.jsx(H,{id:"name",value:s.name,onChange:v=>p("name",v.target.value),placeholder:"Seu nome",className:"mt-1.5",required:!0})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"email",className:"text-gray-700 dark:text-gray-300",children:"Email *"}),e.jsx(H,{id:"email",type:"email",value:s.email,onChange:v=>p("email",v.target.value),placeholder:"seu@email.com",className:"mt-1.5",required:!0})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"phone",className:"text-gray-700 dark:text-gray-300",children:"Telefone *"}),e.jsx(H,{id:"phone",value:s.phone,onChange:v=>p("phone",N(v.target.value)),placeholder:"(86) 99999-9999",className:"mt-1.5",required:!0})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"cpf",className:"text-gray-700 dark:text-gray-300",children:"CPF (opcional)"}),e.jsx(H,{id:"cpf",value:s.cpf,onChange:v=>p("cpf",k(v.target.value)),placeholder:"000.000.000-00",className:"mt-1.5",maxLength:14})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"password",className:"text-gray-700 dark:text-gray-300",children:"Senha *"}),e.jsx(H,{id:"password",type:"password",value:s.password,onChange:v=>p("password",v.target.value),placeholder:"MÃ­nimo 6 caracteres",className:"mt-1.5",required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"confirmPassword",className:"text-gray-700 dark:text-gray-300",children:"Confirmar Senha *"}),e.jsx(H,{id:"confirmPassword",type:"password",value:s.confirmPassword,onChange:v=>p("confirmPassword",v.target.value),placeholder:"Digite a senha novamente",className:"mt-1.5",required:!0})]}),c&&e.jsx("div",{className:"p-3 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:c})}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(V,{type:"button",variant:"outline",onClick:()=>h(1),className:"flex-1",disabled:a,children:"Voltar"}),e.jsx(V,{type:"submit",className:"flex-1 bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white",disabled:a,children:a?e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"w-4 h-4 mr-2 animate-spin"}),"Criando conta..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ua,{className:"w-4 h-4 mr-2"}),"Criar Conta"]})})]})]})})]})}):null}function ur({isOpen:t,onClose:i,onApplyCoupon:o,primaryColor:x="#f97316",slug:l}){const h=()=>{o&&o("BEMVINDO10"),l&&localStorage.setItem(`welcome_discount_${l}`,"true"),i(),w.success("Cupom aplicado! Ganhe 10% OFF na sua primeira compra! ðŸŽ‰")},s=()=>{l&&localStorage.setItem(`welcome_discount_${l}`,"true"),i()};return t?e.jsx(me,{children:t&&e.jsx(E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>i(),children:e.jsxs(E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:u=>u.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-orange-400/20 to-red-400/20 rounded-full -mr-16 -mt-16 blur-2xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-yellow-400/20 to-orange-400/20 rounded-full -ml-12 -mb-12 blur-xl"}),e.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:e.jsx(ge,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center shadow-lg",children:e.jsx(we,{className:"w-10 h-10 text-white"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Bem-vindo! ðŸŽ‰"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["Ganhe ",e.jsx("span",{className:"font-bold text-orange-500",children:"10% OFF"})," na sua primeira compra!"]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 rounded-lg p-4 mb-6 border border-orange-200 dark:border-orange-800",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(ps,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{className:"font-bold text-lg text-gray-900 dark:text-white",children:"Cupom: BEMVINDO10"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Use este cupom no checkout e ganhe desconto!"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{onClick:s,variant:"outline",className:"flex-1",children:"Talvez depois"}),e.jsx(V,{onClick:h,className:"flex-1 text-white",style:{backgroundColor:x},children:"Aplicar Cupom"})]})]})]})})}):null}function xr({cart:t=[],dishes:i=[],onAddToCart:o,primaryColor:x="#f97316",onClose:l,store:h=null}){const[s,u]=f.useState(null),[a,r]=f.useState(new Set);f.useEffect(()=>{if(!h?.cross_sell_config?.enabled){u(null);return}if(t.length===0){u(null);return}a.size>0&&t.length>a.size&&r(new Set);const p=h.cross_sell_config,N=t.reduce((k,P)=>k+P.totalPrice*(P.quantity||1),0);if(p.beverage_offer?.enabled&&!a.has("beverage")){const k=t.some(v=>v.dish?.product_type==="pizza"||(p.beverage_offer.trigger_product_types||["pizza"]).includes(v.dish?.product_type)),P=t.some(v=>v.dish?.product_type==="beverage"||v.dish?.id===p.beverage_offer.dish_id);if(k&&!P&&p.beverage_offer.dish_id){const v=i.find(b=>b.id===p.beverage_offer.dish_id);if(v&&v.is_active!==!1){const b=p.beverage_offer.discount_percent||0,z=v.price*(1-b/100);let $=p.beverage_offer.message||"Adicione {product_name} por apenas {product_price}";$=$.replace("{product_name}",v.name),$=$.replace("{product_price}",formatCurrency(z)),u({type:"beverage",title:p.beverage_offer.title||"ðŸ¥¤ Que tal uma bebida?",message:$,product:v,discount:b});return}}}if(p.dessert_offer?.enabled&&!a.has("dessert")){const k=p.dessert_offer.min_cart_value||40,P=t.some(v=>v.dish?.id===p.dessert_offer.dish_id);if(N>=k&&!P&&p.dessert_offer.dish_id){const v=i.find(b=>b.id===p.dessert_offer.dish_id);if(v&&v.is_active!==!1){const b=p.dessert_offer.discount_percent||0,z=v.price*(1-b/100);let $=p.dessert_offer.message||"Complete seu pedido com {product_name} por apenas {product_price}";$=$.replace("{product_name}",v.name),$=$.replace("{product_price}",formatCurrency(z)),u({type:"dessert",title:p.dessert_offer.title||"ðŸ° Que tal uma sobremesa?",message:$,product:v,discount:b});return}}}if(p.combo_offer?.enabled&&!a.has("combo")){const k=p.combo_offer.min_pizzas||2,P=t.filter(b=>b.dish?.product_type==="pizza").length,v=t.some(b=>b.dish?.id===p.combo_offer.dish_id);if(P>=k&&!v&&p.combo_offer.dish_id){const b=i.find(z=>z.id===p.combo_offer.dish_id);if(b&&b.is_active!==!1){const z=p.combo_offer.discount_percent||100;b.price*(1-z/100);let $=p.combo_offer.message||"Compre {min_pizzas} pizzas e ganhe {product_name} GRÃTIS!";$=$.replace("{product_name}",b.name),$=$.replace("{min_pizzas}",k.toString()),u({type:"combo",title:p.combo_offer.title||"ðŸ”¥ Oferta Especial!",message:$,product:b,discount:z});return}}}u(null)},[t,i,a,h]);const c=()=>{if(!s?.product)return;const p=s.discount||0,k=(s.product.price||0)*(1-p/100),P={dish:s.product,totalPrice:k,quantity:1};o&&o(P),p===100?w.success(`${s.product.name} adicionado GRÃTIS! ðŸŽ‰`):p>0?w.success(`${s.product.name} adicionado com ${p}% de desconto!`):w.success(`${s.product.name} adicionado ao carrinho!`),r(v=>new Set([...v,s.type])),u(null),l&&l()},d=()=>{s&&(r(p=>new Set([...p,s.type])),u(null)),l&&l()};return s?e.jsx(me,{children:e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed bottom-24 right-4 z-40 max-w-sm w-full md:w-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 p-4 relative",children:[e.jsx("button",{onClick:d,className:"absolute top-2 right-2 p-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:e.jsx(ge,{className:"w-4 h-4 text-gray-500"})}),e.jsxs("div",{className:"pr-6",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsxs("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:`${x}20`},children:[s.type==="beverage"&&"ðŸ¥¤",s.type==="dessert"&&"ðŸ°",s.type==="combo"&&"ðŸ”¥"]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white mb-1",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.message})]})]}),s.product?.image&&e.jsx("div",{className:"mb-3 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.product.image,alt:s.product.name,className:"w-full h-24 object-cover"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:d,variant:"outline",size:"sm",className:"flex-1",children:"NÃ£o, obrigado"}),e.jsxs(V,{onClick:c,size:"sm",className:"flex-1 text-white",style:{backgroundColor:x},children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),s.discount===100?"Adicionar GrÃ¡tis":"Adicionar"]})]}),s.discount===100&&e.jsx("div",{className:"mt-2 text-center",children:e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400 font-medium flex items-center justify-center gap-1",children:[e.jsx(ps,{className:"w-3 h-3"}),"Oferta especial limitada!"]})})]})]})})}):null}const hr=()=>{const t="https://digimenu-backend-3m6t.onrender.com/api";return t.endsWith("/api")?`${t}/public/chat`:`${t}/api/public/chat`};function pr(t=[],i=[],o=[]){const x=[];[...i||[]].sort((s,u)=>(s.order??0)-(u.order??0)).forEach(s=>{const u=(t||[]).filter(a=>a.category_id===s.id&&a.is_active!==!1&&a.name);u.length!==0&&(x.push(`
## ${s.name}`),u.forEach(a=>{let r=`- ${a.name}: R$ ${(a.price??0).toFixed(2)}`;a.description&&(r+=` â€” ${(a.description||"").slice(0,80)}`);const c=(a.complement_groups||[]).map(p=>p.group_id),d=(o||[]).filter(p=>c.includes(p.id));if(d.length){const p=d.flatMap(N=>(N.complements||[]).filter(k=>k.is_active!==!1).map(k=>`${k.name} (R$ ${(k.price||0).toFixed(2)})`));p.length&&(r+=` [complementos: ${p.join(", ")}]`)}if(a.extras&&a.extras.length){const p=a.extras.filter(N=>N.is_active!==!1).map(N=>`${N.name} (R$ ${(N.price||0).toFixed(2)})`);p.length&&(r+=` [extras: ${p.join(", ")}]`)}x.push(r)}))});const h=(t||[]).filter(s=>!s.category_id&&s.is_active!==!1&&s.name);return h.length&&(x.push(`
## Outros`),h.forEach(s=>{x.push(`- ${s.name}: R$ ${(s.price??0).toFixed(2)}`)})),x.join(`
`)||"CardÃ¡pio nÃ£o disponÃ­vel."}function gr(t=[],i=null){const o=[];if(i?.delivery_fee_mode==="distance")o.push("Taxa por distÃ¢ncia (km)."),i.delivery_base_fee!=null&&o.push(`Taxa base: R$ ${Number(i.delivery_base_fee).toFixed(2)}.`),i.delivery_free_distance&&o.push(`Entrega grÃ¡tis atÃ© ${i.delivery_free_distance} km.`);else{const x=i?.delivery_fee??0;o.push(`Taxa padrÃ£o: R$ ${Number(x).toFixed(2)}.`);const l=(t||[]).filter(h=>h.is_active!==!1&&h.neighborhood);l.length&&o.push("Por bairro: "+l.slice(0,15).map(h=>`${h.neighborhood} R$ ${Number(h.fee||0).toFixed(2)}`).join("; "))}return i?.delivery_min_order&&o.push(`Pedido mÃ­nimo: R$ ${Number(i.delivery_min_order).toFixed(2)}.`),o.join(" ")||"Entrega conforme combinar com o cliente."}const fr={pix:"PIX",dinheiro:"Dinheiro",cartao_credito:"CartÃ£o de CrÃ©dito",cartao_debito:"CartÃ£o de DÃ©bito"};function br(){return Object.entries(fr).map(([t,i])=>`${i}`).join(", ")}function yr({dishes:t=[],categories:i=[],complementGroups:o=[],deliveryZones:x=[],store:l=null,orders:h=[],onAddToCart:s,open:u,onOpenChange:a,slug:r,storeName:c}){const[d,p]=f.useState(!1),N=u!==void 0&&a!=null,k=N?u:d,P=N?a:p,[v,b]=f.useState([{id:1,type:"bot",text:"OlÃ¡! ðŸ‘‹ Sou o assistente virtual. Como posso ajudar vocÃª hoje?",timestamp:new Date}]),[z,$]=f.useState(""),[y,T]=f.useState(!1),Y=f.useRef(null),J=f.useRef(null),re=()=>{Y.current?.scrollIntoView({behavior:"smooth"})};f.useEffect(()=>{re()},[v]);const fe=i&&i.length>0,{data:le=[]}=Z({queryKey:["categories"],queryFn:()=>ne.entities.Category.list("order"),enabled:!fe}),B=fe?i:le,{data:ee}=Z({queryKey:["authMe"],queryFn:()=>ne.auth.me(),enabled:k,retry:!1}),{data:j=[]}=Z({queryKey:["customerOrdersForChatbot",ee?.email],queryFn:async()=>{const D=await ne.entities.Order.list("-created_date"),S=(ee?.email||"").toLowerCase();return S?D.filter(W=>{const G=(W.customer_email||"").toLowerCase()===S||(W.created_by||"").toLowerCase()===S,Q=W.status!=="delivered"&&W.status!=="cancelled";return G&&Q}):[]},enabled:k&&!!ee?.email}),_=h.length>0?h:j,A=async D=>{const S=D.toLowerCase().trim(),W=S.replace(/\s+/g," ");if(W.includes("ver cardÃ¡pio")||W.includes("ver cardapio")){const G=(t||[]).filter(L=>L.is_active!==!1&&L.name).length;return{text:G>0?`O cardÃ¡pio estÃ¡ logo acima nesta pÃ¡gina! ðŸ“‹ Role para cima para ver as categorias e ${G} pratos. Quer que eu recomende algo popular?`:"O cardÃ¡pio estÃ¡ na pÃ¡gina â€” role para cima para ver as opÃ§Ãµes. ðŸ“‹",suggestions:["Recomendar pratos","Fazer pedido","Ver horÃ¡rios"]}}if(W.includes("fazer pedido"))return{text:'Para fazer seu pedido: use o cardÃ¡pio acima para escolher os itens e adicionar ao carrinho. ðŸ›’ Ou me diga o que deseja (ex.: "quero 1 pizza de calabresa").',suggestions:["Ver cardÃ¡pio","Recomendar pratos","Ver horÃ¡rios"]};if(S.includes("horÃ¡rio")||S.includes("horÃ¡rios")||S.includes("aberto")||S.includes("funciona"))return{text:"Estamos abertos de segunda a domingo, das 11h Ã s 23h. ðŸ•",suggestions:["Ver cardÃ¡pio","Fazer pedido"]};if(S.includes("entrega")||S.includes("frete")||S.includes("delivery"))return{text:`Oferecemos entrega em toda a regiÃ£o! O frete varia conforme a distÃ¢ncia. ðŸšš

Para calcular o frete, adicione um item ao carrinho e informe seu endereÃ§o no checkout.`,suggestions:["Ver cardÃ¡pio","Calcular frete"]};if(S.includes("pagamento")||S.includes("pagar")||S.includes("dinheiro"))return{text:`Aceitamos:
ðŸ’³ CartÃ£o de crÃ©dito/dÃ©bito
ðŸ’° Dinheiro
ðŸ“± PIX

O pagamento Ã© feito na entrega ou online!`,suggestions:["Fazer pedido"]};if(S.includes("pedido")||S.includes("rastrear")||S.includes("onde estÃ¡")){const G=D.match(/\d+/);if(G&&_.length>0){const Q=G[0],L=_.find(U=>U.order_code?.includes(Q)||U.id?.toString().includes(Q));if(L){const U={new:"ðŸ†• Novo",accepted:"âœ… Aceito",preparing:"ðŸ‘¨â€ðŸ³ Em preparo",ready:"âœ… Pronto",out_for_delivery:"ðŸšš Saiu para entrega",delivered:"âœ… Entregue",cancelled:"âŒ Cancelado"};return{text:`Seu pedido #${L.order_code||L.id} estÃ¡: ${U[L.status]||L.status}

${L.status==="out_for_delivery"?"O entregador estÃ¡ a caminho! ðŸš—":""}`,suggestions:["Ver mais pedidos"]}}}return{text:'Para rastrear seu pedido, informe o nÃºmero do pedido ou acesse "Meus Pedidos" no menu. ðŸ“¦',suggestions:["Ver meus pedidos"]}}if(S.includes("recomend")||S.includes("sugest")||S.includes("indic")){const Q=t.filter(L=>L.is_active!==!1).sort((L,U)=>(U.orders_count||0)-(L.orders_count||0)).slice(0,3);return Q.length>0?{text:`Recomendo estes pratos populares: ðŸ½ï¸

${Q.map(U=>`â€¢ ${U.name} - R$ ${U.price?.toFixed(2)||"0,00"}`).join(`
`)}

Quer adicionar algum ao carrinho?`,suggestions:Q.map(U=>`Adicionar ${U.name}`),dishes:Q}:{text:"Confira nosso cardÃ¡pio completo! Temos opÃ§Ãµes deliciosas para todos os gostos. ðŸ˜‹",suggestions:["Ver cardÃ¡pio"]}}if(S.includes("quero")||S.includes("pedir")||S.includes("adicionar")){const G=t.filter(Q=>{const L=Q.name?.toLowerCase()||"";return S.includes(L)||L.split(" ").some(U=>S.includes(U))});if(G.length>0){const Q=D.match(/(\d+)\s*x/),L=Q?parseInt(Q[1]):1,U=G[0];return s&&s({...U,quantity:L}),{text:`Perfeito! Adicionei ${L}x ${U.name} ao seu carrinho. ðŸ›’

Quer adicionar mais alguma coisa?`,suggestions:["Ver carrinho","Ver cardÃ¡pio","Finalizar pedido"]}}return{text:"NÃ£o consegui identificar o prato. Pode me dizer o nome completo? Ou prefere ver o cardÃ¡pio? ðŸ“‹",suggestions:["Ver cardÃ¡pio"]}}return{text:"Como posso ajudar? Escolha uma opÃ§Ã£o abaixo.",suggestions:["Ver cardÃ¡pio","Fazer pedido","Rastrear pedido","Ver horÃ¡rios"]}},te=async(D=null)=>{const S=D!=null&&String(D).trim()?String(D).trim():z.trim();if(!S)return;const W={id:Date.now(),type:"user",text:S,timestamp:new Date};b(O=>[...O,W]),D||$(""),T(!0);const G=v.slice(-6).map(O=>({role:O.type==="user"?"user":"assistant",content:O.text})),Q=t.filter(O=>O.is_active!==!1&&O.name).slice(0,40).map(O=>`${O.name} (R$ ${(O.price||0).toFixed(2)})`).join("; "),L=pr(t,B,o),U=gr(x,l),et=br();try{const O=await fetch(hr(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:S,slug:r||"",storeName:c||"",dishesSummary:Q,menuFull:L,deliveryInfo:U,paymentOptions:et,history:G})}),ce=O.ok?await O.json():null;if(ce&&ce.text){const tt={id:Date.now()+1,type:"bot",text:ce.text,suggestions:ce.suggestions||[],step:ce.step||null,dishes:[],timestamp:new Date};b(st=>[...st,tt]),T(!1);return}}catch{}const ke=await A(S),Fe={id:Date.now()+1,type:"bot",text:ke.text,suggestions:ke.suggestions||[],dishes:ke.dishes||[],timestamp:new Date};b(O=>[...O,Fe]),T(!1)},De=D=>{if(D.startsWith("Adicionar ")){const S=D.replace("Adicionar ",""),W=t.find(G=>G.name===S);W&&s&&(s(W),b(G=>[...G,{id:Date.now(),type:"bot",text:`âœ… ${W.name} adicionado ao carrinho!`,timestamp:new Date}]))}else te(D)};return e.jsxs(e.Fragment,{children:[!N&&!k&&e.jsx(E.button,{initial:{scale:0},animate:{scale:1},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>P(!0),className:"fixed bottom-6 right-6 z-50 bg-gradient-to-r from-orange-500 to-red-500 text-white p-4 rounded-full shadow-2xl hover:shadow-orange-500/50 transition-shadow",children:e.jsx(Ba,{className:"w-6 h-6"})}),e.jsx(me,{children:k&&e.jsx(E.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:"fixed bottom-6 right-6 z-50 w-96 max-w-[calc(100vw-2rem)] h-[600px] max-h-[calc(100vh-8rem)]",children:e.jsxs(oe,{className:"h-full flex flex-col shadow-2xl",children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white p-4 rounded-t-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(za,{className:"w-5 h-5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Assistente Virtual"}),e.jsx("p",{className:"text-xs opacity-90",children:"Online agora"})]})]}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>P(!1),className:"h-8 w-8 p-0 text-white hover:bg-white/20",children:e.jsx(ge,{className:"h-4 w-4"})})]}),e.jsxs(ie,{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[v.map(D=>e.jsx(E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${D.type==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] rounded-lg p-3 ${D.type==="user"?"bg-orange-500 text-white":"bg-gray-100 text-gray-800"}`,children:[e.jsx("p",{className:"text-sm whitespace-pre-line",children:D.text}),D.suggestions&&D.suggestions.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:D.suggestions.map((S,W)=>e.jsx("button",{onClick:()=>De(S),className:"text-xs px-2 py-1 bg-white/20 rounded hover:bg-white/30 transition-colors",children:S},W))}),D.dishes&&D.dishes.length>0&&e.jsx("div",{className:"mt-2 space-y-2",children:D.dishes.map(S=>e.jsxs("button",{onClick:()=>{s&&(s(S),b(W=>[...W,{id:Date.now(),type:"bot",text:`âœ… ${S.name} adicionado!`,timestamp:new Date}]))},className:"w-full text-left p-2 bg-white/20 rounded hover:bg-white/30 transition-colors",children:[e.jsx("p",{className:"font-medium text-sm",children:S.name}),e.jsxs("p",{className:"text-xs opacity-90",children:["R$ ",S.price?.toFixed(2)||"0,00"]})]},S.id))})]})},D.id)),y&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:e.jsx(ls,{className:"w-4 h-4 animate-spin"})})}),e.jsx("div",{ref:Y})]}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(H,{ref:J,value:z,onChange:D=>$(D.target.value),onKeyPress:D=>{D.key==="Enter"&&!D.shiftKey&&(D.preventDefault(),te())},placeholder:"Digite sua mensagem...",className:"flex-1"}),e.jsx(V,{onClick:te,disabled:!z.trim()||y,className:"bg-orange-500 hover:bg-orange-600",children:e.jsx(Wa,{className:"w-4 h-4"})})]})})]})})})]})}function jr({dishes:t=[],onDishClick:i,onRemoveFavorite:o,slug:x=null,primaryColor:l="#f97316"}){const{favorites:h,removeFavorite:s}=ds(x),u=t.filter(a=>h.some(r=>r.id===a.id));return u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(vt,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"Nenhum prato favorito ainda"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Clique no coraÃ§Ã£o nos pratos para adicionar aos favoritos"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(a=>e.jsx(E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},children:e.jsxs(oe,{className:"relative overflow-hidden hover:shadow-lg transition-shadow",children:[a.image&&e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(V,{size:"icon",variant:"ghost",className:"bg-white/90 hover:bg-white rounded-full",onClick:r=>{r.stopPropagation(),s(a.id),o&&o(a.id)},children:e.jsx(ge,{className:"w-4 h-4 text-red-500"})})}),a.is_new&&e.jsx(Te,{className:"absolute top-2 left-2 bg-green-500 text-white",children:"Novo"}),a.is_popular&&e.jsx(Te,{className:"absolute top-2 left-2 bg-orange-500 text-white",children:"Popular"})]}),e.jsxs(ie,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:a.name}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xl font-bold",style:{color:l},children:he(a.price||0)}),e.jsxs(V,{size:"sm",onClick:()=>i(a),style:{backgroundColor:l},className:"text-white",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),"Adicionar"]})]})]})]})},a.id))})}function vr({isOpen:t,onClose:i,referralCode:o,onApplyReferralCode:x,primaryColor:l="#f97316"}){const[h,s]=f.useState(""),[u,a]=f.useState(!1);if(!t)return null;const r=()=>{navigator.clipboard.writeText(o),a(!0),w.success("CÃ³digo copiado!"),setTimeout(()=>a(!1),2e3)},c=async()=>{if(!h.trim()){w.error("Digite um cÃ³digo de referÃªncia");return}const d=await x(h.trim().toUpperCase());d.success?(w.success(d.message),s(""),i()):w.error(d.message)};return e.jsx(me,{children:t&&e.jsx(E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:i,children:e.jsxs(E.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},transition:{type:"spring",stiffness:100,damping:10},className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 max-w-md w-full",onClick:d=>d.stopPropagation(),children:[e.jsx("button",{onClick:i,className:"absolute top-3 right-3 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:e.jsx(ge,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx(we,{className:"w-16 h-16 mx-auto mb-4",style:{color:l}}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Programa de IndicaÃ§Ã£o"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Indique amigos e ganhe pontos!"})]}),o&&e.jsxs("div",{className:"mb-6 p-4 bg-gradient-to-r from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 rounded-lg border border-orange-200 dark:border-orange-800",children:[e.jsx(K,{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Seu CÃ³digo de IndicaÃ§Ã£o"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{value:o,readOnly:!0,className:"flex-1 font-mono text-lg font-bold text-center"}),e.jsx(V,{size:"icon",variant:"outline",onClick:r,className:"flex-shrink-0",children:u?e.jsx(Ga,{className:"w-5 h-5 text-green-500"}):e.jsx(Ma,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2",children:"Compartilhe este cÃ³digo e ganhe 100 pontos quando seu amigo fizer a primeira compra!"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(K,{htmlFor:"referral-code",className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Tem um cÃ³digo de indicaÃ§Ã£o?"}),e.jsx(H,{id:"referral-code",value:h,onChange:d=>s(d.target.value.toUpperCase()),placeholder:"Digite o cÃ³digo",className:"text-center font-mono text-lg",maxLength:10})]}),e.jsx(V,{onClick:c,className:"w-full py-3 text-lg font-semibold text-white shadow-lg hover:shadow-xl transition-all",style:{backgroundColor:l},disabled:!h.trim(),children:"Aplicar CÃ³digo"})]})]})})})}async function wr(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission==="default"?await Notification.requestPermission()==="granted":!1:(console.warn("Este navegador nÃ£o suporta notificaÃ§Ãµes"),!1)}function je(t,i={}){if(Notification.permission==="granted"){const o=new Notification(t,{icon:"/favicon.ico",badge:"/favicon.ico",...i});return o.onclick=()=>{window.focus(),o.close()},o}return null}const Ee={accepted:t=>je("Pedido Aceito! ðŸŽ‰",{body:`Seu pedido #${t} foi aceito e estÃ¡ sendo preparado.`,tag:`order-${t}`,requireInteraction:!1}),preparing:t=>je("Pedido em Preparo ðŸ‘¨â€ðŸ³",{body:`Seu pedido #${t} estÃ¡ sendo preparado com carinho!`,tag:`order-${t}`,requireInteraction:!1}),ready:t=>je("Pedido Pronto! âœ…",{body:`Seu pedido #${t} estÃ¡ pronto para retirada ou entrega.`,tag:`order-${t}`,requireInteraction:!0}),outForDelivery:t=>je("Pedido Saiu para Entrega ðŸšš",{body:`Seu pedido #${t} estÃ¡ a caminho!`,tag:`order-${t}`,requireInteraction:!1}),delivered:t=>je("Pedido Entregue! ðŸŽŠ",{body:`Seu pedido #${t} foi entregue. Obrigado pela preferÃªncia!`,tag:`order-${t}`,requireInteraction:!0})},Nr={promotion:(t,i)=>je(t,{body:i,tag:"promotion",requireInteraction:!1}),favoriteOnSale:t=>je("Seu Favorito EstÃ¡ em PromoÃ§Ã£o! ðŸ’",{body:`${t} estÃ¡ com desconto especial!`,tag:"favorite-sale",requireInteraction:!0})},kr="wss://digimenu-backend.onrender.com";function _r({subscriberEmail:t=null,customerEmail:i=null,customerPhone:o=null,onOrderUpdate:x=null,onOrderCreated:l=null,enableNotifications:h=!0}){const s=f.useRef(null),u=f.useRef(!1);return f.useEffect(()=>{h&&!u.current&&wr().then(a=>{u.current=a})},[h]),f.useEffect(()=>{if(!t&&!i&&!o)return;s.current=Qa(kr,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:2});const a=s.current;return a.on("connect",()=>{console.log("âœ… WebSocket conectado:",a.id),a.emit("subscribe:orders",{subscriberEmail:t,customerEmail:i,customerPhone:o})}),a.on("disconnect",()=>{console.log("âŒ WebSocket desconectado")}),a.on("connect_error",()=>{console.warn("âš ï¸ WebSocket indisponÃ­vel â€” notificaÃ§Ãµes em tempo real desativadas. O restante do app funciona normalmente.")}),a.on("order:updated",r=>{if(console.log("ðŸ“¦ Pedido atualizado via WebSocket:",r),x&&x(r),h&&u.current){const c=r.status,d=r.order_code||r.id;c==="accepted"?(Ee.accepted(d),w.success(`Pedido #${d} foi aceito! ðŸŽ‰`)):c==="preparing"?(Ee.preparing(d),w.info(`Pedido #${d} estÃ¡ sendo preparado ðŸ‘¨â€ðŸ³`)):c==="ready"?(Ee.ready(d),w.success(`Pedido #${d} estÃ¡ pronto! âœ…`)):c==="out_for_delivery"?(Ee.outForDelivery(d),w.info(`Pedido #${d} saiu para entrega! ðŸšš`)):c==="delivered"&&(Ee.delivered(d),w.success(`Pedido #${d} foi entregue! ðŸŽŠ`))}}),a.on("order:created",r=>{console.log("ðŸ“¦ Novo pedido via WebSocket:",r),l&&l(r)}),a.on("favorite:promotion",r=>{console.log("ðŸ’ Prato favorito em promoÃ§Ã£o:",r),h&&u.current&&(Nr.favoriteOnSale(r.name),w.custom(c=>e.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-purple-600 text-white p-4 rounded-lg shadow-xl flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ’"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Seu Favorito EstÃ¡ em PromoÃ§Ã£o!"}),e.jsx("p",{className:"text-sm opacity-90",children:r.name})]}),e.jsx("button",{onClick:()=>w.dismiss(c.id),className:"ml-auto text-white/80 hover:text-white",children:"âœ•"})]}),{duration:8e3}))}),()=>{s.current&&(s.current.emit("unsubscribe:orders",{subscriberEmail:t,customerEmail:i,customerPhone:o}),s.current.disconnect(),s.current=null)}},[t,i,o,x,l,h]),s.current}function Cr(t){const i=f.useMemo(()=>{const l=t.is_open===!1,h=t.is_open!==!1&&t.accepting_orders===!1,s=(()=>{if(t.is_open!==null)return!1;const u=new Date,a=u.getDay(),r=u.getHours()*60+u.getMinutes();if(!(t.working_days||[]).includes(a))return!0;const[p,N]=(t.opening_time||"08:00").split(":").map(Number),[k,P]=(t.closing_time||"18:00").split(":").map(Number),v=p*60+N,b=k*60+P;return r<v||r>b})();return{isStoreClosed:l,isStorePaused:h,isAutoModeClosed:s,isStoreUnavailable:l||h||s}},[t]),o=f.useMemo(()=>{if(t.is_open!==null)return null;const l=new Date,h=t.working_days||[],[s,u]=(t.opening_time||"08:00").split(":").map(Number);for(let a=0;a<7;a++){const r=new Date(l);r.setDate(l.getDate()+a);const c=r.getDay();if(h.includes(c))if(a===0){const d=l.getHours()*60+l.getMinutes(),p=s*60+u;if(d<p)return`hoje Ã s ${t.opening_time}`}else return`${["domingo","segunda","terÃ§a","quarta","quinta","sexta","sÃ¡bado"][c]} Ã s ${t.opening_time}`}return null},[t]),x=f.useMemo(()=>{if(t.is_open===!1)return{text:"Loja fechada",color:"text-red-600"};if(t.is_open===!0)return{text:"Aberto 24h",color:"text-green-600"};const l=new Date,h=l.getDay(),s=l.getHours()*60+l.getMinutes();if(!(t.working_days||[]).includes(h))return{text:"Fechado hoje",color:"text-red-600"};const[r,c]=(t.opening_time||"08:00").split(":").map(Number),[d,p]=(t.closing_time||"18:00").split(":").map(Number),N=r*60+c,k=d*60+p;return s>=N&&s<=k?{text:"Aberto agora",color:"text-green-600"}:{text:`Fechado â€¢ Abre Ã s ${t.opening_time}`,color:"text-red-600"}},[t]);return{...i,getNextOpenTime:o,getStatusDisplay:x}}const Sr="cardapio_applied_coupon";function ss(t){return t?`cardapio_applied_coupon_${t}`:Sr}function Pr(t,i,o=null){const x=ss(o),[l,h]=f.useState(""),[s,u]=f.useState(()=>{try{const N=localStorage.getItem(x);return N?JSON.parse(N):null}catch{return null}}),[a,r]=f.useState("");f.useEffect(()=>{try{const N=localStorage.getItem(ss(o));u(N?JSON.parse(N):null)}catch{u(null)}},[o]),f.useEffect(()=>{try{s?localStorage.setItem(x,JSON.stringify(s)):localStorage.removeItem(x)}catch(N){console.error("Erro ao salvar cupom:",N)}},[s,x]);const c=f.useCallback(N=>{r("");const k=(N!=null?String(N):l).toUpperCase().trim();if(!k){const b="Digite um cÃ³digo de cupom";return r(b),{success:!1,error:b}}const P=t.find(b=>b.code===k);if(!P){const b="Cupom nÃ£o encontrado";return r(b),{success:!1,error:b}}if(!P.is_active){const b="Cupom inativo";return r(b),{success:!1,error:b}}if(P.expires_at&&new Date(P.expires_at)<new Date){const b="Cupom expirado";return r(b),{success:!1,error:b}}if(P.max_uses>0&&(P.current_uses||0)>=P.max_uses){const b="Cupom esgotado";return r(b),{success:!1,error:b}}if(P.min_order_value&&i<P.min_order_value){const b=`Pedido mÃ­nimo: R$ ${P.min_order_value.toFixed(2)}`;return r(b),{success:!1,error:b}}return u(P),h(""),{success:!0,error:null,discount:P.discount_type==="percentage"?i*P.discount_value/100:P.discount_value}},[l,t,i]),d=f.useCallback(()=>{u(null),r("")},[]),p=f.useCallback(()=>s?s.discount_type==="percentage"?i*s.discount_value/100:s.discount_value:0,[s,i]);return{couponCode:l,setCouponCode:h,appliedCoupon:s,couponError:a,validateAndApply:c,removeCoupon:d,calculateDiscount:p}}const as="cardapio_customer";function zr(){const[t,i]=f.useState(()=>{try{const x=localStorage.getItem(as);return x?JSON.parse(x):{name:"",phone:"",deliveryMethod:"pickup",address_street:"",address_number:"",address_complement:"",address:"",paymentMethod:"",neighborhood:""}}catch{return{name:"",phone:"",deliveryMethod:"pickup",address_street:"",address_number:"",address_complement:"",address:"",paymentMethod:"",neighborhood:""}}});return f.useEffect(()=>{try{localStorage.setItem(as,JSON.stringify(t))}catch(x){console.error("Erro ao salvar dados do cliente:",x)}},[t]),{customer:t,setCustomer:i,clearCustomer:()=>{i({name:"",phone:"",deliveryMethod:"pickup",address_street:"",address_number:"",address_complement:"",address:"",paymentMethod:"",neighborhood:""})}}}function Ne(t){if(!t)return null;if(t.startsWith("rgb")){const o=t.match(/\d+/g);if(o&&o.length>=3)return{r:parseInt(o[0],10),g:parseInt(o[1],10),b:parseInt(o[2],10)}}const i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}function wt(t,i,o){const[x,l,h]=[t,i,o].map(s=>(s=s/255,s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4)));return .2126*x+.7152*l+.0722*h}function rs(t,i){const o=Ne(t),x=Ne(i);if(!o||!x)return 1;const l=wt(o.r,o.g,o.b),h=wt(x.r,x.g,x.b),s=Math.max(l,h),u=Math.min(l,h);return(s+.05)/(u+.05)}function Nt(t,i=.3){const o=Ne(t);return o?`rgb(${Math.min(255,Math.floor(o.r+(255-o.r)*i))}, ${Math.min(255,Math.floor(o.g+(255-o.g)*i))}, ${Math.min(255,Math.floor(o.b+(255-o.b)*i))})`:t}function Me(t,i="#0f172a"){if(!t)return"#f97316";const o=Ne(t);return o?wt(o.r,o.g,o.b)>.5?Nt(t,.1):Nt(t,.4):t}function $r(t,i="#0f172a"){const o=Me(t,i);if(rs(o,i)>=4.5)return o;let l=o,h=0;for(;rs(l,i)<4.5&&h<10&&Ne(l);)l=Nt(l,.1),h++;return l}function Dr(t,i="#0f172a"){const o=Me(t,i),x=Ne(o);if(!x)return"#cbd5e1";const l={r:203,g:213,b:225},h={r:Math.floor(x.r*.3+l.r*.7),g:Math.floor(x.g*.3+l.g*.7),b:Math.floor(x.b*.3+l.b*.7)};return`rgb(${h.r}, ${h.g}, ${h.b})`}function Fr(t){const i=Ne(t);if(!i)return"#0f172a";const o={r:15,g:23,b:42},x={r:Math.floor(i.r*.2),g:Math.floor(i.g*.2),b:Math.floor(i.b*.2)};return`rgb(${Math.floor(o.r*.9+x.r*.1)}, ${Math.floor(o.g*.9+x.g*.1)}, ${Math.floor(o.b*.9+x.b*.1)})`}function Ar(t){const[i,o]=f.useState(()=>typeof window>"u"?!1:document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches);f.useEffect(()=>{const s=new MutationObserver(()=>{o(document.documentElement.classList.contains("dark"))});s.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const u=window.matchMedia("(prefers-color-scheme: dark)"),a=r=>{!document.documentElement.classList.contains("dark")&&!document.documentElement.classList.contains("light")&&o(r.matches)};return u.addEventListener("change",a),()=>{s.disconnect(),u.removeEventListener("change",a)}},[]);const x=t?.theme_primary_color||t?.primary_color||"#f97316",l=t?.theme_secondary_color||t?.secondary_color||"#1f2937",h=t?.theme_accent_color||t?.accent_color||"#eab308";return f.useMemo(()=>{if(!i)return{primary:x,secondary:l,accent:h,textPrimary:"#1a1a1a",textSecondary:"#4a5568",textMuted:"#718096",background:"#ffffff"};const s=Fr(x);return{primary:Me(x,s),secondary:Me(l,s),accent:Me(h,s),textPrimary:$r(x,s),textSecondary:Dr(x,s),textMuted:"#94a3b8",background:s}},[i,x,l,h])}function Er(t=[],i,o,x){const{favorites:l,isFavorite:h}=ds(x),s=f.useRef({});f.useEffect(()=>{!t.length||!l.length||l.forEach(u=>{const a=t.find(k=>k.id===u.id);if(!a)return;const r=s.current[a.id],c=a.price,d=a.original_price||a.price,p=d>c,N=r&&r.originalPrice>r.currentPrice;if(p&&!N&&h(a.id)&&(i||o)){try{const k=window.socket;k&&k.connected&&k.emit("favorite:promotion",a)}catch{console.log("WebSocket nÃ£o disponÃ­vel para notificaÃ§Ã£o de promoÃ§Ã£o")}w.custom(k=>e.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-purple-600 text-white p-4 rounded-lg shadow-xl flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ’"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Seu Favorito EstÃ¡ em PromoÃ§Ã£o!"}),e.jsx("p",{className:"text-sm opacity-90",children:a.name}),e.jsxs("p",{className:"text-xs opacity-75",children:["De ",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(d)," ","por ",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c)]})]}),e.jsx("button",{onClick:()=>w.dismiss(k.id),className:"ml-auto text-white/80 hover:text-white",children:"âœ•"})]}),{duration:8e3})}s.current[a.id]={currentPrice:c,originalPrice:d}})},[t,l,i,o,h])}const os={isUnlimited(t){return t==null||t===""},isOutOfStock(t){return!this.isUnlimited(t)&&t<=0},isLowStock(t){return!this.isUnlimited(t)&&t>0&&t<=5},canAddToCart(t){return!this.isOutOfStock(t.stock)}};function Or(){return e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"text-center max-w-md p-8 rounded-2xl bg-white dark:bg-gray-800 shadow-xl border border-gray-200 dark:border-gray-700",children:[e.jsx("img",{src:ua,alt:Oe,className:"h-16 w-auto mx-auto mb-4 drop-shadow-md"}),e.jsx("h1",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:Oe}),e.jsxs("p",{className:"mt-3 text-gray-600 dark:text-gray-400",children:["O cardÃ¡pio digital Ã© acessado pelo link do estabelecimento: ",e.jsx("strong",{children:"/s/nome-do-restaurante"})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-500",children:"Ex.: /s/raiz-maranhense"}),e.jsxs("p",{className:"mt-3 text-xs text-gray-500 dark:text-gray-400 border-t border-gray-200 dark:border-gray-600 pt-3",children:[e.jsx("strong",{children:"Master:"})," abra o cardÃ¡pio em ",e.jsx("strong",{children:"Admin â†’ Assinantes"})," e use ",e.jsx("strong",{children:"â‹® â†’ Abrir cardÃ¡pio"})," no assinante desejado. ",e.jsx("strong",{children:"Assinante:"})," use o link do seu painel ou Loja."]}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(Ye,{to:"/assinar",className:"px-4 py-2.5 rounded-lg bg-orange-500 text-white font-medium hover:bg-orange-600 transition-colors",children:["Assinar ",Oe]}),e.jsx(Ye,{to:"/",className:"px-4 py-2.5 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Voltar ao inÃ­cio"})]}),e.jsx("a",{href:"/",className:"mt-4 inline-block text-sm text-gray-500 dark:text-gray-400 hover:text-orange-500",children:"Voltar ao inÃ­cio"})]})})}function ii(){const{slug:t}=ma();ns(),f.useEffect(()=>{t&&typeof localStorage<"u"&&localStorage.setItem("lastVisitedSlug",t)},[t]);const[i,o]=f.useState(null),[x,l]=f.useState(null),[h,s]=f.useState(null),[u,a]=f.useState(""),[r,c]=f.useState("all"),[d,p]=f.useState(!1),[N,k]=f.useState("menu"),[P,v]=f.useState(!1),[b,z]=f.useState(!1),[$,y]=f.useState(!1),[T,Y]=f.useState(!1),[J,re]=f.useState(!1),[fe,le]=f.useState(!1),[B,ee]=f.useState(!1),[j,_]=f.useState(null),[A,te]=f.useState(null),[De,D]=f.useState(!1),[S,W]=f.useState(!1),[G,Q]=f.useState(!1),[L,U]=f.useState(!1),[et,ke]=f.useState(!1),Fe=is(),{cart:O,addItem:ce,updateItem:tt,removeItem:st,updateQuantity:fs,clearCart:_t,cartTotal:Ie,cartItemsCount:_e}=fa(t),{customer:M,setCustomer:bs,clearCustomer:ys}=zr(),{addPoints:Ct,loyaltyData:at,applyReferralCode:js,checkBirthdayBonus:vs,applyReviewBonus:ws,checkConsecutiveOrdersBonus:Ns}=ba(M.phone?.replace(/\D/g,""),j,t);_r({customerEmail:j,customerPhone:M.phone?.replace(/\D/g,""),enableNotifications:!0,onOrderUpdate:n=>{Fe.setQueryData(["customerOrders",j],g=>{if(!g)return[n];const C=g.findIndex(F=>F.id===n.id);if(C>=0){const F=[...g];return F[C]=n,F}return[...g,n]})}});const[rt,Ce]=f.useState(!1),{data:X,isLoading:ue,isError:Ae,error:Le}=Z({queryKey:["publicCardapio",t],queryFn:async()=>{const n=new AbortController,g=setTimeout(()=>n.abort(),15e3);try{const C=await I.get(`/public/cardapio/${t}`,{},{signal:n.signal});return clearTimeout(g),console.log("âœ… [Cardapio] Dados recebidos:",C),Ce(!1),C}catch(C){if(clearTimeout(g),C?.name==="AbortError"){const F=new Error("O servidor demorou para responder. Tente novamente.");throw F.isTimeout=!0,F}throw console.error("âŒ [Cardapio] Erro ao buscar cardÃ¡pio pÃºblico:",C),Ce(!0),C}},enabled:!!t,retry:2,retryDelay:1500,staleTime:60*1e3,refetchOnMount:"always",refetchOnWindowFocus:!0});f.useEffect(()=>{if(t&&ue){const n=setTimeout(()=>{Ce(!0),console.warn("âš ï¸ [Cardapio] Timeout de carregamento atingido")},3e3);return()=>clearTimeout(n)}else Ce(!1)},[t,ue]);const{data:ks=[],isLoading:_s}=Z({queryKey:["dishes"],queryFn:()=>I.entities.Dish.list("order"),enabled:!1,staleTime:120*1e3,gcTime:300*1e3,initialData:[],refetchOnMount:!1,refetchOnWindowFocus:!1}),{data:Cs=[]}=Z({queryKey:["categories"],queryFn:()=>I.entities.Category.list("order"),enabled:!1,staleTime:600*1e3,gcTime:1800*1e3}),{data:Ss=[]}=Z({queryKey:["complementGroups"],queryFn:()=>I.entities.ComplementGroup.list("order"),enabled:!1,staleTime:600*1e3,gcTime:1800*1e3,refetchOnMount:"always"}),{data:Ps=[]}=Z({queryKey:["pizzaSizes"],queryFn:()=>I.entities.PizzaSize.list("order"),enabled:!1,staleTime:600*1e3,gcTime:1800*1e3}),{data:zs=[]}=Z({queryKey:["pizzaFlavors"],queryFn:()=>I.entities.PizzaFlavor.list("order"),enabled:!1,staleTime:600*1e3,gcTime:1800*1e3}),{data:$s=[]}=Z({queryKey:["pizzaEdges"],queryFn:()=>I.entities.PizzaEdge.list("order"),enabled:!1}),{data:Ds=[]}=Z({queryKey:["pizzaExtras"],queryFn:()=>I.entities.PizzaExtra.list("order"),enabled:!1}),{data:Fs=[]}=Z({queryKey:["store"],queryFn:()=>I.entities.Store.list(),enabled:!1}),{data:As=[]}=Z({queryKey:["coupons"],queryFn:()=>I.entities.Coupon.list(),enabled:!1}),{data:Es=[]}=Z({queryKey:["deliveryZones"],queryFn:()=>I.entities.DeliveryZone.list(),enabled:!1}),{data:Os=[]}=Z({queryKey:["promotions"],queryFn:()=>I.entities.Promotion.list(),enabled:!1}),se=t&&X?X:null,ot=se?.store||Fs?.[0]||null,m=ot?{...ot,name:ot.name||"Loja"}:null;f.useEffect(()=>{t&&X&&console.log("ðŸ“Š [Cardapio] Dados do cardÃ¡pio pÃºblico:",{slug:t,is_master:X.is_master,subscriber_email:X.subscriber_email,store:m?{name:m.name,logo:m.logo,primary_color:m.primary_color}:null,dishes_count:X.dishes?.length||0,categories_count:X.categories?.length||0})},[t,X,m]);const ae=se?.dishes??ks??[],it=se?.categories??Cs??[],nt=se?.complementGroups??Ss??[],Se=se?.pizzaSizes??Ps??[],qe=se?.pizzaFlavors??zs??[],Ms=se?.pizzaEdges??$s??[],Ts=se?.pizzaExtras??Ds??[],Ue=se?.pizzaCategories??[],St=se?.beverageCategories??[],lt=se?.deliveryZones??Es??[],Rs=se?.coupons??As??[],Be=se?.promotions??Os??[],Pt=t?ue:_s;Va(m),Er(ae,j,M.phone?.replace(/\D/g,""),t);const Is=jt({mutationFn:n=>I.entities.Order.create(n)}),Ls=jt({mutationFn:({id:n,data:g})=>I.entities.Coupon.update(n,g)}),ct=Ar(m),R=ct.primary,zt=ct.textPrimary,qs=ct.textSecondary;m?.theme_header_bg,m?.theme_header_text;const Us=m?.menu_layout||"grid",{isStoreUnavailable:$t,isStoreClosed:Dt,isStorePaused:Ft,isAutoModeClosed:Bs,getNextOpenTime:Ws,getStatusDisplay:dt}=Cr(m||{}),Vs=!$t&&!Dt&&!Ft,{couponCode:Hs,setCouponCode:Ks,appliedCoupon:mt,couponError:Gs,validateAndApply:Qs,removeCoupon:At,calculateDiscount:Et}=Pr(Rs,Ie,t),{showUpsellModal:Zs,upsellPromotions:Ys,checkUpsell:Js,resetUpsell:Ot,closeUpsell:We}=xa(Be),be=f.useMemo(()=>(Array.isArray(ae)?ae:[]).filter(g=>{if(g.product_type==="beverage"||g.is_active===!1||!g.name||g.name.trim()==="")return!1;if(g.product_type==="pizza"){if(Se.length===0||qe.length===0)return!1}else if(g.price===null||g.price===void 0)return!1;return!0}),[ae,Se,qe]),Ve=f.useMemo(()=>(Array.isArray(ae)?ae:[]).filter(g=>!(g.product_type!=="beverage"||g.is_active===!1||!g.name||g.name.trim()===""||g.price===null||g.price===void 0)),[ae]),Mt=f.useMemo(()=>(Array.isArray(be)?be:[]).filter(g=>g.is_highlight),[be]),Xs=f.useMemo(()=>(Array.isArray(Be)?Be:[]).filter(n=>n.is_active),[Be]),Tt=f.useMemo(()=>{const n=Array.isArray(be)?be:[],g=r?.startsWith?.("pc_");if(r==="beverages"||r?.startsWith?.("bc_"))return[];const F=g?r.replace(/^pc_/,""):null;return n.filter(q=>{const de=!u||q.name?.toLowerCase().includes(u.toLowerCase()),ut=r==="all"||g&&q.product_type==="pizza"&&q.pizza_category_id===F||!g&&q.category_id===r;return de&&ut})},[be,u,r]),Rt=f.useMemo(()=>{if(r!=="beverages"&&!r?.startsWith?.("bc_"))return[];const n=Array.isArray(Ve)?Ve:[],g=r?.startsWith?.("bc_")?r.replace(/^bc_/,""):null;return n.filter(C=>{const F=!u||C.name?.toLowerCase().includes(u.toLowerCase()),q=r==="beverages"||!g||C.category_id===g;return F&&q})},[Ve,u,r]);f.useEffect(()=>{(async()=>{try{if(!localStorage.getItem("auth_token")){ee(!1);return}const C=await I.auth.isAuthenticated();if(ee(C),C)try{const F=await I.auth.me();if(_(F?.email||null),F?.email)try{const q=await I.entities.Customer.filter({email:F.email});q.length>0&&q[0].profile_picture&&te(q[0].profile_picture)}catch(q){console.log("Erro ao buscar foto do perfil (nÃ£o crÃ­tico):",q)}}catch(F){console.log("Erro ao buscar email do usuÃ¡rio (nÃ£o crÃ­tico):",F),ee(!1)}}catch(g){console.log("Erro ao verificar autenticaÃ§Ã£o (nÃ£o crÃ­tico):",g),ee(!1)}})()},[]);const He=ze.useRef(null);if(f.useEffect(()=>{if(!t){D(!1),He.current=null;return}if(!ue){if(X&&X.store){if(He.current!==t){He.current=t,D(!0);const n=setTimeout(()=>D(!1),1200);return()=>clearTimeout(n)}return}!X&&!ue&&(D(!1),He.current=null)}},[X,ue,t]),f.useEffect(()=>{if(!(!t||O.length>0))try{const n=`cardapio_cart_${t}`,g=localStorage.getItem(n);if(g){const C=JSON.parse(g);if(Array.isArray(C)&&C.length>0){const F=setTimeout(()=>{w(q=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"font-semibold",children:"VocÃª tinha itens no carrinho!"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Deseja recuperar seu pedido anterior?"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{onClick:()=>{C.forEach(de=>ce(de)),localStorage.removeItem(n),w.dismiss(q.id),w.success("Carrinho recuperado!")},className:"px-4 py-2 bg-orange-500 text-white rounded-lg font-medium hover:bg-orange-600 transition-colors",children:"Sim, recuperar"}),e.jsx("button",{onClick:()=>{localStorage.removeItem(n),w.dismiss(q.id)},className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"NÃ£o, obrigado"})]})]}),{duration:1e4,position:"top-center"})},2e3);return()=>clearTimeout(F)}}}catch(n){console.error("Erro ao recuperar carrinho:",n)}},[t,O.length,ce]),f.useEffect(()=>{if(!t||!m)return;const n=`welcome_discount_${t}`;if(!localStorage.getItem(n)){const C=setTimeout(()=>{re(!0)},1e4);return()=>clearTimeout(C)}},[t,m]),t&&Ae){const n=Le?.isTimeout||Le?.message?.includes("fetch")||Le?.message?.includes("rede");return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"text-center max-w-md p-6 rounded-xl bg-white dark:bg-gray-800 shadow-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-xl font-medium text-gray-800 dark:text-gray-100",children:n?"NÃ£o foi possÃ­vel carregar":"Link nÃ£o encontrado"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:n?"O servidor pode estar iniciando ou a conexÃ£o falhou. Tente novamente em alguns segundos.":"Este cardÃ¡pio nÃ£o existe ou o link estÃ¡ incorreto. Verifique com o estabelecimento."}),e.jsx(V,{onClick:()=>Fe.invalidateQueries({queryKey:["publicCardapio",t]}),className:"mt-4 bg-orange-500 text-white hover:bg-orange-600",children:"Tentar novamente"}),e.jsxs(Ye,{to:"/assinar",className:"mt-4 block text-sm text-orange-600 hover:underline",children:["Assinar ",Oe]})]})})}if(!t)return e.jsx(Or,{});const Ke=async(n,g=!1)=>{const C=n.dish||n;if(!os.canAddToCart(C)){w.error("Este produto estÃ¡ esgotado");return}if(g||h){tt(h?.id||n.id,n),s(null),o(null),l(null),w.success("Item atualizado no carrinho");return}if(ce(n),o(null),l(null),C.product_type==="pizza"&&n.selections?.flavors)try{const q=n.selections.flavors.map(de=>de.id);await I.functions.invoke("trackPizzaCombination",{pizza_id:C.id,flavor_ids:q})}catch(q){console.log("Erro ao rastrear combinaÃ§Ã£o:",q)}w.success(e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"âœ…"}),e.jsx("span",{children:"Adicionado ao carrinho!"})]}),{duration:2e3});const F=Ie+n.totalPrice;Js(F)},Ge=n=>{console.log("ðŸ• Clicou no prato:",n.name,"Tipo:",n.product_type),n.product_type==="pizza"?(console.log("âœ… Ã‰ pizza! Abrindo PizzaBuilder..."),l(n)):(console.log("ðŸ“¦ NÃ£o Ã© pizza, abrindo modal normal"),o(n))},ea=n=>{st(n),w.success("Item removido do carrinho"),O.length===1&&Ot()},ta=(n,g)=>{fs(n,g)},It=n=>{const g=Qs(n);if(g.success){const C=g.discount??Et();w.success(e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"ðŸŽ‰ Cupom aplicado!"}),e.jsxs("p",{className:"text-sm",children:["VocÃª economizou ",he(C)]})]}))}else g.error&&w.error(g.error)},sa=()=>{At(),w.success("Cupom removido")},aa=n=>{s(n),n.dish?.product_type==="pizza"?l(n.dish):o(n.dish),p(!1)},ra=n=>{s(n),l(n.dish),p(!1)},oa=n=>{if(!n)return;const g=ae.find(F=>F.id===n.offer_dish_id);if(!g){We();return}n.type==="replace"&&_t();const C={...g,price:n.offer_price,original_price:n.original_price,_isPromo:!0};Ge(C),We()},ia=async()=>{const n=Pe.generateOrderCode(),g=Pe.formatFullAddress(M);if(M.deliveryMethod==="delivery"&&!M.neighborhood){w.error("Por favor, informe o bairro para calcular a taxa de entrega");return}const C=Pe.calculateDeliveryFee(M.deliveryMethod,M.neighborhood,lt,m,M.latitude,M.longitude),F=Et(),{total:q}=Pe.calculateTotals(Ie,F,C);let de;if(B)try{de=(await I.auth.me())?.email}catch(xe){console.error("Erro ao buscar usuÃ¡rio:",xe)}const ut={order_code:n,customer_name:M.name,customer_phone:M.phone,customer_email:de,created_by:de,customer_latitude:M.latitude||null,customer_longitude:M.longitude||null,delivery_method:M.deliveryMethod,address_street:M.address_street,address_number:M.address_number,address_complement:M.address_complement,address:g,neighborhood:M.neighborhood,payment_method:M.paymentMethod,needs_change:M.needs_change||!1,change_amount:M.change_amount?parseFloat(M.change_amount):null,scheduled_date:M.scheduled_date||null,scheduled_time:M.scheduled_time||null,items:O,subtotal:Ie,delivery_fee:C,discount:totalDiscount,coupon_code:mt?.code,loyalty_discount:loyaltyDiscountAmount,loyalty_tier:at?.tier||"bronze",loyalty_points_earned:Math.floor(q),total:q,status:"new",...(M.customer_change_request||"").trim()&&{customer_change_request:(M.customer_change_request||"").trim(),customer_change_status:"pending"},...t&&X?.subscriber_email&&{owner_email:X.subscriber_email}},na=await Pe.createOrder(ut,Is);if(await Pe.updateCouponUsage(mt,Ls),M.phone||de)try{const xe=Math.floor(q),qt=await Ct(xe,"compra");at.lastOrderDate||(await Ct(50,"primeira_compra"),w.success("ðŸŽ‰ BÃ´nus de primeira compra: +50 pontos!",{duration:4e3}));const xt=await vs();xt&&xt.success&&w.success(xt.message,{duration:5e3});const ht=await Ns();ht&&ht.success&&w.success(ht.message,{duration:5e3}),w.success(`âœ¨ VocÃª ganhou ${xe} pontos! Total: ${qt.points} pontos (${qt.tier.name})`,{duration:5e3})}catch(xe){console.error("Erro ao adicionar pontos:",xe)}if(gt.shouldSendWhatsApp(m)&&m?.whatsapp){const xe=gt.formatOrderMessage(na,O,nt,he);gt.sendToWhatsApp(m?.whatsapp,xe)}_t(),At(),ys(),k("menu"),Ot(),w.success(e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-bold mb-1",children:"âœ… Pedido enviado com sucesso!"}),e.jsxs("p",{className:"text-sm",children:["Pedido #",n]}),e.jsx("button",{onClick:()=>v(!0),className:"mt-2 text-blue-600 font-medium text-sm underline",children:"Acompanhar pedido"})]}),{duration:5e3})},Lt=t&&ue&&rt;return t&&ue?e.jsxs("div",{className:"min-h-screen min-h-screen-mobile flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900",children:[e.jsx(Ut,{position:"top-center"}),!(Lt||Ae)&&e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Carregando cardÃ¡pio..."})]}),(Lt||Ae)&&e.jsxs("div",{className:"text-center max-w-xs px-4",children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm mb-3",children:Ae?Le?.isTimeout?"O servidor demorou para responder.":"NÃ£o foi possÃ­vel carregar o cardÃ¡pio. Verifique o link e a conexÃ£o.":"EstÃ¡ demorando mais que o normal."}),e.jsx(V,{onClick:()=>{Ce(!1),Fe.invalidateQueries({queryKey:["publicCardapio",t]})},className:"bg-orange-500 text-white hover:bg-orange-600",children:"Tentar novamente"})]})]}):e.jsxs("div",{className:"min-h-screen min-h-screen-mobile bg-background",children:[e.jsx(Ut,{position:"top-center"}),e.jsx(me,{children:De&&e.jsx(E.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.35},className:"fixed inset-0 z-[9999] flex flex-col items-center justify-center",style:{backgroundColor:R},children:e.jsxs(E.div,{initial:{scale:.85,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},className:"flex flex-col items-center gap-5 px-6",children:[m?.logo&&e.jsx("img",{src:m.logo,alt:m.name||"Restaurante",className:"h-24 w-24 max-w-[280px] object-contain drop-shadow-lg rounded-xl"}),e.jsx("p",{className:"text-white font-semibold text-xl text-center drop-shadow-sm",children:m?.name||(ue?"Carregando...":"CardÃ¡pio")}),rt&&Ae&&e.jsxs("div",{className:"mt-4 text-center max-w-sm",children:[e.jsx("p",{className:"text-white/90 text-sm mb-3",children:"Erro ao carregar cardÃ¡pio"}),e.jsx(V,{onClick:()=>{Ce(!1),window.location.reload()},className:"bg-white text-orange-500 hover:bg-gray-100 px-4 py-2 rounded-lg font-medium",children:"Tentar Novamente"})]}),!rt&&e.jsx(E.div,{animate:{opacity:[.4,1,.4]},transition:{duration:.8,repeat:1/0},className:"h-1 w-24 rounded-full bg-white/70"})]})})}),$t&&e.jsx(dr,{isStoreClosed:Dt,isAutoModeClosed:Bs,isStorePaused:Ft,getNextOpenTime:Ws,store:m}),m?.banner_image?e.jsxs("div",{className:"relative w-full h-[200px] md:h-[88px] overflow-hidden",children:[e.jsx("img",{src:m?.banner_image,alt:m?.name||"Restaurante",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-black/30"}),e.jsxs("div",{className:"absolute inset-0 z-30 flex flex-col md:flex-row md:items-center md:justify-between md:gap-4 md:px-4 md:py-3",children:[e.jsxs("div",{className:"flex items-center gap-3 pt-4 pl-4 md:pt-0 md:pl-0 md:flex-shrink-0",children:[m?.logo&&e.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-full bg-white/95 backdrop-blur-sm p-1 shadow-2xl border-2 border-white/50 flex-shrink-0",children:e.jsx("img",{src:m?.logo,alt:m?.name||"Restaurante",className:"w-full h-full rounded-full object-cover"})}),e.jsxs("div",{className:"text-white",children:[e.jsx("h1",{className:"text-lg md:text-xl font-bold drop-shadow-lg leading-tight",children:m?.name||"Restaurante"}),e.jsxs("div",{className:"flex items-center gap-3 mt-0.5 md:mt-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${Vs?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-xs font-medium",children:dt.text})]}),m?.min_order_value>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-white/60",children:"â€¢"}),e.jsxs("span",{className:"text-xs opacity-90",children:["Pedido mÃ­n. ",e.jsx("span",{className:"font-semibold",children:he(m?.min_order_value||0)})]})]})]})]})]}),e.jsx("div",{className:"absolute top-20 left-4 right-4 md:static md:flex-1 md:max-w-xl md:mx-4 z-30",children:e.jsxs("div",{className:"relative",children:[e.jsx(Xt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/80 md:text-muted-foreground"}),e.jsx(H,{placeholder:"O que vocÃª procura hoje?",value:u,onChange:n=>a(n.target.value),className:"pl-10 h-11 md:h-10 text-base bg-white/90 md:bg-white/95 backdrop-blur-sm border-white/30 text-foreground placeholder:text-muted-foreground"})]})}),e.jsxs("div",{className:"absolute top-4 right-4 md:static flex items-center gap-2 md:flex-shrink-0",children:[e.jsx(Jt,{pageName:"CardÃ¡pio",compact:!0}),e.jsx("button",{className:"p-2 rounded-full min-h-touch min-w-touch bg-white/20 hover:bg-white/30 backdrop-blur-sm transition-colors text-white flex items-center justify-center",onClick:()=>{navigator.share?navigator.share({title:m?.name||"CardÃ¡pio",text:`Confira o cardÃ¡pio de ${m?.name||"nosso restaurante"}`,url:window.location.href}).catch(()=>{}):(navigator.clipboard.writeText(window.location.href),w.success("Link copiado!"))},title:"Compartilhar",children:e.jsx(pt,{className:"w-5 h-5"})}),e.jsx(yt,{className:"text-white hover:bg-white/20"}),e.jsxs("button",{className:`p-0.5 rounded-full backdrop-blur-sm transition-all ${B?"bg-green-500/90 hover:bg-green-600":"bg-white/20 hover:bg-white/30"} text-white relative`,onClick:()=>{B?z(!0):window.location.href=t?`/s/${t}/login/cliente?returnUrl=${encodeURIComponent(window.location.pathname)}`:`/?returnUrl=${encodeURIComponent(window.location.pathname)}`},title:B?"Meu Perfil":"Entrar / Cadastrar",children:[B&&A?e.jsx("img",{src:A,alt:"Perfil",className:"w-8 h-8 rounded-full object-cover border-2 border-white"}):e.jsx(ve,{className:"w-5 h-5 m-1.5"}),B&&!A&&e.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 border-2 border-white rounded-full"})]}),e.jsxs("button",{className:"hidden md:flex p-2 rounded-full relative bg-white/20 hover:bg-white/30 backdrop-blur-sm transition-colors text-white",onClick:()=>p(!0),children:[e.jsx(ye,{className:"w-5 h-5"}),O.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold",children:_e})]})]})]})]}):e.jsx("header",{className:"border-b border-border sticky top-0 z-40 pb-4 md:pb-2 bg-card",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 pt-6 md:pt-3 md:py-3",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 md:mb-0 md:flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[m?.logo?e.jsx("img",{src:m?.logo,alt:m?.name||"Restaurante",className:"w-16 h-16 md:w-14 md:h-14 rounded-xl object-cover shadow-md"}):e.jsx("div",{className:"w-16 h-16 md:w-14 md:h-14 rounded-xl flex items-center justify-center text-3xl shadow-md",style:{backgroundColor:R},children:"ðŸ½ï¸"}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-xl md:text-lg text-foreground",children:m?.name||"Restaurante"}),m?.min_order_value>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Pedido mÃ­n. ",he(m?.min_order_value||0)]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 md:hidden",children:[e.jsx(Jt,{pageName:"CardÃ¡pio",compact:!0}),e.jsx("button",{className:"p-2 rounded-lg min-h-touch min-w-touch text-muted-foreground",onClick:()=>{navigator.share?navigator.share({title:m?.name||"CardÃ¡pio",text:`Confira o cardÃ¡pio de ${m?.name||"nosso restaurante"}`,url:window.location.href}).catch(()=>{}):(navigator.clipboard.writeText(window.location.href),w.success("Link copiado!"))},children:e.jsx(pt,{className:"w-5 h-5"})}),e.jsx(yt,{}),e.jsx("button",{className:`p-0.5 rounded-lg relative ${B?"text-green-600":"text-muted-foreground"}`,onClick:()=>B?z(!0):window.location.href=t?`/s/${t}/login/cliente?returnUrl=${encodeURIComponent(window.location.pathname)}`:`/?returnUrl=${encodeURIComponent(window.location.pathname)}`,children:B&&A?e.jsx("img",{src:A,alt:"Perfil",className:"w-8 h-8 rounded-full object-cover border-2 border-green-600"}):e.jsx(ve,{className:"w-5 h-5 m-1.5"})}),e.jsxs("button",{className:"p-2 rounded-lg relative text-muted-foreground",onClick:()=>p(!0),children:[e.jsx(ye,{className:"w-5 h-5"}),O.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold",children:_e})]})]})]}),e.jsxs("div",{className:"relative flex-1 md:max-w-xl md:mx-4",children:[e.jsx(Xt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(H,{placeholder:"O que vocÃª procura hoje?",value:u,onChange:n=>a(n.target.value),className:"pl-10 h-12 md:h-10 text-base"})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-2 flex-shrink-0",children:[e.jsx("button",{className:"p-2 rounded-lg transition-colors text-muted-foreground hover:text-foreground hover:bg-muted",onClick:()=>{navigator.share?navigator.share({title:m?.name||"CardÃ¡pio",text:`Confira o cardÃ¡pio de ${m?.name||"nosso restaurante"}`,url:window.location.href}).catch(()=>{}):(navigator.clipboard.writeText(window.location.href),w.success("Link copiado!"))},title:"Compartilhar",children:e.jsx(pt,{className:"w-5 h-5"})}),e.jsx(yt,{className:"text-muted-foreground hover:text-foreground hover:bg-muted"}),e.jsx("button",{className:`relative p-0.5 rounded-lg transition-all ${B?"text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20":"text-muted-foreground hover:text-foreground hover:bg-muted"}`,onClick:()=>B?z(!0):window.location.href=t?`/s/${t}/login/cliente?returnUrl=${encodeURIComponent(window.location.pathname)}`:`/?returnUrl=${encodeURIComponent(window.location.pathname)}`,title:B?"Meu Perfil":"Entrar",children:B&&A?e.jsx("img",{src:A,alt:"Perfil",className:"w-8 h-8 rounded-full object-cover border-2 border-green-600"}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-5 h-5 m-1.5"}),B&&e.jsx("span",{className:"absolute top-1 right-1 w-2.5 h-2.5 bg-green-500 rounded-full border-2 border-white dark:border-gray-900"})]})}),e.jsxs("button",{className:"p-2 rounded-lg relative transition-colors text-muted-foreground hover:text-foreground hover:bg-muted",onClick:()=>p(!0),children:[e.jsx(ye,{className:"w-5 h-5"}),O.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold",children:_e})]})]})]}),e.jsx("div",{className:"text-center mt-2 md:mt-1",children:e.jsxs("span",{className:`text-xs font-medium ${dt.color}`,children:["â— ",dt.text]})})]})}),e.jsx("div",{className:`bg-card border-b border-border sticky z-30 ${m?.banner_image?"md:top-0 top-0":"md:top-[88px] top-[165px]"}`,children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsx("div",{className:"flex items-center justify-between gap-3 md:py-3 py-4",children:e.jsxs("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide flex-1",children:[e.jsx("button",{onClick:()=>c("all"),className:`relative px-6 md:px-8 py-2.5 md:py-3 rounded-full text-sm md:text-base font-semibold whitespace-nowrap transition-all duration-200 ${r==="all"?"text-white shadow-lg scale-105":"text-muted-foreground hover:bg-muted hover:text-foreground"}`,style:r==="all"?{backgroundColor:R,color:"white"}:{},children:"Todos"}),it.map(n=>e.jsx("button",{onClick:()=>c(n.id),className:`relative px-6 md:px-8 py-2.5 md:py-3 rounded-full text-sm md:text-base font-semibold whitespace-nowrap transition-all duration-200 ${r===n.id?"text-white shadow-lg scale-105":"text-muted-foreground hover:bg-muted hover:text-foreground"}`,style:r===n.id?{backgroundColor:R,color:"white"}:{},children:n.name},n.id)),Ue?.length>0&&Ue.map(n=>{const g=`pc_${n.id}`,C=Se?.find(q=>q.id===n.size_id),F=n.name||(C?`${C.name} â€¢ ${n.max_flavors||1} sabor(es)`:n.id);return e.jsx("button",{onClick:()=>c(g),className:`relative px-6 md:px-8 py-2.5 md:py-3 rounded-full text-sm md:text-base font-semibold whitespace-nowrap transition-all duration-200 ${r===g?"text-white shadow-lg scale-105":"text-muted-foreground hover:bg-muted hover:text-foreground"}`,style:r===g?{backgroundColor:R,color:"white"}:{},children:F},g)}),Ve.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>c("beverages"),className:`relative px-6 md:px-8 py-2.5 md:py-3 rounded-full text-sm md:text-base font-semibold whitespace-nowrap transition-all duration-200 ${r==="beverages"?"text-white shadow-lg scale-105":"text-muted-foreground hover:bg-muted hover:text-foreground"}`,style:r==="beverages"?{backgroundColor:R,color:"white"}:{},children:"Bebidas"}),St?.map(n=>{const g=`bc_${n.id}`;return e.jsx("button",{onClick:()=>c(g),className:`relative px-6 md:px-8 py-2.5 md:py-3 rounded-full text-sm md:text-base font-semibold whitespace-nowrap transition-all duration-200 ${r===g?"text-white shadow-lg scale-105":"text-muted-foreground hover:bg-muted hover:text-foreground"}`,style:r===g?{backgroundColor:R,color:"white"}:{},children:n.name},g)})]})]})})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-6 pb-24 md:pb-12 md:max-w-[1400px]",children:[(Array.isArray(m?.banners)?m.banners:[]).filter(n=>n.active!==!1&&n.image).length>0&&e.jsx("div",{className:"mb-6 space-y-3",children:(Array.isArray(m?.banners)?m.banners:[]).filter(n=>n.active!==!1&&n.image).map((n,g)=>e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative w-full h-32 md:h-40 rounded-2xl overflow-hidden cursor-pointer",onClick:()=>{n.link&&window.open(n.link,"_blank")},children:[e.jsx("img",{src:n.image,alt:n.title||"Banner promocional",className:"w-full h-full object-cover"}),(n.title||n.subtitle)&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent flex items-end p-4",children:e.jsxs("div",{className:"text-white",children:[n.title&&e.jsx("h3",{className:"font-bold text-lg md:text-xl mb-1",children:n.title}),n.subtitle&&e.jsx("p",{className:"text-sm md:text-base opacity-90",children:n.subtitle})]})})]},g))}),e.jsx("div",{"data-section":"promotions",children:e.jsx(or,{promotions:Xs,dishes:ae,primaryColor:R,onSelectPromotion:o,store:m})}),!B&&e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6 p-4 rounded-xl bg-gradient-to-r from-orange-50 via-amber-50 to-orange-50 dark:from-orange-900/20 dark:via-amber-900/20 dark:to-orange-900/20 border border-orange-200 dark:border-orange-800",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-orange-500 to-amber-500 flex items-center justify-center flex-shrink-0",children:e.jsx(we,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:"Cadastre-se gratuitamente"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Ganhe pontos, promoÃ§Ãµes exclusivas e muito mais"})]})]}),e.jsxs(V,{onClick:()=>Y(!0),className:"bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white text-sm font-medium px-4 py-2 h-auto whitespace-nowrap",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Cadastrar-se"]})]})}),e.jsx(ir,{dishes:be,onSelectDish:o,primaryColor:R}),Mt.length>0&&e.jsxs("section",{className:"mb-6 md:mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 md:mb-4",children:[e.jsx(kt,{className:"w-5 h-5 fill-yellow-400 text-yellow-400"}),e.jsx("h2",{className:"font-bold text-base md:text-lg text-foreground",children:"Pratos do Dia"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-3 lg:gap-4",children:Mt.map((n,g)=>{const C={...n,is_popular:!0};return e.jsx(cs,{dish:C,onClick:Ge,index:g,primaryColor:R,textPrimaryColor:zt},n.id)})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-bold text-base md:text-lg mb-4 md:mb-4 text-foreground",children:r==="beverages"||r?.startsWith?.("bc_")?r?.startsWith?.("bc_")&&St?.find(n=>n.id===r.replace(/^bc_/,""))?.name||"Bebidas":r==="all"?"CardÃ¡pio Completo":r?.startsWith?.("pc_")?(()=>{const n=r.replace(/^pc_/,""),g=Ue?.find(F=>F.id===n),C=g?Se?.find(F=>F.id===g.size_id):null;return g?.name||(g&&C?`${C.name} â€¢ ${g.max_flavors||1} sabor(es)`:"Pizzas")})():it.find(n=>n.id===r)?.name||"Pratos"}),e.jsx(rr,{layout:Us,dishes:r==="beverages"||r?.startsWith?.("bc_")?Rt:Tt,onDishClick:Ge,primaryColor:R,textPrimaryColor:zt,textSecondaryColor:qs,loading:Pt,stockUtils:os,formatCurrency:he})]}),!Pt&&(r==="beverages"||r?.startsWith?.("bc_")?Rt:Tt).length===0&&e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-muted-foreground",children:"Nenhum prato encontrado"})})]}),e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border z-50 md:hidden shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-around h-16 px-2",children:[e.jsx("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"flex items-center justify-center flex-1 h-full text-muted-foreground hover:text-foreground transition-all active:scale-95",title:"InÃ­cio",children:e.jsx(Ha,{className:"w-6 h-6"})}),m?.whatsapp&&e.jsx("a",{href:`https://wa.me/55${m?.whatsapp?.replace(/\D/g,"")||""}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center flex-1 h-full text-green-500 hover:text-green-600 transition-all active:scale-95",title:"WhatsApp",children:e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})})}),e.jsx("button",{onClick:()=>{const n=document.querySelector('[data-section="promotions"]');n?n.scrollIntoView({behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},className:"flex items-center justify-center flex-1 h-full text-muted-foreground hover:text-foreground transition-all active:scale-95",title:"PromoÃ§Ãµes",children:e.jsx(we,{className:"w-6 h-6"})}),e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center justify-center flex-1 h-full relative transition-all active:scale-95",style:{color:O.length>0?R:"hsl(var(--muted-foreground))"},title:"Carrinho",children:[e.jsx(ye,{className:"w-6 h-6"}),O.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold shadow-lg",children:_e})]})]})}),e.jsx("footer",{className:"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-950 border-t border-gray-200 dark:border-gray-800 mt-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[m?.logo&&e.jsx("img",{src:m?.logo,alt:m?.name||"Restaurante",className:"w-16 h-16 rounded-xl object-cover shadow-md border-2 border-white dark:border-gray-800"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl text-gray-900 dark:text-white",children:m?.name||"Restaurante"}),m?.slogan&&e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm italic mt-0.5",children:['"',m?.slogan,'"']})]})]}),m?.address&&e.jsxs("div",{className:"flex items-start gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(Xe,{className:"w-4 h-4 mt-0.5 flex-shrink-0",style:{color:R}}),e.jsx("p",{className:"text-sm",children:m?.address})]}),m?.opening_time&&m?.closing_time&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(Re,{className:"w-4 h-4 flex-shrink-0",style:{color:R}}),e.jsx("p",{className:"text-sm font-semibold",children:"HorÃ¡rio de Funcionamento"})]}),e.jsxs("div",{className:"ml-6 space-y-1",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[m?.opening_time," - ",m?.closing_time]}),m?.working_days&&m.working_days.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Za,{className:"w-3.5 h-3.5 text-gray-500"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:(()=>{const n=["Dom","Seg","Ter","Qua","Qui","Sex","SÃ¡b"],g=m?.working_days.sort((C,F)=>C-F).map(C=>n[C]);return g.length===7?"Todos os dias":g.length===5&&g.join(",")==="Seg,Ter,Qua,Qui,Sex"?"Segunda a Sexta":g.length===6&&g.join(",")==="Seg,Ter,Qua,Qui,Sex,SÃ¡b"?"Segunda a SÃ¡bado":g.join(", ")})()})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white",children:"Conecte-se Conosco"}),e.jsxs("div",{className:"hidden sm:flex flex-wrap gap-3",children:[m?.whatsapp&&e.jsxs("a",{href:`https://wa.me/55${m?.whatsapp?.replace(/\D/g,"")||""}`,target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-2 px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-full transition-all shadow-md hover:shadow-lg transform hover:scale-105",title:"WhatsApp",children:[e.jsx($e,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"WhatsApp"})]}),m?.instagram&&e.jsxs("a",{href:m?.instagram?.startsWith("http")?m.instagram:`https://instagram.com/${m?.instagram?.replace(/^@/,"")||""}`,target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white rounded-full transition-all shadow-md hover:shadow-lg transform hover:scale-105",title:"Instagram",children:[e.jsx(Wt,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Instagram"})]}),m?.facebook&&e.jsxs("a",{href:m?.facebook?.startsWith("http")?m.facebook:`https://facebook.com/${m?.facebook||""}`,target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-2 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-full transition-all shadow-md hover:shadow-lg transform hover:scale-105",title:"Facebook",children:[e.jsx(Vt,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Facebook"})]}),m?.tiktok&&e.jsxs("a",{href:m?.tiktok?.startsWith("http")?m.tiktok:`https://tiktok.com/@${m?.tiktok?.replace(/^@/,"")||""}`,target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-2 px-4 py-2.5 bg-black hover:bg-gray-800 text-white rounded-full transition-all shadow-md hover:shadow-lg transform hover:scale-105",title:"TikTok",children:[e.jsx(Ht,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"TikTok"})]})]}),e.jsxs("div",{className:"flex sm:hidden gap-4 justify-center",children:[m?.whatsapp&&e.jsx("a",{href:`https://wa.me/55${m?.whatsapp?.replace(/\D/g,"")||""}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center w-12 h-12 bg-green-500 hover:bg-green-600 text-white rounded-full transition-all shadow-md hover:shadow-lg transform hover:scale-110",title:"WhatsApp",children:e.jsx($e,{className:"w-6 h-6"})}),m?.instagram&&e.jsx("a",{href:m?.instagram?.startsWith("http")?m.instagram:`https://instagram.com/${m?.instagram?.replace(/^@/,"")||""}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white rounded-full transition-all shadow-md hover:shadow-lg transform hover:scale-110",title:"Instagram",children:e.jsx(Wt,{className:"w-6 h-6"})}),m?.facebook&&e.jsx("a",{href:m?.facebook?.startsWith("http")?m.facebook:`https://facebook.com/${m?.facebook||""}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center w-12 h-12 bg-blue-600 hover:bg-blue-700 text-white rounded-full transition-all shadow-md hover:shadow-lg transform hover:scale-110",title:"Facebook",children:e.jsx(Vt,{className:"w-6 h-6"})}),m?.tiktok&&e.jsx("a",{href:m?.tiktok?.startsWith("http")?m.tiktok:`https://tiktok.com/@${m?.tiktok?.replace(/^@/,"")||""}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center w-12 h-12 bg-black hover:bg-gray-800 text-white rounded-full transition-all shadow-md hover:shadow-lg transform hover:scale-110",title:"TikTok",children:e.jsx(Ht,{className:"w-6 h-6"})})]}),m?.phone&&e.jsxs("a",{href:`tel:${m?.phone?.replace(/\D/g,"")||""}`,className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors mt-4",children:[e.jsx(hs,{className:"w-4 h-4",style:{color:R}}),e.jsx("span",{className:"text-sm",children:m?.phone})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-800 mt-6 pt-4 text-center space-y-2",children:[e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Â© ",new Date().getFullYear()," ",m?.name||"Restaurante",". Todos os direitos reservados."]}),e.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Powered by ",e.jsx("span",{className:"font-semibold",style:{color:R},children:Oe})]})]})]})}),e.jsx(ya,{isOpen:d,onClose:()=>p(!1),cart:O,onUpdateQuantity:ta,onRemoveItem:ea,onEditItem:aa,onEditPizza:ra,onCheckout:()=>{p(!1),k("checkout")},primaryColor:R,store:m,onReviewBonus:ws}),e.jsx(ha,{isOpen:!!i,onClose:()=>{o(null),s(null)},dish:i,complementGroups:nt,onAddToCart:Ke,editingItem:h,primaryColor:R}),x&&e.jsxs(e.Fragment,{children:[console.log("ðŸ• Renderizando PizzaBuilderV2 para:",x.name),console.log("ðŸ“ Tamanhos disponÃ­veis:",Se.length),console.log("ðŸŽ¨ Sabores disponÃ­veis:",qe.length),e.jsx(pa,{dish:x,sizes:Se,flavors:qe,edges:Ms,extras:Ts,categories:Ue,onAddToCart:Ke,onClose:()=>{console.log("âŒ Fechando PizzaBuilderV2"),l(null),s(null)},primaryColor:R,editingItem:h,store:m})]}),e.jsx(Ja,{isOpen:P,onClose:()=>v(!1),primaryColor:R,onReorder:n=>{n.items&&Array.isArray(n.items)&&n.items.forEach(g=>{const C={dish:g.dish,selections:g.selections||{},totalPrice:g.totalPrice,quantity:g.quantity||1};ce(C)})}}),e.jsx(ur,{isOpen:J,onClose:()=>re(!1),onApplyCoupon:n=>It(n),primaryColor:R,slug:t}),e.jsx(vr,{isOpen:G,onClose:()=>Q(!1),referralCode:at?.referralCode||"",onApplyReferralCode:js,primaryColor:R}),N==="menu"&&e.jsx(xr,{cart:O,dishes:ae,onAddToCart:Ke,primaryColor:R,onClose:()=>le(!1),store:m}),e.jsx(cr,{isOpen:b,onClose:()=>z(!1),primaryColor:R}),e.jsx(mr,{isOpen:T,onClose:()=>Y(!1),onSuccess:n=>{ee(!0),_(n?.email||null),w.success("Bem-vindo! Agora vocÃª pode aproveitar todos os benefÃ­cios.")},returnUrl:window.location.pathname}),e.jsx(ga,{isOpen:Zs,onClose:We,promotions:Ys,dishes:ae,onAccept:oa,onDecline:We,primaryColor:R}),N==="checkout"&&e.jsx(ja,{cart:O,customer:M,setCustomer:bs,onBack:()=>k("menu"),onSendWhatsApp:ia,couponCode:Hs,setCouponCode:Ks,appliedCoupon:mt,couponError:Gs,onApplyCoupon:It,onRemoveCoupon:sa,deliveryZones:lt,store:m,primaryColor:R,userEmail:j,slug:t}),N==="menu"&&t&&e.jsx($a,{open:S,onOpenChange:W,children:e.jsxs(Da,{side:"right",className:"w-full sm:max-w-md overflow-y-auto",children:[e.jsx(Fa,{children:e.jsxs(Aa,{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"w-5 h-5 text-red-500"}),"Meus Favoritos"]})}),e.jsx("div",{className:"mt-6",children:e.jsx(jr,{dishes:ae,onDishClick:n=>{W(!1),Ge(n)},slug:t,primaryColor:R})})]})}),N==="menu"&&e.jsxs("div",{className:"fixed bottom-24 right-4 z-40 flex flex-col items-center gap-2",children:[e.jsx(me,{children:L&&e.jsxs(e.Fragment,{children:[t&&e.jsx(E.button,{initial:{opacity:0,y:8,scale:.8},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.8},transition:{type:"spring",damping:20,stiffness:300},onClick:()=>{U(!1),W(!0)},className:"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 p-3 rounded-full shadow-xl border border-gray-200 dark:border-gray-700 flex items-center justify-center hover:shadow-2xl transition-all","aria-label":"Favoritos",children:e.jsx(vt,{className:"w-6 h-6 text-red-500"})}),e.jsx(E.button,{initial:{opacity:0,y:8,scale:.8},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.8},transition:{type:"spring",damping:20,stiffness:300,delay:.05},onClick:()=>{U(!1),ke(!0)},className:"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 p-3 rounded-full shadow-xl border border-gray-200 dark:border-gray-700 flex items-center justify-center hover:shadow-2xl transition-all","aria-label":"Chat",children:e.jsx($e,{className:"w-6 h-6"})}),e.jsxs(E.button,{initial:{opacity:0,y:8,scale:.8},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.8},transition:{type:"spring",damping:20,stiffness:300,delay:.1},onClick:()=>{U(!1),p(!0)},className:"relative bg-gradient-to-r from-orange-500 to-red-500 text-white p-3 rounded-full shadow-xl flex items-center justify-center hover:shadow-2xl transition-all","aria-label":"Carrinho",children:[e.jsx(ye,{className:"w-6 h-6"}),_e>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-600 text-white text-xs rounded-full min-w-[1.25rem] h-5 px-1 flex items-center justify-center font-bold shadow",children:_e})]})]})}),e.jsx(E.button,{onClick:()=>U(n=>!n),className:"bg-gradient-to-r from-orange-500 to-red-500 text-white p-4 rounded-full shadow-2xl flex items-center justify-center hover:shadow-orange-500/40 transition-all",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":L?"Fechar menu":"Abrir atalhos",children:e.jsx(Ka,{className:"w-6 h-6"})})]}),N==="menu"&&e.jsx(yr,{dishes:ae,categories:it,complementGroups:nt,deliveryZones:lt,store:m,onAddToCart:Ke,open:et,onOpenChange:ke,slug:t,storeName:m?.name})]})}export{ii as default};
