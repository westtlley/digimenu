import{r as h,j as e,X as W,a as ue,p as se,R as ke}from"./main-AonIQAES.js";import{B as Y}from"./badge-VNLW5sw5.js";import{A as ce}from"./index-C7_vRD1M.js";import{m as F}from"./proxy-DNI-KLs9.js";import{P as _e}from"./play-DZUzSGam.js";import{C as le}from"./check-CPlY7ZZw.js";import{u as Ce}from"./useQuery-1B__UZCp.js";import{b as ze}from"./base44Client-DnnNNlVu.js";import{f as H}from"./formatters-CvOEClq0.js";import{C as he}from"./chevron-left-CGYPxvKO.js";import{C as ae}from"./chevron-down-W9Dhjl9M.js";import{S as Se}from"./star-4jmeOV9l.js";import{P as be}from"./plus-BWjW9AHH.js";import{S as fe}from"./shopping-bag-5XiLebFV.js";import{S as $e}from"./search-Sb5SY96K.js";import{Z as Ae}from"./zap-D-FDPwOP.js";const Pe=b=>{if(!b)return null;const y=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/,r=b.match(y);if(r)return{type:"youtube",id:r[1]};const v=/(?:vimeo\.com\/)(\d+)/,E=b.match(v);return E?{type:"vimeo",id:E[1]}:null};function He({isOpen:b,onClose:y,dish:r,complementGroups:v,onAddToCart:E,editingItem:j,darkMode:B=!1,primaryColor:g="#f97316"}){const[n,f]=h.useState({}),[R,T]=h.useState(0),[o,N]=h.useState(!1),k=r?.video_url?Pe(r.video_url):null,m=(Array.isArray(v)?v:[]).filter(s=>!r?.complement_groups||!Array.isArray(r.complement_groups)?!1:r.complement_groups.some(u=>u&&u.group_id===s.id)).sort((s,u)=>(s.order||0)-(u.order||0));if(h.useEffect(()=>{b&&r&&(j&&j.selections?f(j.selections):f({}),T(r.price||0),N(!1))},[b,r,j]),h.useEffect(()=>{if(!r)return;let s=r.price||0;Object.values(n).forEach(u=>{Array.isArray(u)?u.forEach(x=>{s+=x.price||0}):u&&(s+=u.price||0)}),T(s)},[n,r]),!b||!r)return null;const U=(s,u)=>{const x=s.id,d=s.max_selection||1,V=r?.complement_groups?.find(C=>C.group_id===x)?.is_required;if(d===1){if(!V&&n[x]?.id===u.id){f(C=>{const O={...C};return delete O[x],O});return}if(V&&n[x]?.id===u.id)return;f(C=>({...C,[x]:u}))}else f(C=>{const O=C[x]||[];return O.find(G=>G.id===u.id)?V&&O.length===1?C:{...C,[x]:O.filter(G=>G.id!==u.id)}:O.length<d?{...C,[x]:[...O,u]}:C})},p=(s,u)=>{const x=s.id;return(s.max_selection||1)===1?n[x]?.id===u.id:(n[x]||[]).some(D=>D.id===u.id)},$=()=>m.every(s=>{if(!r?.complement_groups?.find(d=>d.group_id===s.id)?.is_required)return!0;const x=n[s.id];return s.max_selection===1?!!x:Array.isArray(x)&&x.length>0}),i=()=>{if(!$())return;const s={id:Date.now().toString(),dish:r,selections:n,totalPrice:R};E(s),y()},M=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s||0);return e.jsx(ce,{children:b&&e.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[e.jsx(F.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:y}),e.jsxs(F.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"relative flex flex-col md:flex-row w-full md:m-auto md:max-w-5xl md:h-[85vh] bg-white dark:bg-gray-900 backdrop-blur-xl md:rounded-3xl overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"relative w-full h-36 md:h-full md:w-2/5 flex-shrink-0",children:[o&&k?e.jsx("div",{className:"w-full h-full bg-black relative",children:k.type==="youtube"?e.jsx("iframe",{src:`https://www.youtube.com/embed/${k.id}${r.video_autoplay!==!1?"?autoplay=1":""}`,className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0},`dish-video-youtube-${k.id}`):e.jsx("iframe",{src:`https://player.vimeo.com/video/${k.id}${r.video_autoplay!==!1?"?autoplay=1":""}`,className:"w-full h-full",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0},`dish-video-vimeo-${k.id}`)}):r.image?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:r.image,alt:r.name,className:"w-full h-full object-cover"}),k&&e.jsx("button",{onClick:()=>N(!0),className:"absolute inset-0 flex items-center justify-center bg-black/40 md:bg-black/30 hover:bg-black/50 md:hover:bg-black/40 transition-colors group",children:e.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 rounded-full bg-white/90 backdrop-blur-sm flex items-center justify-center shadow-lg md:shadow-xl group-hover:scale-110 transition-transform",children:e.jsx(_e,{className:"w-8 h-8 md:w-10 md:h-10 ml-1",style:{color:g},fill:g})})})]}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-gray-800",children:e.jsx("span",{className:"text-gray-400 text-xs md:text-base",children:"Sem imagem"})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent pointer-events-none"}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 md:p-6 pointer-events-none",children:[e.jsx("h2",{className:"text-white text-lg md:text-2xl font-bold mb-0.5 md:mb-1 drop-shadow-lg",children:r.name}),r.description&&e.jsx("p",{className:"text-gray-100 text-xs md:text-sm line-clamp-1 md:line-clamp-none drop-shadow-md",children:r.description})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),o?N(!1):y()},className:"absolute top-2 right-2 md:hidden p-2.5 bg-black/60 hover:bg-black/80 rounded-full backdrop-blur-sm z-50 active:scale-95 transition-all touch-manipulation","aria-label":o?"Voltar":"Fechar",children:e.jsx(W,{className:"w-5 h-5 text-white",strokeWidth:2.5})}),o&&e.jsx("button",{onClick:()=>N(!1),className:"absolute top-4 right-4 hidden md:flex p-2 bg-black/60 hover:bg-black/80 rounded-full backdrop-blur-sm z-10 transition-colors items-center justify-center","aria-label":"Voltar",children:e.jsx(W,{className:"w-5 h-5 text-white"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx("button",{onClick:y,className:"hidden md:block absolute top-4 right-4 p-2 rounded-full z-10 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:e.jsx(W,{className:"w-5 h-5 text-gray-900 dark:text-white"})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3 md:p-5 pt-3 md:pt-12",children:m.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Este prato nÃ£o possui complementos"})}):e.jsx("div",{className:"space-y-4",children:m.map(s=>{const u=(s.options||[]).filter(d=>d.is_active!==!1);if(u.length===0)return null;const x=r?.complement_groups?.find(d=>d.group_id===s.id);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"font-semibold text-sm md:text-base text-gray-900 dark:text-gray-100",children:[s.name,x?.is_required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx(Y,{variant:"outline",className:`text-xs ${x?.is_required?"border-red-300 text-red-600 dark:border-red-500 dark:text-red-400":"border-gray-300 text-gray-600 dark:border-gray-600 dark:text-gray-400"}`,children:x?.is_required?"ObrigatÃ³rio":"Opcional"}),e.jsx(Y,{variant:"outline",className:"text-xs border-blue-300 text-blue-600 dark:border-blue-500 dark:text-blue-400",children:s.max_selection||1})]})]}),e.jsx("div",{className:"space-y-1.5",children:u.map(d=>e.jsxs(F.button,{whileHover:{scale:1.01},whileTap:{scale:.98},onClick:()=>U(s,d),className:ue("w-full p-2.5 md:p-3 rounded-lg border-2 flex items-center gap-3 transition-all",p(s,d)?"bg-orange-50 dark:bg-orange-900/20 border-opacity-80":"border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800"),style:p(s,d)?{borderColor:g}:{},children:[d.image?e.jsxs("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-lg overflow-hidden flex-shrink-0 border-2",style:{borderColor:p(s,d)?g:"transparent"},children:[e.jsx("img",{src:d.image,alt:d.name,className:"w-full h-full object-cover",onError:D=>{D.target.style.display="none",D.target.nextSibling.style.display="flex"}}),e.jsx("div",{className:"w-full h-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-400 text-xs",style:{display:"none"},children:"ðŸ½ï¸"})]}):e.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-lg bg-gray-100 dark:bg-gray-700 flex items-center justify-center flex-shrink-0 border-2",style:{borderColor:p(s,d)?g:"transparent"},children:e.jsx("span",{className:"text-gray-400 text-lg",children:"ðŸ½ï¸"})}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("div",{className:ue("w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all flex-shrink-0",p(s,d)?"border-transparent":"border-gray-300 dark:border-gray-600"),style:p(s,d)?{backgroundColor:g}:{},children:p(s,d)&&e.jsx(le,{className:"w-3 h-3 text-white"})}),e.jsx("span",{className:"font-medium text-sm truncate text-gray-900 dark:text-gray-100",children:d.name})]}),d.price>0&&e.jsxs("span",{className:"font-semibold text-sm flex-shrink-0 text-gray-700 dark:text-gray-300",children:["+ ",M(d.price)]})]},d.id))})]},s.id)})})}),e.jsxs(F.div,{initial:{y:20},animate:{y:0},className:"border-t p-3 flex-shrink-0 bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-sm text-gray-700 dark:text-gray-300",children:"Total"}),e.jsx("span",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-white",style:{color:g},children:M(R)})]}),e.jsxs(F.button,{whileHover:{scale:1.01},whileTap:{scale:.98},onClick:i,disabled:!$(),className:"w-full h-11 rounded-xl text-white font-semibold text-sm disabled:opacity-50 disabled:cursor-not-allowed shadow-lg transition-all active:scale-95",style:{background:$()?`linear-gradient(135deg, ${g}, #ef4444)`:"#9ca3af"},children:[e.jsx(le,{className:"w-4 h-4 inline mr-1.5"}),j?"Salvar":"Adicionar"]})]})]})]})]})})}const Ee="/images/pizza-borda.png";function Ye({dish:b,sizes:y=[],flavors:r=[],edges:v=[],extras:E=[],categories:j=[],onAddToCart:B,onClose:g,primaryColor:n="#f97316",editingItem:f=null,store:R=null}){const{data:T=[]}=Ce({queryKey:["pizzaVisualizationConfig"],queryFn:()=>ze.entities.PizzaVisualizationConfig.list()}),o=T[0]||{},N=o.edgeImageUrl||Ee;o.edgeStrokeWidth,o.edgeRadius,o.edgeOffsetX,o.edgeOffsetY,o.edgeScale;const[k,S]=h.useState("custom"),[m,U]=h.useState(null),[p,$]=h.useState(null),[i,M]=h.useState([]),[s,u]=h.useState(null),[x,d]=h.useState([]),[D,V]=h.useState(""),[C,O]=h.useState(""),[Z,G]=h.useState(!1),Q=j?.length>0,q=b?.pizza_category_id&&Q?j.find(t=>t.id===b.pizza_category_id):null,ge=!!q;se.useEffect(()=>{if(f){const t=f.size||null;if(U(t),Q&&t){const l=(f.flavors||[]).length,a=j.find(c=>c.size_id===t.id&&(c.max_flavors||1)>=l)||j.find(c=>c.size_id===t.id);$(a||null)}M(f.flavors||[]),u(f.edge||null),d(f.extras||[]),V(f.specifications||"")}else if(b&&r.length>0&&i.length===0&&m){const t=b.name.toLowerCase(),l=r.find(a=>{if(!a||!a.name)return!1;const c=a.name.toLowerCase(),_=t.replace(/pizza\s*/gi,"").trim();return c.includes(_)||_.includes(c)});l&&M([l])}},[f,y,b,r,m,i.length,Q,j]),se.useEffect(()=>{if(q&&!f){$(q);const t=y.find(l=>l.id===q.size_id);U(t||null),M([])}},[q?.id,y,f]),se.useEffect(()=>{G(!1)},[m?.id,p?.id]);const oe=h.useMemo(()=>(r||[]).filter(t=>t&&t.is_active&&t.name?.toLowerCase().includes(C.toLowerCase())),[r,C]),pe=h.useMemo(()=>{const t={};return oe.forEach(l=>{const a=l.category||"Tradicional";t[a]||(t[a]=[]),t[a].push(l)}),t},[oe]),ye=p?.max_flavors??m?.max_flavors??1,z=Math.min(Math.max(ye,1),4),de=m?.max_extras??5,je=t=>{if(m)if(b?.division_mode==="exact"){const l=[...new Set(i.map(c=>c.id))];l.includes(t.id)?M(i.filter(c=>c.id!==t.id)):l.length<z&&M([...i,t])}else{const l=m.slices;i.length<l&&M([...i,t])}},xe=()=>{if(!m)return 0;let l=i.some(c=>c.category==="premium")?m.price_premium:m.price_tradicional;s&&s.price&&(l+=s.price);const a=x.reduce((c,_)=>c+(_.price||0),0);return l+a},me=()=>{const t={dish:b,size:m,category:p||q,flavors:i,edge:s,extras:x,specifications:D,totalPrice:xe()};B(t,f!==null)},X=R?.enable_premium_pizza_visualization!==!1,re=(E||[]).filter(t=>t&&t.is_active).length>0,K=m&&i.length>0&&(!re||Z),we=()=>e.jsxs("div",{className:"h-screen w-full flex flex-col overflow-hidden",style:{backgroundColor:X?"rgba(0,0,0,0.85)":"#0f0f0f"},children:[e.jsxs("header",{className:"flex-shrink-0 py-4 px-6 flex items-center justify-between shadow-md",style:{backgroundColor:n},children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:g,className:"text-white",children:e.jsx(he,{size:24})}),e.jsx("h1",{className:"text-white font-black text-xl uppercase tracking-tighter",children:"Minha Pizza"})]}),e.jsx("button",{onClick:g,className:"text-white",children:e.jsx(W,{size:24})})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto overflow-x-hidden overscroll-contain",style:{WebkitOverflowScrolling:"touch"},children:e.jsx("div",{className:"w-full max-w-full mx-auto px-4 py-6 pb-44 lg:pb-8 box-border",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-6 max-w-5xl mx-auto w-full",children:[e.jsx("div",{className:`space-y-2 lg:space-y-3 rounded-2xl p-4 ${X?"bg-black/40 backdrop-blur-xl border border-white/5":""}`,children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-1 relative min-w-0",children:[e.jsxs("button",{onClick:()=>m&&(z>1||i.length===0)&&S("flavors"),disabled:!m||z===1&&i.length>=1,className:"relative w-[280px] h-[280px] sm:w-[340px] sm:h-[340px] lg:w-[420px] lg:h-[420px] pizza-container group cursor-pointer flex-shrink-0 disabled:opacity-70 disabled:cursor-not-allowed rounded-full overflow-hidden shadow-xl",children:[X&&s&&s.id!=="none"&&e.jsx(F.div,{className:"absolute inset-0 rounded-full pointer-events-none",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},style:{boxShadow:"inset 0 0 40px rgba(251,191,36,0.08)"}}),e.jsx(F.div,{className:"absolute inset-0 rounded-full overflow-hidden",initial:X?{opacity:.7,scale:.98}:{},animate:X?{opacity:1,scale:1}:{},transition:{duration:.3},children:e.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full",children:[e.jsxs("defs",{children:[Array.from({length:z}).map((t,l)=>i[l]?.image&&e.jsx("pattern",{id:`pizza-slice-${l}`,patternUnits:"userSpaceOnUse",x:"0",y:"0",width:"100",height:"100",children:e.jsx("image",{href:i[l].image,x:"0",y:"0",width:"100",height:"100",preserveAspectRatio:"xMidYMid slice"})},l)),s&&s.id!=="none"&&e.jsx("pattern",{id:`pizza-edge-ring-${s?.id||"default"}`,patternUnits:"userSpaceOnUse",x:"0",y:"0",width:"100",height:"100",children:e.jsx("image",{href:s?.image||N,x:"0",y:"0",width:"100",height:"100",preserveAspectRatio:"xMidYMid slice"})})]}),e.jsx("circle",{cx:"50",cy:"50",r:"50",fill:"#3d2817"}),s&&s.id!=="none"&&e.jsx("path",{d:"M 50,50 m -50,0 a 50,50 0 1,1 100,0 a 50,50 0 1,1 -100,0 M 50,50 m -42,0 a 42,42 0 1,1 84,0 a 42,42 0 1,1 -84,0",fill:`url(#pizza-edge-ring-${s?.id||"default"})`,fillRule:"evenodd",style:{filter:"drop-shadow(0 2px 6px rgba(0,0,0,0.4))"}}),(()=>{const t=s&&s.id!=="none"?42:50;return z===1?i[0]?e.jsx("circle",{cx:"50",cy:"50",r:t,fill:i[0].image?"url(#pizza-slice-0)":i[0].color||"#444"}):e.jsxs("g",{children:[e.jsx("circle",{cx:"50",cy:"50",r:"50",fill:"#333"}),e.jsx("text",{x:"50",y:"45",textAnchor:"middle",fill:"rgba(255,255,255,0.3)",fontSize:"8",children:"+"}),e.jsx("text",{x:"50",y:"55",textAnchor:"middle",fill:"rgba(255,255,255,0.2)",fontSize:"4",children:"TOQUE"})]}):Array.from({length:z}).map((l,a)=>{const c=360/z,_=(c*a-90)*(Math.PI/180),w=(c*(a+1)-90)*(Math.PI/180),P=t,ne=50+P*Math.cos(_),J=50+P*Math.sin(_),ee=50+P*Math.cos(w),A=50+P*Math.sin(w),L=c>180?1:0,te=`M 50 50 L ${ne} ${J} A ${P} ${P} 0 ${L} 1 ${ee} ${A} Z`,I=i[a];return e.jsx("path",{d:te,fill:I?.image?`url(#pizza-slice-${a})`:I?.color||"#444",stroke:"rgba(0,0,0,0.1)",strokeWidth:"0.5"},a)})})(),z>1&&i.filter(Boolean).length<z&&e.jsx("g",{children:Array.from({length:z}).map((t,l)=>{if(i[l])return null;const c=(360/z*(l+.5)-90)*(Math.PI/180),_=s&&s.id!=="none"?42:50,w=50+_/2*Math.cos(c),P=50+_/2*Math.sin(c);return e.jsxs("g",{children:[e.jsx("text",{x:w,y:P-3,textAnchor:"middle",fill:"rgba(255,255,255,0.3)",fontSize:"6",children:"+"}),e.jsx("text",{x:w,y:P+4,textAnchor:"middle",fill:"rgba(255,255,255,0.2)",fontSize:"3",children:"TOQUE"})]},`placeholder-${l}`)})})]})})]}),e.jsxs("div",{className:"mt-2 text-center bg-black/40 px-5 py-2 rounded-full border border-white/5 inline-flex items-baseline",children:[e.jsx("span",{className:"text-xs text-gray-500 font-black uppercase tracking-tighter",children:"PreÃ§o:"}),e.jsx("span",{className:"ml-2 text-2xl md:text-3xl font-black text-white italic",children:H(xe())})]})]})}),e.jsxs("div",{className:"space-y-3",children:[ge?e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/5",children:[e.jsx("p",{className:"text-gray-400 text-xs uppercase tracking-widest font-black mb-1",children:"Categoria"}),e.jsx("p",{className:"text-white font-bold text-base md:text-lg",children:(p||q)?.name||(()=>{const t=p||q,l=t?y.find(a=>a.id===t.size_id):null;return t&&l?`${l.name} â€¢ ${t.max_flavors||1} sabor(es)`:""})()})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-white text-xs font-black uppercase tracking-widest opacity-80",children:Q?"Categoria:":"Tamanho:"}),e.jsxs("div",{className:"relative",children:[Q?e.jsxs("select",{className:"w-full text-white py-3 px-4 rounded-xl font-bold appearance-none text-sm shadow-lg border-b-4 focus:outline-none",style:{backgroundColor:n,borderColor:"#c2410c"},value:p?.id||"",onChange:t=>{const l=j.find(c=>c.id===t.target.value);$(l||null);const a=l?y.find(c=>c.id===l.size_id):null;U(a),M([])},children:[e.jsx("option",{value:"",children:"Escolha a categoria"}),(j||[]).map(t=>{const l=y.find(a=>a.id===t.size_id);return e.jsx("option",{value:t.id,children:t.name||(l?`${l.name} ${t.max_flavors||1} sabor(es)`:"")},t.id)})]}):e.jsxs("select",{className:"w-full text-white py-3 px-4 rounded-xl font-bold appearance-none text-sm shadow-lg border-b-4 focus:outline-none",style:{backgroundColor:n,borderColor:"#c2410c"},value:m?.id||"",onChange:t=>{const l=y.find(a=>a.id===t.target.value);U(l),$(null),M([])},children:[e.jsx("option",{value:"",children:"Escolha o tamanho"}),(y||[]).filter(t=>t&&t.is_active).map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.slices," fatias - ",t.max_flavors," ",t.max_flavors===1?"sabor":"sabores"]},t.id))]}),e.jsx(ae,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-white pointer-events-none",size:18})]})]}),e.jsx("div",{className:`bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/5 ${m?"":"opacity-60"}`,children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-400 text-xs uppercase tracking-widest font-black mb-1",children:"ðŸ• Sabores"}),e.jsx("p",{className:"text-white text-sm font-bold leading-tight truncate",children:i.length>0?e.jsx("span",{children:i.map(t=>t.name).join(" + ")}):e.jsx("span",{className:"text-gray-500",children:m?"Toque na pizza":"Escolha o tamanho"})})]}),e.jsx("button",{onClick:()=>m&&z>1&&S("flavors"),disabled:!m||z===1&&i.length>=1,className:"px-3 py-1.5 rounded-lg text-xs font-black uppercase transition-all active:scale-95 whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:n,color:"white"},children:z===1&&i.length>=1?"Ok":i.length>0?"Alterar":"Escolher"})]})}),e.jsx("h3",{className:`text-white text-xs font-black uppercase tracking-widest px-2 pt-2 ${i.length<1?"opacity-50":"opacity-80"}`,children:"Personalize sua pizza:"}),e.jsxs("button",{onClick:()=>i.length>=1&&S("borders"),disabled:i.length<1,className:`w-full backdrop-blur-sm text-white py-3 px-4 rounded-xl font-bold text-sm flex items-center justify-between shadow-md transition-all border border-white/5 ${i.length>=1?"bg-white/10 hover:bg-white/20 active:scale-95":"bg-white/5 opacity-50 cursor-not-allowed"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:`${n}30`},children:e.jsx(Se,{size:16,style:{color:n},className:"fill-current"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[9px] text-gray-400 uppercase tracking-wider font-black",children:"Borda"}),e.jsx("p",{className:"text-white font-black text-xs",children:s&&s.id!=="none"?s.name:"Sem borda"})]})]}),e.jsx(ae,{className:"text-gray-400",size:18})]}),e.jsxs("button",{onClick:()=>(v.length===0||s!==null)&&S("extras"),disabled:v.length>0&&s===null,className:`w-full backdrop-blur-sm text-white py-3 px-4 rounded-xl font-bold text-sm flex items-center justify-between shadow-md transition-all border border-white/5 ${v.length===0||s!==null?"bg-white/10 hover:bg-white/20 active:scale-95":"bg-white/5 opacity-50 cursor-not-allowed"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center bg-blue-500/20",children:e.jsx(be,{size:16,className:"text-blue-400"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[9px] text-gray-400 uppercase tracking-wider font-black",children:"Extras"}),e.jsx("p",{className:"text-white font-black text-xs",children:x.length>0?`${x.length} selecionados`:"Nenhum extra"})]})]}),e.jsx(ae,{className:"text-gray-400",size:18})]}),e.jsxs("button",{onClick:()=>(v.length===0||s!==null)&&S("observations"),disabled:v.length>0&&s===null,className:`w-full backdrop-blur-sm text-white py-3 px-4 rounded-xl font-bold text-sm flex items-center justify-between shadow-md active:scale-95 transition-all border border-white/5 ${v.length===0||s!==null?"bg-white/10 hover:bg-white/20":"bg-white/5 opacity-50 cursor-not-allowed"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center bg-gray-500/20",children:e.jsx("span",{className:"text-lg",children:"ðŸ“"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[9px] text-gray-400 uppercase tracking-wider font-black",children:"ObservaÃ§Ãµes"}),e.jsx("p",{className:"text-white font-black text-xs",children:D?"Adicionadas":"Adicionar observaÃ§Ãµes"})]})]}),e.jsx(ae,{className:"text-gray-400",size:18})]}),e.jsxs("div",{className:"hidden lg:block pt-4",children:[e.jsxs("button",{onClick:me,disabled:!K,className:"w-full text-white py-4 rounded-xl font-black text-base shadow-[0_10px_40px_rgba(0,0,0,0.5)] flex items-center justify-center gap-3 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:K?"#4caf50":"#9ca3af"},children:[e.jsx(fe,{size:20})," ADICIONAR AO PEDIDO"]}),re&&!Z&&i.length>0&&e.jsx("p",{className:"text-xs text-amber-400/90 mt-2 text-center",children:"Confirme os extras para adicionar ao pedido"})]})]})]})})}),e.jsxs("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black via-black/95 to-transparent z-50 pointer-events-none",children:[e.jsxs("button",{onClick:me,disabled:!K,className:"w-full max-w-md mx-auto text-white py-4 rounded-xl font-black text-base shadow-[0_10px_40px_rgba(0,0,0,0.5)] flex items-center justify-center gap-3 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed pointer-events-auto",style:{backgroundColor:K?"#4caf50":"#9ca3af"},children:[e.jsx(fe,{size:20})," ADICIONAR AO PEDIDO"]}),re&&!Z&&i.length>0&&e.jsx("p",{className:"text-xs text-amber-400/90 mt-2 text-center pointer-events-auto",children:"Confirme os extras para adicionar"})]})]}),ve=()=>e.jsxs("div",{className:"min-h-screen w-full flex flex-col bg-white",children:[e.jsxs("header",{className:"py-3 px-4 sticky top-0 z-50 shadow-md",style:{backgroundColor:n},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("button",{onClick:()=>S("custom"),className:"text-white",children:e.jsx(he,{size:24,strokeWidth:3})}),e.jsx("h1",{className:"text-white font-black text-lg uppercase tracking-tight",children:"Selecione os Sabores"}),e.jsx("div",{className:"w-6"})]}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Pesquisar sabor...",className:"w-full bg-white rounded-xl py-3 pl-10 pr-3 text-gray-900 font-medium text-sm focus:outline-none shadow-inner border border-gray-100",value:C,onChange:t=>O(t.target.value),autoFocus:!0})]})]}),e.jsx("main",{className:"flex-1 p-3 space-y-6 bg-gray-50 overflow-y-auto pb-40",children:Object.entries(pe).map(([t,l])=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-black italic text-lg border-l-4 pl-3 uppercase tracking-tight",style:{color:n,borderColor:n},children:t}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:l.map(a=>{const c=i.find(_=>_.id===a.id);return e.jsxs(F.div,{whileTap:{scale:.98},onClick:()=>je(a),className:`flex gap-3 bg-white p-3 rounded-xl shadow-sm border-2 transition-all relative overflow-hidden ${c?"ring-2 ring-opacity-30":"border-transparent"}`,style:{borderColor:c?n:"transparent",ringColor:c?`${n}40`:"transparent"},children:[a.image&&e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden flex-shrink-0 border-2 border-gray-100 shadow",children:e.jsx("img",{src:a.image,className:"w-full h-full object-cover",alt:a.name})}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsx("h4",{className:"text-gray-900 font-bold text-sm uppercase tracking-tight",children:a.name}),e.jsx("span",{className:"font-bold text-sm whitespace-nowrap",style:{color:n},children:H(a.price||0)})]}),a.description&&e.jsx("p",{className:"text-[10px] text-gray-500 leading-tight mt-1 line-clamp-2",children:a.description}),a.category==="premium"&&e.jsx("div",{className:"mt-1.5",children:e.jsx(Y,{className:"bg-amber-100 text-amber-700 text-[8px] font-bold px-2 py-0.5 rounded-full uppercase border border-amber-200",children:"Premium"})})]}),c&&e.jsx("div",{className:"absolute top-2 right-2 text-white p-1 rounded-full shadow-md",style:{backgroundColor:n},children:e.jsx(le,{size:12,strokeWidth:4})})]},a.id)})})]},t))}),e.jsxs("footer",{className:"fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-xl border-t border-gray-200 p-4 flex justify-between items-center shadow-[0_-10px_40px_rgba(0,0,0,0.05)] z-50",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] text-gray-400 font-black uppercase tracking-widest",children:"Progresso"}),e.jsxs("span",{className:"text-sm font-black text-gray-900 uppercase",children:[i.length," de ",z," sabores"]})]}),e.jsx("button",{onClick:()=>S("custom"),className:`px-8 py-3 rounded-xl font-black text-xs uppercase tracking-wide transition-all ${i.length>0?"text-white shadow-lg":"bg-gray-100 text-gray-400"}`,style:{backgroundColor:i.length>0?n:"#f3f4f6"},children:"Confirmar"})]})]}),ie=({title:t,items:l,current:a,onSelect:c,onClose:_,type:w="single",maxItems:P=999,onConfirm:ne})=>{const[J,ee]=h.useState(w==="textarea"&&a||"");return se.useEffect(()=>{w==="textarea"&&ee(a||"")},[w,a]),e.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/90 flex flex-col animate-fade-in backdrop-blur-md",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-white/10",children:[e.jsx("h2",{className:"text-white font-black text-lg uppercase tracking-tight",children:t}),e.jsx("button",{onClick:_,className:"text-white p-2 rounded-full hover:bg-white/10 transition-colors",children:e.jsx(W,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"max-w-2xl mx-auto space-y-2",children:w==="textarea"?e.jsx("textarea",{dir:"ltr",value:J,onChange:A=>ee(A.target.value),placeholder:"Ex: Sem cebola, bem assada, massa fina...",className:"flex min-h-[100px] w-full rounded-md border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-gray-400 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-white/30",autoFocus:!0,style:{direction:"ltr"}}):l.map(A=>{const L=w==="multiple"?a.find(I=>I.id===A.id):a?.id===A.id,te=w==="multiple"&&!L&&a.length>=P;return e.jsxs("button",{disabled:te,onClick:()=>{if(w==="multiple"){const I=L?a.filter(Ne=>Ne.id!==A.id):a.length<P?[...a,A]:a;c(I)}else c(A),w==="single"&&_()},className:`w-full p-4 rounded-xl border-2 flex justify-between items-center transition-all ${L?"text-white":te?"border-white/5 bg-white/5 text-gray-600 opacity-50 cursor-not-allowed":"border-white/10 bg-white/5 text-gray-400"}`,style:{borderColor:L?n:"rgba(255,255,255,0.1)",backgroundColor:L?`${n}20`:"rgba(255,255,255,0.05)"},children:[e.jsx("span",{className:"font-bold text-sm uppercase tracking-wide",children:A.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[A.price>0&&e.jsxs("span",{className:"text-xs font-bold text-gray-300",children:["+ ",H(A.price)]}),L&&e.jsx(le,{style:{color:n},size:18})]})]},A.id)})})}),(w==="textarea"||w==="multiple")&&e.jsx("div",{className:"p-4 border-t border-white/10 bg-black/50",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx("button",{onClick:()=>{w==="textarea"&&c(J),ne?.(),_()},className:"w-full text-white py-3 rounded-xl font-bold text-sm shadow-lg transition-transform active:scale-95",style:{backgroundColor:n},children:w==="multiple"?`Confirmar (${a.length} selecionado${a.length!==1?"s":""})`:"Confirmar"})})})]})};return e.jsx("div",{className:"fixed inset-0 z-[9999] antialiased",children:e.jsxs(ce,{mode:"wait",children:[k==="custom"&&e.jsx(we,{}),k==="flavors"&&e.jsx(ve,{}),k==="borders"&&e.jsx(ie,{title:"Escolha a Borda",items:[{id:"none",name:"Sem Borda",price:0},...v.filter(t=>t&&t.is_active)],current:s||{id:"none",name:"Sem Borda",price:0},onSelect:u,onClose:()=>S("custom"),type:"single"}),k==="extras"&&e.jsx(ie,{title:`Adicionar Extras (mÃ¡x. ${de})`,items:E.filter(t=>t&&t.is_active),current:x,onSelect:d,onClose:()=>S("custom"),onConfirm:()=>G(!0),type:"multiple",maxItems:de}),k==="observations"&&e.jsx(ie,{title:"ObservaÃ§Ãµes",items:[],current:D,onSelect:V,onClose:()=>S("custom"),type:"textarea"})]})})}function Ze({isOpen:b,onClose:y,promotions:r=[],dishes:v=[],onAccept:E,onDecline:j,primaryColor:B,darkMode:g}){const[n,f]=h.useState(0),[R,T]=h.useState(0),o=r[n],N=v.find(p=>p.id===o?.offer_dish_id);if(!o||!N)return null;const k=o.original_price>o.offer_price?Math.round((o.original_price-o.offer_price)/o.original_price*100):0,S=(p,$)=>{$.offset.x<-100?m():$.offset.x>100&&U(),T(0)},m=()=>{n<r.length-1?f(n+1):(j(),f(0))},U=()=>{E(o),f(0)};return e.jsx(ce,{children:b&&e.jsx(F.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:y,children:e.jsxs(F.div,{drag:"x",dragConstraints:{left:0,right:0},dragElastic:.7,onDrag:(p,$)=>T($.offset.x),onDragEnd:S,initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1,x:0},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:25,stiffness:300},onClick:p=>p.stopPropagation(),className:`relative w-full max-w-md rounded-3xl overflow-hidden shadow-2xl ${g?"bg-gray-800":"bg-white"}`,style:{rotate:R*.05},children:[Math.abs(R)>20&&e.jsx("div",{className:`absolute top-1/2 -translate-y-1/2 text-6xl ${R<0?"right-8":"left-8"}`,children:R<0?"ðŸ‘Ž":"ðŸ‘"}),e.jsxs("div",{className:"relative",children:[N.image?e.jsx("img",{src:N.image,alt:N.name,className:"w-full h-56 object-cover"}):e.jsx("div",{className:"w-full h-56 bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center",children:e.jsx(Ae,{className:"w-16 h-16 text-white"})}),e.jsx("button",{onClick:y,className:"absolute top-3 right-3 w-9 h-9 bg-black/60 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-black/80 transition-colors",children:e.jsx(W,{className:"w-5 h-5"})}),k>0&&e.jsxs(Y,{className:"absolute top-3 left-3 bg-red-500 text-white text-lg px-4 py-1.5 font-bold shadow-lg",children:["ðŸ”¥ OFERTA -",k,"%"]}),e.jsx(Y,{className:"absolute bottom-3 left-3 text-white font-semibold px-3 py-1",style:{backgroundColor:o.type==="add"?"#3b82f6":"#8b5cf6"},children:o.type==="add"?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-3 h-3 mr-1"})," Adicionar ao Pedido"]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"w-3 h-3 mr-1"})," Trocar Pedido"]})}),r.length>1&&e.jsxs("div",{className:"absolute bottom-3 right-3 bg-black/60 backdrop-blur-sm px-2 py-1 rounded-full text-white text-xs",children:[n+1,"/",r.length]})]}),e.jsxs("div",{className:"p-5",children:[e.jsx("h3",{className:`text-2xl font-bold mb-1 ${g?"text-white":"text-gray-900"}`,children:o.name}),e.jsx("p",{className:`text-sm mb-3 ${g?"text-gray-300":"text-gray-600"}`,children:N.name}),o.description&&e.jsx("p",{className:`text-sm mb-4 ${g?"text-gray-400":"text-gray-500"}`,children:o.description}),e.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[o.original_price>o.offer_price&&e.jsx("span",{className:`text-xl line-through ${g?"text-gray-500":"text-gray-400"}`,children:H(o.original_price)}),e.jsx("span",{className:"text-3xl font-bold",style:{color:B},children:H(o.offer_price)})]}),e.jsxs("p",{className:"text-xs text-gray-400 text-center mb-4",children:["ðŸ‘ˆ Arraste para ",r.length>1&&n<r.length-1?"prÃ³xima":"recusar"," Â· Arraste para aceitar ðŸ‘‰"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:m,className:`flex-1 py-3 rounded-xl border-2 font-semibold transition-colors ${g?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"NÃ£o, obrigado"}),e.jsx("button",{onClick:U,className:"flex-1 py-3 rounded-xl text-white font-semibold shadow-lg transition-transform hover:scale-105",style:{backgroundColor:B},children:o.type==="add"?"Adicionar":"Aceitar"})]})]})]},n)})})}function Ke(b,y){const[r,v]=h.useState(!1),[E,j]=h.useState([]),[B,g]=h.useState(!1),n=h.useCallback(T=>{if(B)return;const o=b.filter(N=>N.is_active&&(!N.trigger_min_value||T>=N.trigger_min_value));o.length>0&&(j(o),v(!0),g(!0))},[b,B]),f=h.useCallback(()=>{g(!1)},[]),R=h.useCallback(()=>{v(!1),j([])},[]);return{showUpsellModal:r,upsellPromotions:E,checkUpsell:n,resetUpsell:f,closeUpsell:R}}export{He as N,Ye as P,Ze as U,Ke as u};
