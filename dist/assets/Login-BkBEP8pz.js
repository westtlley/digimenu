import{r as l,i as A,k,j as e,g as S,B as E,L as P,e as i,S as _,d as u,z as v}from"./main-5wCJ0shd.js";import{L as j,I as b}from"./label-BGurCIwA.js";import{U as L}from"./user-SYMNLJbz.js";import{S as U}from"./store-DBfh0a_B.js";import{S as z}from"./settings-CVkD5Rnm.js";import{E as q,a as D}from"./eye-CkTGamEz.js";import{L as F}from"./log-in-DU8-DLrh.js";import"./index-BjH-urEE.js";function Y(){const[d,y]=l.useState(""),[m,f]=l.useState(""),[x,N]=l.useState(!1),[n,h]=l.useState(!1),[g,c]=l.useState(""),p=A(),[w]=k(),r=w.get("returnUrl")||"/";l.useEffect(()=>{(async()=>{try{if(!await u.auth.isAuthenticated())return;const s=await u.auth.me();if(!s)return;let a=r;(!r||r==="/"||r==="/login")&&(s?.role==="customer"?a="/Cardapio":s?.profile_role||s?.profile_roles?.length?a="/colaborador":a=s?.is_master?"/Admin":"/PainelAssinante"),p(a,{replace:!0})}catch{}})()},[p,r]);const C=async o=>{if(o.preventDefault(),c(""),h(!0),!d||!m){c("Preencha email e senha"),h(!1);return}try{const t=await u.auth.login(d,m),s=t.user||t;if(t.token){v.success("Login realizado com sucesso!");let a=r;s?.role==="customer"?a="/Cardapio":s?.profile_role||s?.profile_roles?.length?a="/colaborador":!s?.is_master&&(r.includes("/Admin")||r==="/Admin")?a="/PainelAssinante":s?.is_master&&(r.includes("PainelAssinante")||r.includes("/PainelAssinante"))?a="/Admin":(!r||r==="/"||r==="/login")&&(s?.role==="customer"?a="/Cardapio":s?.profile_role||s?.profile_roles?.length?a="/colaborador":a=s?.is_master?"/Admin":"/PainelAssinante"),setTimeout(()=>p(a),400)}else c("Erro ao fazer login. Tente novamente.")}catch(t){const s=t?.message||"Credenciais inválidas. Tente novamente.";c(s),v.error(s)}finally{h(!1)}};return e.jsx("div",{className:"min-h-screen min-h-screen-mobile flex items-center justify-center p-4 bg-gradient-to-b from-slate-50 to-gray-100 dark:from-gray-900 dark:to-gray-950",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"rounded-2xl shadow-xl p-6 sm:p-8",style:{backgroundColor:"var(--bg-card)",border:"1px solid var(--border-color)"},children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-14 h-14 bg-orange-500 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx(S,{className:"w-7 h-7 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold",style:{color:"var(--text-primary)"},children:"Entrar"}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-secondary)"},children:"Use o mesmo formulário; você será levado ao painel do seu perfil."})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-xl border text-center",style:{borderColor:"var(--border-color)",backgroundColor:"var(--bg-secondary)"},children:[e.jsx(L,{className:"w-5 h-5 mx-auto mb-1 text-blue-600"}),e.jsx("p",{className:"text-[11px] font-semibold",style:{color:"var(--text-primary)"},children:"Cliente"}),e.jsx("p",{className:"text-[10px]",style:{color:"var(--text-secondary)"},children:"Cardápio, dados e histórico"})]}),e.jsxs("div",{className:"p-3 rounded-xl border text-center",style:{borderColor:"var(--border-color)",backgroundColor:"var(--bg-secondary)"},children:[e.jsx(U,{className:"w-5 h-5 mx-auto mb-1 text-green-600"}),e.jsx("p",{className:"text-[11px] font-semibold",style:{color:"var(--text-primary)"},children:"Assinante"}),e.jsx("p",{className:"text-[10px]",style:{color:"var(--text-secondary)"},children:"Painel do restaurante"})]}),e.jsxs("div",{className:"p-3 rounded-xl border text-center",style:{borderColor:"var(--border-color)",backgroundColor:"var(--bg-secondary)"},children:[e.jsx(z,{className:"w-5 h-5 mx-auto mb-1 text-amber-600"}),e.jsx("p",{className:"text-[11px] font-semibold",style:{color:"var(--text-primary)"},children:"Admin"}),e.jsx("p",{className:"text-[10px]",style:{color:"var(--text-secondary)"},children:"Acesso master"})]})]}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"email",style:{color:"var(--text-primary)"},children:"Email"}),e.jsx(b,{id:"email",type:"email",placeholder:"seu@email.com",value:d,onChange:o=>y(o.target.value),disabled:n,className:"mt-1",required:!0,autoComplete:"email"})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"password",style:{color:"var(--text-primary)"},children:"Senha"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(b,{id:"password",type:x?"text":"password",placeholder:"Sua senha",value:m,onChange:o=>f(o.target.value),disabled:n,className:"pr-10",required:!0,autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>N(!x),className:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",disabled:n,children:x?e.jsx(q,{className:"w-5 h-5"}):e.jsx(D,{className:"w-5 h-5"})})]})]}),g&&e.jsx("div",{className:"p-2.5 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:g})}),e.jsx(E,{type:"submit",className:"w-full min-h-[48px] bg-orange-500 hover:bg-orange-600 text-white",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2 animate-spin"})," Entrando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 mr-2"})," Entrar"]})})]}),e.jsxs("div",{className:"mt-6 pt-5 border-t space-y-2",style:{borderColor:"var(--border-color)"},children:[e.jsxs("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Cliente:"})," ",e.jsx(i,{to:"/cadastro-cliente",className:"text-orange-500 hover:text-orange-600 font-medium",children:"Cadastre-se"})," — ","Cardápio, pedidos e histórico."]}),e.jsxs("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Restaurante:"})," ",e.jsxs(i,{to:"/assinar",className:"text-orange-500 hover:text-orange-600 font-medium",children:["Assinar ",_]})," — ","Painel, PDV e gestão."]}),e.jsxs("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Admin / Master:"})," acesso por convite."," ",e.jsx("a",{href:"https://wa.me/5586988196114",target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 hover:text-orange-600 font-medium",children:"Solicitar no WhatsApp"}),"."]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(i,{to:"/esqueci-senha",className:"text-sm text-orange-500 hover:underline",children:"Esqueci minha senha"})}),e.jsxs("div",{className:"mt-4 p-3 rounded-xl",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsxs("p",{className:"text-xs text-center",style:{color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Colaborador"})," (Entregador/Cozinha/PDV): use o mesmo login; você será direcionado ao seu painel."]}),e.jsxs("p",{className:"text-xs text-center mt-2",style:{color:"var(--text-secondary)"},children:[e.jsx(i,{to:"/ajuda",className:"text-orange-500 hover:underline",children:"Ajuda"})," · ",e.jsx("a",{href:"https://wa.me/5586988196114",target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 hover:underline",children:"WhatsApp"})]})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(i,{to:"/Cardapio",className:"text-sm",style:{color:"var(--text-secondary)"},children:"← Ver cardápio sem login"})})]})})}export{Y as default};
