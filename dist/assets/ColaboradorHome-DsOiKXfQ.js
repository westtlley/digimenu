import{r as m,i as y,g as n,j as e,L as j,B as c,d as b}from"./main-AonIQAES.js";import{L as w}from"./layout-dashboard-Dya9zxYj.js";import{C}from"./chart-column-5rcpA1LB.js";import{T as N}from"./truck-D6zUN2Zr.js";import{C as _}from"./chef-hat-DUqumxLr.js";import{C as k}from"./calculator-CX78XC4C.js";import{R as L}from"./receipt-MH5-4Fa4.js";import{U as G}from"./users-BZplJILV.js";import{L as P}from"./log-out-DfGDd85T.js";const u=[{id:"painel",role:"gerente",label:"Painel do Gerente",path:"/PainelGerente",icon:w,color:"from-violet-600 to-violet-700",hoverColor:"hover:from-violet-700 hover:to-violet-800"},{id:"gestor",role:"gerente",label:"Gestor de Pedidos",path:"/GestorPedidos",icon:C,color:"from-orange-600 to-orange-700",hoverColor:"hover:from-orange-700 hover:to-orange-800"},{id:"entregador",role:"entregador",label:"App do Entregador",path:"/Entregador",icon:N,color:"from-cyan-600 to-cyan-700",hoverColor:"hover:from-cyan-700 hover:to-cyan-800"},{id:"cozinha",role:"cozinha",label:"Cozinha",path:"/Cozinha",icon:_,color:"from-amber-600 to-amber-700",hoverColor:"hover:from-amber-700 hover:to-amber-800"},{id:"pdv",role:"pdv",label:"PDV",path:"/PDV",icon:k,color:"from-green-600 to-green-700",hoverColor:"hover:from-green-700 hover:to-green-800"},{id:"garcom",role:"garcom",label:"Garçom",path:"/Garcom",icon:L,color:"from-indigo-600 to-indigo-700",hoverColor:"hover:from-indigo-700 hover:to-indigo-800"}];function O(){const[o,d]=m.useState(null),[x,h]=m.useState(!0),s=y();if(m.useEffect(()=>{let r=!1;const i=setTimeout(()=>{r||(h(!1),d(null))},2e4);return(async()=>{try{if(!await n.auth.isAuthenticated()){r||s("/",{replace:!0});return}let t=await n.auth.me();if(r)return;if(!(t?.profile_roles?.length||t?.profile_role&&t.profile_role.trim()!=="")&&t?.email)try{const a=await n.get("/user/context",{_t:Date.now()});a?.user&&(t={...t,...a.user},a.user.profile_roles?.length&&(t.profile_roles=a.user.profile_roles),a.user.profile_role&&(t.profile_role=a.user.profile_role),a.user.is_owner!==void 0&&(t.is_owner=a.user.is_owner))}catch{}d(t)}catch{r||s("/",{replace:!0})}finally{clearTimeout(i),r||h(!1)}})(),()=>{r=!0,clearTimeout(i)}},[s]),x)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 dark:from-gray-900 dark:to-gray-800",children:e.jsx(j,{className:"w-10 h-10 animate-spin text-orange-500"})});if(!o)return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 dark:from-gray-900 dark:to-gray-800 p-4",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 text-center",children:"Não foi possível carregar. Verifique sua conexão ou acesse pelo link do seu restaurante."}),e.jsx(c,{variant:"outline",onClick:()=>s("/",{replace:!0}),children:"Voltar ao início"})]});let l=o?.profile_roles?.length?o.profile_roles.map(r=>String(r).toLowerCase().trim()):o?.profile_role?[String(o.profile_role).toLowerCase().trim()]:[];l.length===0&&o?.profile_role&&(l=[String(o.profile_role).toLowerCase().trim()].filter(Boolean));const p=o?.is_owner||o?.subscriber_email&&(o?.email||"").toLowerCase().trim()===(o?.subscriber_email||"").toLowerCase().trim(),f=l.includes("gerente")||p?u:u.filter(r=>r.role!=="gerente"&&l.includes(r.role)),g=()=>{n.auth.logout(),s("/",{replace:!0})};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-gray-900 dark:to-gray-800 p-4 pb-8",children:e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsxs("header",{className:"flex items-center justify-between mb-6 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-green-500 flex items-center justify-center shadow-lg",children:e.jsx(G,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Acesso Colaborador"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-[180px]",children:o?.full_name||o?.email})]})]}),e.jsx(c,{variant:"ghost",size:"icon",onClick:g,className:"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700",title:"Sair",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6",children:"Escolha a função para continuar:"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:f.map(r=>{const i=r.icon;return e.jsx(b,{to:r.path,children:e.jsxs(c,{variant:"ghost",className:`w-full h-24 sm:h-28 flex flex-col items-center justify-center gap-2 bg-gradient-to-br ${r.color} ${r.hoverColor} text-white shadow-lg transition-all hover:scale-[1.02] active:scale-[0.98] rounded-xl`,children:[e.jsx(i,{className:"w-7 h-7 sm:w-8 sm:h-8"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-center px-1",children:r.label})]})},r.id)})}),f.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx("p",{children:"Nenhuma função disponível para seu perfil."}),e.jsx("p",{className:"text-sm mt-2",children:"Entre em contato com o administrador."}),e.jsx(c,{variant:"outline",className:"mt-4",onClick:g,children:"Sair"})]})]})})}export{O as default};
