import{c as _a,r as d,j as e,B as u,X as cs,p as is,g as ms,d as j,u as ka,f as Da,L as Vs,F as Aa,e as Ms,z as k}from"./main-5wCJ0shd.js";import{u as q}from"./useQuery-TBRlwA9F.js";import{u as ue}from"./useMutation-CfjUJVgq.js";import{L as H,I as L}from"./label-BGurCIwA.js";import{B as le}from"./badge-tC6tpDVj.js";import{C as Pa,c as Fa}from"./card-co3zywKC.js";import{D as U,a as Q,b as G,c as X,e as re}from"./dialog-BQt4A9EY.js";import{u as Ea}from"./useSlugContext-DE6V1uue.js";import{u as Oa,N as Ta,P as Va,U as Ma}from"./useUpsell-CBEJfGb6.js";import{D as qa}from"./dollar-sign-BdBkW913.js";import{A as za}from"./index-BrRbWNqX.js";import{m as ye}from"./proxy-CaN4jGBq.js";import{C as Oe}from"./circle-check-big-C21gM6y_.js";import{T as ns}from"./trash-2-CxXzmM5w.js";import{P as Te}from"./plus-DJfFeu4q.js";import{C as ls}from"./circle-alert-CSoTi2zi.js";import{P as Ve,u as Ia}from"./useManagerialAuth-SxIBd_kH.js";import{u as Ra}from"./usePermission-CvwVjOfT.js";import{I as $a}from"./InstallAppButton-D7LO9hfL.js";import{f as m}from"./formatters-CvOEClq0.js";import{L as ds}from"./log-out-DCopNCEG.js";import{T as Rs}from"./trending-up-8OxCq5vE.js";import{T as $s}from"./trending-down-BL8QcX6r.js";import{R as os}from"./receipt-DLhuB_An.js";import{K as La}from"./keyboard-CBrWP3Ze.js";import{S as Ls}from"./search-C1Oe3veH.js";import{C as Ka}from"./credit-card-DjT0Ipnr.js";import{A as qs}from"./arrow-left-nPuylZ-_.js";import{W as Ba}from"./wallet-Cywk4d79.js";import{H as zs}from"./history-Cqrz1KjB.js";import{S as rs}from"./shopping-cart-BukW6CqG.js";import{M as Is}from"./minus-y5cig6qL.js";import{C as Ha}from"./clock-8p17jiPd.js";import"./index-BjH-urEE.js";import"./index-DJGIH_vd.js";import"./index-XPl2RJU8.js";import"./base44Client-BjweZdup.js";import"./play-Cg3R6ahj.js";import"./check-b5qncWl4.js";import"./chevron-left-BxOhQUkW.js";import"./chevron-down-LYt6GC0H.js";import"./star-BGayr--b.js";import"./shopping-bag-Bd6hIey6.js";import"./zap-BFRB5ZLZ.js";import"./PlanPresets-DhKoJrBx.js";import"./download-DOPNSAwp.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],Qa=_a("LockOpen",Ua),Ga=[{id:"dinheiro",label:"Dinheiro",icon:"ðŸ’µ"},{id:"pix",label:"PIX",icon:"ðŸ“±"},{id:"debito",label:"DÃ©bito",icon:"ðŸ’³"},{id:"credito",label:"CrÃ©dito",icon:"ðŸ’³"},{id:"outro",label:"Outro",icon:"ðŸ§¾"}];function Xa({isOpen:x,onClose:c,total:l,formatCurrency:p,onConfirm:r}){const[g,N]=d.useState([]),[V,w]=d.useState(!1),[S,t]=d.useState(null),[C,v]=d.useState(""),[O,b]=d.useState("");d.useEffect(()=>{x&&(N([]),w(!0),t(null),v(""),b(""))},[x,l]);const A=g.reduce((f,I)=>f+I.amount,0),E=l-A,T=E<=0,W=()=>{if(!S||!C||parseFloat(C)<=0)return;const f=Math.min(parseFloat(C),E);N([...g,{id:Date.now(),method:S.id,methodLabel:S.label,amount:f}]),t(null),v(""),w(!1)},Y=f=>{N(g.filter(I=>I.id!==f))},z=()=>{if(T)if(g.length===1&&g[0].method==="dinheiro"){const f=g[0],I=f.amount-l;r({payments:[{...f,amount:l}],change:Math.max(0,I),document:O})}else r({payments:g,change:0,document:O})};return e.jsx(U,{open:x,onOpenChange:c,children:e.jsxs(Q,{className:"max-w-lg",children:[e.jsx(G,{children:e.jsxs(X,{className:"flex items-center gap-2 text-xl",children:[e.jsx(qa,{className:"w-6 h-6 text-green-600"}),"Formas de Pagamento"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border-2 border-orange-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total a Pagar"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:p(l)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Restante"}),e.jsx("p",{className:`text-2xl font-bold ${E>0?"text-red-600":"text-green-600"}`,children:p(Math.max(0,E))})]})]})}),g.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"font-semibold",children:"Pagamentos Registrados"}),e.jsx(za,{children:g.map(f=>e.jsxs(ye.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:f.methodLabel}),e.jsx("p",{className:"text-lg font-bold text-green-600",children:p(f.amount)})]})]}),e.jsx("button",{onClick:()=>Y(f.id),className:"text-red-500 hover:text-red-700 p-2",children:e.jsx(ns,{className:"w-4 h-4"})})]},f.id))})]}),!T&&e.jsx(e.Fragment,{children:V?e.jsxs(ye.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-4 p-4 bg-gray-50 rounded-lg border-2 border-gray-200",children:[e.jsx(H,{className:"font-semibold",children:"Selecione a Forma de Pagamento"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Ga.map(f=>e.jsxs("button",{onClick:()=>t(f),className:`p-3 rounded-lg border-2 transition-all ${S?.id===f.id?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:f.icon}),e.jsx("p",{className:"font-medium text-xs",children:f.label})]},f.id))}),S&&e.jsxs(ye.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs(H,{className:"mb-2 block",children:["Valor em ",S.label," (R$)"]}),e.jsx(L,{type:"number",step:"0.01",max:E,value:C,onChange:f=>{(parseFloat(f.target.value)<=E||!f.target.value)&&v(f.target.value)},placeholder:`MÃ¡x: ${p(E)}`,className:"h-12 text-lg font-semibold",autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{onClick:()=>{w(!1),t(null),v("")},variant:"outline",className:"flex-1",children:"Cancelar"}),e.jsxs(u,{onClick:W,disabled:!C||parseFloat(C)<=0,className:"flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),"Adicionar"]})]})]})]}):e.jsxs(u,{onClick:()=>w(!0),variant:"outline",className:"w-full border-dashed border-2",children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),"Adicionar Forma de Pagamento"]})}),T&&e.jsxs(ye.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-green-50 border-2 border-green-500 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(Oe,{className:"w-6 h-6 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-green-800",children:"Pagamento Completo!"}),e.jsxs("p",{className:"text-sm text-green-600",children:["Total pago: ",p(A)]})]})]}),E>0&&g.length>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-center gap-2",children:[e.jsx(ls,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("p",{className:"text-sm text-yellow-800",children:["Ainda falta ",p(E)," para completar o pagamento"]})]}),g.length>0&&e.jsxs("div",{children:[e.jsx(H,{className:"mb-2 block text-xs text-gray-600",children:"CPF/CNPJ (opcional)"}),e.jsx(L,{value:O,onChange:f=>b(f.target.value),placeholder:"000.000.000-00",className:"h-10"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2 border-t",children:[e.jsx(u,{variant:"outline",onClick:c,className:"h-12",children:"Cancelar"}),e.jsxs(u,{onClick:z,disabled:!T,className:"bg-green-600 hover:bg-green-700 h-12 font-semibold",children:[e.jsx(Oe,{className:"w-5 h-5 mr-2"}),"Confirmar"]})]})]})})}function Wa({isOpen:x,onClose:c,orderCode:l,total:p,payments:r,change:g,formatCurrency:N,onPrint:V}){return e.jsx(U,{open:x,onOpenChange:c,children:e.jsx(Q,{className:"max-w-md",children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx(ye.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",duration:.5},children:e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Oe,{className:"w-12 h-12 text-green-600"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Venda ConcluÃ­da!"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Pedido ",e.jsxs("span",{className:"font-mono font-bold",children:["#",l]})," registrado com sucesso"]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2 text-left mb-6",children:[r&&r.length>0&&e.jsxs(e.Fragment,{children:[r.length>1&&e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Pagamento Misto:"}),r.map((w,S)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[w.methodLabel,":"]}),e.jsx("span",{className:"font-semibold text-green-600",children:N(w.amount)})]},S))]}),e.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t",children:[e.jsx("span",{className:"text-gray-600",children:"Total:"}),e.jsx("span",{className:"font-semibold text-green-600",children:N(p)})]}),g>0&&e.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t",children:[e.jsx("span",{className:"text-gray-600",children:"Troco:"}),e.jsx("span",{className:"font-bold text-orange-600",children:N(g)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{onClick:V,className:"w-full bg-blue-600 hover:bg-blue-700 h-12 font-semibold",children:[e.jsx(Ve,{className:"w-5 h-5 mr-2"}),"Imprimir Cupom"]}),e.jsxs(u,{onClick:c,variant:"outline",className:"w-full h-12 font-semibold",children:[e.jsx(cs,{className:"w-5 h-5 mr-2"}),"Fechar"]})]})]})})})}function Ja(x,c=!1){const l=is.useRef(x);l.current=x,is.useEffect(()=>{const p=r=>{if(!((r.target.tagName==="INPUT"||r.target.tagName==="TEXTAREA")&&!r.altKey)&&!c){switch(r.key){case"F1":r.preventDefault(),l.current?.onOpenHelp?.();break;case"F2":r.preventDefault(),l.current?.onOpenMenuVendas?.();break;case"F3":r.preventDefault(),l.current?.onOpenCalculator?.();break;case"F4":r.preventDefault(),l.current?.onOpenFechamento?.();break;case"F5":r.preventDefault(),l.current?.onOpenOrcamento?.();break;case"F6":r.preventDefault(),l.current?.onOpenCliente?.();break;case"F7":r.preventDefault(),l.current?.onOpenProduto?.();break;case"F8":r.preventDefault(),l.current?.onCancelItem?.();break;case"F9":r.preventDefault(),l.current?.onCancelSale?.();break;case"F10":r.preventDefault(),l.current?.onOpenTabelaPrecos?.();break;case"F11":r.preventDefault(),l.current?.onFinishSale?.();break;case"F12":r.preventDefault(),l.current?.onOpenPBMs?.();break}if(r.altKey)switch(r.key.toLowerCase()){case"d":r.preventDefault(),l.current?.onDescontos?.();break;case"g":r.preventDefault(),l.current?.onAbrirGaveta?.();break;case"i":r.preventDefault(),l.current?.onObservacao?.();break}}};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[c])}function Ya(x,c={},l="css"){const p=et(x,c);return l==="escpos"?Ks(p,x,c):Me(p)}function Za(x,c="css"){const l=st(x);return c==="escpos"?Ks(l,x):Me(l)}function et(x,c){const{orderCode:l,total:p,payments:r=[],change:g=0,items:N=[],customerName:V,date:w}=x,S=c?.name||"ESTABELECIMENTO",t=c?.address||"",C=c?.phone||"",v=N.reduce((b,A)=>b+(A.totalPrice||A.unit_price||0)*A.quantity,0),O=v-p;return`
    <div class="receipt">
      <div class="center bold">${S}</div>
      ${t?`<div class="center small">${t}</div>`:""}
      ${C?`<div class="center small">Tel: ${C}</div>`:""}
      
      <div class="line"></div>
      
      <div class="center bold">CUPOM NÃƒO FISCAL</div>
      <div class="center">PDV - Venda Presencial</div>
      
      <div class="line"></div>
      
      <div>Pedido: #${l}</div>
      <div>Data: ${w?new Date(w).toLocaleString("pt-BR"):new Date().toLocaleString("pt-BR")}</div>
      <div>Cliente: ${V}</div>
      
      <div class="line"></div>
      
      ${N.map(b=>{const A=b.dish?.name||b.name||"Item",E=b.flavors?.length?` (${b.size?.name||""} ${b.flavors.map(Y=>Y.name).join(" + ")})`:b.selections?` (${Object.values(b.selections).filter(Boolean).join(", ")})`:"",W=(b.totalPrice||b.unit_price||0)*b.quantity;return`
        <div class="item">
          <div>${b.quantity}x ${A}${E}</div>
          <div class="text-right">${m(W)}</div>
        </div>
        `}).join("")}
      
      <div class="line"></div>
      
      <div class="item">
        <div>Subtotal</div>
        <div class="text-right">${m(v)}</div>
      </div>
      
      ${O>0?`
      <div class="item">
        <div>Desconto</div>
        <div class="text-right">-${m(O)}</div>
      </div>
      `:""}
      
      <div class="item bold total">
        <div>TOTAL</div>
        <div class="text-right">${m(p)}</div>
      </div>
      
      <div class="line"></div>
      
      <div class="bold">FORMA DE PAGAMENTO</div>
      ${r.map(b=>`
      <div class="item">
        <div>${b.methodLabel||b.method}</div>
        <div class="text-right">${m(b.amount)}</div>
      </div>
      `).join("")}
      
      ${g>0?`
      <div class="item">
        <div>Troco</div>
        <div class="text-right">${m(g)}</div>
      </div>
      `:""}
      
      <div class="line"></div>
      
      <div class="center small">Obrigado pela preferÃªncia!</div>
      <div class="center small">Volte sempre!</div>
    </div>
  `}function st(x){const{operatorName:c,terminalName:l,dhInicial:p,dhFinal:r,abertura:g,totalVendas:N,qtdVendas:V,totalSangrias:w,qtdSangrias:S,totalSuprimentos:t,qtdSuprimentos:C,saldoEmCaixa:v,totalCredito:O,qtdCredito:b,totalDebito:A,qtdDebito:E,totalDinheiro:T,qtdDinheiro:W,totalPix:Y,qtdPix:z,totalTroco:f,totalDesconto:I,totalAcrescimo:se,qtdeCupons:ae,canceladosEmTela:te=0,canceladosEmTelaValor:de=0}=x;return`
    <div class="receipt">
      <div class="center bold">** RELATÃ“RIO DE FECHAMENTO **</div>
      
      <div class="line"></div>
      
      <div>OPERADOR: ${c||"-"}</div>
      <div>CAIXA: ${l||"1"}</div>
      <div>DH INICIAL: ${p||"-"}</div>
      <div>DH FINAL: ${r||"(CAIXA ABERTO)"}</div>
      
      <div class="line"></div>
      <div class="bold">MOVIMENTAÃ‡Ã•ES</div>
      <div class="line"></div>
      
      <div class="item-3col">
        <div>(+)ABERTURA DE CAIXA</div>
        <div class="text-right">1</div>
        <div class="text-right">${m(g||0)}</div>
      </div>
      <div class="item-3col">
        <div>(+)VENDA (VF)</div>
        <div class="text-right">${V||0}</div>
        <div class="text-right">${m(N||0)}</div>
      </div>
      ${S>0?`
      <div class="item-3col">
        <div>(-)SANGRIA</div>
        <div class="text-right">${S}</div>
        <div class="text-right">-${m(w)}</div>
      </div>
      `:""}
      ${C>0?`
      <div class="item-3col">
        <div>(+)SUPRIMENTO</div>
        <div class="text-right">${C}</div>
        <div class="text-right">${m(t)}</div>
      </div>
      `:""}
      <div class="item-3col bold">
        <div>(=)SALDO EM CAIXA</div>
        <div></div>
        <div class="text-right">${m(v||0)}</div>
      </div>
      
      <div class="line"></div>
      <div class="bold">FORMA DE PAGAMENTO</div>
      <div class="line"></div>
      
      <div class="item-3col">
        <div>C. CRÃ‰DITO</div>
        <div class="text-right">${b||0}</div>
        <div class="text-right">${m(O||0)}</div>
      </div>
      <div class="item-3col">
        <div>C. DÃ‰BITO</div>
        <div class="text-right">${E||0}</div>
        <div class="text-right">${m(A||0)}</div>
      </div>
      <div class="item-3col">
        <div>DINHEIRO</div>
        <div class="text-right">${W||0}</div>
        <div class="text-right">${m(T||0)}</div>
      </div>
      <div class="item-3col">
        <div>PIX</div>
        <div class="text-right">${z||0}</div>
        <div class="text-right">${m(Y||0)}</div>
      </div>
      <div class="item-3col bold">
        <div>TOTAL</div>
        <div></div>
        <div class="text-right">${m(N||0)}</div>
      </div>
      
      <div class="line"></div>
      <div class="bold">VENDAS CANCELADAS</div>
      <div class="line"></div>
      
      <div class="item-3col">
        <div>VENDA</div>
        <div class="text-right">0</div>
        <div class="text-right">0,00</div>
      </div>
      
      ${te>0?`
      <div class="small">CANCELAMENTO EM TELA</div>
      <div class="item-3col">
        <div>VENDA</div>
        <div class="text-right">${te}</div>
        <div class="text-right">${m(de)}</div>
      </div>
      `:""}
      
      <div class="line"></div>
      <div class="bold">ADICIONAIS</div>
      <div class="line"></div>
      
      <div class="item">
        <div>TROCO</div>
        <div class="text-right">${m(f||0)}</div>
      </div>
      <div class="item">
        <div>DESCONTO</div>
        <div class="text-right">${m(I||0)}</div>
      </div>
      <div class="item">
        <div>ACRÃ‰SCIMO</div>
        <div class="text-right">${m(se||0)}</div>
      </div>
      <div class="item">
        <div>QTDE CUPONS</div>
        <div class="text-right">${ae||0}</div>
      </div>
      
      <div class="line"></div>
    </div>
  `}function Me(x){const c=window.open("","_blank","width=300,height=600");c.document.write(`
    <!DOCTYPE html>
    <html>
      <head>
        <meta charset="utf-8">
        <title>ImpressÃ£o</title>
        <style>
          @page { 
            size: 80mm auto; 
            margin: 5mm; 
          }
          
          body { 
            font-family: 'Courier New', monospace; 
            font-size: 12px;
            line-height: 1.4;
            padding: 0;
            margin: 0;
            max-width: 80mm;
          }
          
          .receipt {
            padding: 5mm;
          }
          
          .center { 
            text-align: center; 
          }
          
          .bold { 
            font-weight: bold; 
          }
          
          .small {
            font-size: 10px;
          }
          
          .line { 
            border-top: 1px dashed #000; 
            margin: 5px 0; 
          }
          
          .item { 
            display: flex; 
            justify-content: space-between;
            margin: 3px 0;
          }
          
          .item-3col {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 8px;
            margin: 3px 0;
          }
          
          .text-right {
            text-align: right;
          }
          
          .total { 
            font-size: 14px;
            margin-top: 5px;
          }
        </style>
      </head>
      <body>
        ${x}
      </body>
    </html>
  `),c.document.close(),setTimeout(()=>{c.print(),setTimeout(()=>{c.close()},500)},250)}async function Ks(x,c,l){if(!("serial"in navigator))return console.warn("Web Serial API nÃ£o disponÃ­vel. Usando fallback CSS."),Me(x);try{const p=await navigator.serial.requestPort();await p.open({baudRate:9600});const r=at(c,l),g=p.writable.getWriter();return await g.write(r),g.releaseLock(),await p.close(),!0}catch(p){return console.error("Erro ao imprimir via ESC/POS:",p),console.warn("Usando fallback CSS."),Me(x)}}function at(x,c){let r="";return r+="\x1B@",r+="\x1Ba",r+="\x1BE",r+=(c?.name||"ESTABELECIMENTO")+`
`,r+="\x1BE\0",c?.address&&(r+=c.address+`
`),c?.phone&&(r+="Tel: "+c.phone+`
`),r+=`
`,r+=`--------------------------------
`,r+="\x1Ba\0",r+=`


`,r+="V\0",new TextEncoder().encode(r)}function tt({open:x,onOpenChange:c,caixa:l,operations:p=[],storeName:r="Estabelecimento",operatorName:g="",terminalName:N="",canceledInScreenCount:V=0,canceledInScreenTotal:w=0,onPrint:S,onFecharClick:t}){if(!l)return null;const C=p.filter(o=>String(o.caixa_id)===String(l.id)),v=C.filter(o=>o.type==="venda_pdv"),O=C.filter(o=>o.type==="sangria"),b=C.filter(o=>o.type==="suprimento"),A=v.filter(o=>o.payment_method==="credito").reduce((o,_)=>o+_.amount,0),E=v.filter(o=>o.payment_method==="debito").reduce((o,_)=>o+_.amount,0),T=v.filter(o=>o.payment_method==="dinheiro").reduce((o,_)=>o+_.amount,0),W=v.filter(o=>o.payment_method==="pix").reduce((o,_)=>o+_.amount,0),Y=v.filter(o=>o.payment_method==="outro").reduce((o,_)=>o+_.amount,0),z=A+E+T+W+Y,f=Number(l.opening_amount_cash)||0,I=O.reduce((o,_)=>o+_.amount,0),se=b.reduce((o,_)=>o+_.amount,0),ae=f+z+se-I,te=v.reduce((o,_)=>o+(_.change||0),0),de=v.length,pe=l.opening_date?new Date(l.opening_date).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-",h=l.status==="closed"&&l.closing_date?new Date(l.closing_date).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"(CAIXA ABERTO)",oe=is.useRef(null),qe=()=>{if(S){S();return}const o={operatorName:g,terminalName:N,dhInicial:pe,dhFinal:h,abertura:f,totalVendas:z,qtdVendas:v.length,totalSangrias:I,qtdSangrias:O.length,totalSuprimentos:se,qtdSuprimentos:b.length,saldoEmCaixa:ae,totalCredito:A,qtdCredito:v.filter(_=>_.payment_method==="credito").length,totalDebito:E,qtdDebito:v.filter(_=>_.payment_method==="debito").length,totalDinheiro:T,qtdDinheiro:v.filter(_=>_.payment_method==="dinheiro").length,totalPix:W,qtdPix:v.filter(_=>_.payment_method==="pix").length,totalTroco:te,totalDesconto:0,totalAcrescimo:0,qtdeCupons:de,canceladosEmTela:V,canceladosEmTelaValor:w};Za(o,"css")};return e.jsx(U,{open:x,onOpenChange:c,children:e.jsxs(Q,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(G,{children:e.jsx(X,{className:"text-xl",children:"Fechamento de Caixa"})}),e.jsxs("div",{ref:oe,className:"space-y-4 text-sm",children:[e.jsx("div",{className:"text-center font-bold text-base",children:"RELATÃ“RIO DE FECHAMENTO"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"OPERADOR:"})," ",g||l.opened_by||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"CAIXA:"})," ",N||l.id||"1"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"DH INICIAL:"})," ",pe]}),e.jsxs("p",{children:[e.jsx("strong",{children:"DH FINAL:"})," ",h]})]}),e.jsx("div",{className:"line"}),e.jsx("div",{className:"font-semibold",children:"MOVIMENTAÃ‡Ã•ES"}),e.jsx("table",{className:"w-full text-sm",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"(+) ABERTURA DE CAIXA"}),e.jsx("td",{children:"1"}),e.jsx("td",{className:"text-right",children:m(f)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"(+) VENDA (VF)"}),e.jsx("td",{children:v.length}),e.jsx("td",{className:"text-right",children:m(z)})]}),e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{children:"(=) SALDO EM CAIXA"}),e.jsx("td",{}),e.jsx("td",{className:"text-right",children:m(ae)})]})]})}),e.jsx("div",{className:"line"}),e.jsx("div",{className:"font-semibold",children:"FORMA DE PAGAMENTO"}),e.jsx("table",{className:"w-full text-sm",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"C. CRÃ‰DITO"}),e.jsx("td",{children:v.filter(o=>o.payment_method==="credito").length}),e.jsx("td",{className:"text-right",children:m(A)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"C. DÃ‰BITO"}),e.jsx("td",{children:v.filter(o=>o.payment_method==="debito").length}),e.jsx("td",{className:"text-right",children:m(E)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"DINHEIRO"}),e.jsx("td",{children:v.filter(o=>o.payment_method==="dinheiro").length}),e.jsx("td",{className:"text-right",children:m(T)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"PIX"}),e.jsx("td",{children:v.filter(o=>o.payment_method==="pix").length}),e.jsx("td",{className:"text-right",children:m(W)})]}),e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{children:"TOTAL"}),e.jsx("td",{}),e.jsx("td",{className:"text-right",children:m(z)})]})]})}),e.jsx("div",{className:"line"}),e.jsx("div",{className:"font-semibold",children:"VENDAS CANCELADAS"}),e.jsx("table",{className:"w-full text-sm",children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:"VENDA"}),e.jsx("td",{children:"0"}),e.jsx("td",{className:"text-right",children:"0,00"})]})})}),e.jsx("p",{className:"text-xs text-gray-500",children:"CANCELAMENTO EM TELA"}),e.jsx("div",{className:"line"}),e.jsx("div",{className:"font-semibold",children:"ADICIONAIS"}),e.jsx("table",{className:"w-full text-sm",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"TROCO"}),e.jsx("td",{className:"text-right",children:m(te)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"DESCONTO"}),e.jsx("td",{className:"text-right",children:"0,00"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"ACRÃ‰SCIMO"}),e.jsx("td",{className:"text-right",children:"0,00"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"QTDE CUPONS"}),e.jsx("td",{className:"text-right",children:de})]})]})})]}),e.jsxs(re,{className:"flex-wrap gap-2",children:[e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:qe,children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Imprimir"]}),l.status==="open"&&t&&e.jsxs(u,{type:"button",className:"bg-gray-900",onClick:t,children:[e.jsx(ms,{className:"w-4 h-4 mr-2"}),"Fechar"]}),e.jsxs(u,{type:"button",variant:"outline",onClick:()=>c(!1),children:[e.jsx(ds,{className:"w-4 h-4 mr-2"}),"Sair"]})]})]})})}function rt({open:x,onOpenChange:c,onSuprimento:l,onSangria:p,onReimpressao:r,onFechamento:g,onAbertura:N,onCancelarVenda:V,caixaAberto:w=!1}){return d.useEffect(()=>{if(!x)return;const S=t=>{switch(t.key){case"F2":t.preventDefault(),l?.();break;case"F3":t.preventDefault(),p?.();break;case"F4":t.preventDefault(),r?.();break;case"F5":t.preventDefault(),g?.();break;case"F6":t.preventDefault(),N?.();break;case"F7":t.preventDefault(),V?.();break;case"Escape":t.preventDefault(),c?.(!1);break}};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[x,l,p,r,g,N,V,c]),e.jsx(U,{open:x,onOpenChange:c,children:e.jsxs(Q,{className:"sm:max-w-2xl bg-gray-900 text-white border-gray-700",children:[e.jsx(G,{children:e.jsx(X,{className:"text-2xl text-center",children:"Menu de Vendas"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4",children:[e.jsxs(u,{onClick:l,className:"h-24 flex flex-col items-center justify-center gap-2 bg-green-700 hover:bg-green-800 text-white",children:[e.jsx(Rs,{className:"w-8 h-8"}),e.jsx("span",{className:"text-lg font-bold",children:"Suprimento"}),e.jsx("kbd",{className:"text-xs px-2 py-1 bg-green-900 rounded",children:"F2"})]}),e.jsxs(u,{onClick:p,className:"h-24 flex flex-col items-center justify-center gap-2 bg-red-700 hover:bg-red-800 text-white",children:[e.jsx($s,{className:"w-8 h-8"}),e.jsx("span",{className:"text-lg font-bold",children:"Sangria"}),e.jsx("kbd",{className:"text-xs px-2 py-1 bg-red-900 rounded",children:"F3"})]}),e.jsxs(u,{onClick:r,className:"h-24 flex flex-col items-center justify-center gap-2 bg-blue-700 hover:bg-blue-800 text-white",children:[e.jsx(os,{className:"w-8 h-8"}),e.jsx("span",{className:"text-lg font-bold",children:"ReimpressÃ£o Venda"}),e.jsx("kbd",{className:"text-xs px-2 py-1 bg-blue-900 rounded",children:"F4"})]}),e.jsxs(u,{onClick:g,disabled:!w,className:"h-24 flex flex-col items-center justify-center gap-2 bg-gray-700 hover:bg-gray-800 text-white disabled:opacity-50",children:[e.jsx(ms,{className:"w-8 h-8"}),e.jsx("span",{className:"text-lg font-bold",children:"Fechamento Caixa"}),e.jsx("kbd",{className:"text-xs px-2 py-1 bg-gray-900 rounded",children:"F5"})]}),e.jsxs(u,{onClick:N,disabled:w,className:"h-24 flex flex-col items-center justify-center gap-2 bg-yellow-700 hover:bg-yellow-800 text-white disabled:opacity-50",children:[e.jsx(Qa,{className:"w-8 h-8"}),e.jsx("span",{className:"text-lg font-bold",children:"Abertura Caixa"}),e.jsx("kbd",{className:"text-xs px-2 py-1 bg-yellow-900 rounded",children:"F6"})]}),e.jsxs(u,{onClick:V,className:"h-24 flex flex-col items-center justify-center gap-2 bg-orange-700 hover:bg-orange-800 text-white",children:[e.jsx(cs,{className:"w-8 h-8"}),e.jsx("span",{className:"text-lg font-bold",children:"Cancelar Venda"}),e.jsx("kbd",{className:"text-xs px-2 py-1 bg-orange-900 rounded",children:"F7"})]})]}),e.jsxs("div",{className:"text-center text-sm text-gray-400 pb-2",children:["Pressione ",e.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"ESC"})," para sair"]})]})})}function it({open:x,onOpenChange:c}){return e.jsx(U,{open:x,onOpenChange:c,children:e.jsxs(Q,{className:"sm:max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(G,{children:e.jsxs(X,{className:"flex items-center gap-2 text-2xl",children:[e.jsx(La,{className:"w-6 h-6"}),"Atalhos do PDV"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-blue-600 dark:text-blue-400",children:"Barra Principal"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 border",children:"Tecla"}),e.jsx("th",{className:"text-left p-2 border",children:"FunÃ§Ã£o"}),e.jsx("th",{className:"text-left p-2 border",children:"DescriÃ§Ã£o"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F1"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Ajuda"}),e.jsx("td",{className:"p-2 border",children:"Abre este modal de atalhos"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F2"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Menu de Vendas"}),e.jsx("td",{className:"p-2 border",children:"Abre menu com Suprimento, Sangria, ReimpressÃ£o, Fechamento, etc."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F4"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Fechamento"}),e.jsx("td",{className:"p-2 border",children:"Abre relatÃ³rio de fechamento de caixa"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F9"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Cancelar Venda"}),e.jsx("td",{className:"p-2 border",children:"Cancela a venda atual (limpa carrinho)"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F11"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Recebimento"}),e.jsx("td",{className:"p-2 border",children:"Abre tela de pagamento para finalizar venda"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-green-600 dark:text-green-400",children:"Menu de Vendas (F2)"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:"Atalhos disponÃ­veis quando o Menu de Vendas estÃ¡ aberto:"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 border",children:"Tecla"}),e.jsx("th",{className:"text-left p-2 border",children:"FunÃ§Ã£o"}),e.jsx("th",{className:"text-left p-2 border",children:"DescriÃ§Ã£o"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F2"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Suprimento"}),e.jsx("td",{className:"p-2 border",children:"Entrada de dinheiro no caixa"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F3"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Sangria"}),e.jsx("td",{className:"p-2 border",children:"Retirada de dinheiro do caixa"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F4"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"ReimpressÃ£o Venda"}),e.jsx("td",{className:"p-2 border",children:"Reimprimir cupom/nota de venda anterior"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F5"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Fechamento Caixa"}),e.jsx("td",{className:"p-2 border",children:"Fechar caixa e gerar relatÃ³rio"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F6"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Abertura Caixa"}),e.jsx("td",{className:"p-2 border",children:"Abrir caixa (desabilitado quando jÃ¡ aberto)"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"F7"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Cancelar Venda"}),e.jsx("td",{className:"p-2 border",children:"Cancela venda inteira"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"ESC"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Sair"}),e.jsx("td",{className:"p-2 border",children:"Fechar menu"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-purple-600 dark:text-purple-400",children:"Atalhos com Alt"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 border",children:"Atalho"}),e.jsx("th",{className:"text-left p-2 border",children:"FunÃ§Ã£o"}),e.jsx("th",{className:"text-left p-2 border",children:"DescriÃ§Ã£o"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"Alt+D"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Descontos/AcrÃ©scimos"}),e.jsx("td",{className:"p-2 border",children:"Aplicar desconto ou acrÃ©scimo na venda"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"Alt+G"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"Abrir Gaveta"}),e.jsx("td",{className:"p-2 border",children:"Comando para abrir gaveta de dinheiro"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border",children:e.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"Alt+I"})}),e.jsx("td",{className:"p-2 border font-semibold",children:"ObservaÃ§Ã£o"}),e.jsx("td",{className:"p-2 border",children:"Adicionar observaÃ§Ã£o no item selecionado"})]})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(u,{variant:"outline",onClick:()=>c(!1),children:"Fechar"})})]})})}function nt({open:x,onOpenChange:c,onPrintReceipt:l}){const[p,r]=d.useState(""),[g,N]=d.useState(""),{data:V=[],isLoading:w,error:S}=q({queryKey:["pedidosPDV",g],queryFn:async()=>g?(await j.entities.PedidoPDV.list(null,{})).filter(A=>A.order_code?.includes(g)):[],enabled:!!g}),t=V[0],C=()=>{p.trim()&&N(p.trim())},v=()=>{if(!t)return;const b={orderCode:t.order_code,total:t.total,payments:t.payment_method?[{method:t.payment_method,methodLabel:t.payment_method,amount:t.payment_amount||t.total}]:[],change:t.change||0,items:t.items||[],customerName:t.customer_name||"Cliente BalcÃ£o",date:t.created_date};l?.(b),c(!1),r(""),N("")},O=()=>{c(!1),r(""),N("")};return e.jsx(U,{open:x,onOpenChange:O,children:e.jsxs(Q,{className:"sm:max-w-lg",children:[e.jsx(G,{children:e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5"}),"ReimpressÃ£o de Venda"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"codigo",children:"CÃ³digo da Venda"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{id:"codigo",value:p,onChange:b=>r(b.target.value),placeholder:"Digite o cÃ³digo da venda",onKeyDown:b=>b.key==="Enter"&&C(),autoFocus:!0}),e.jsxs(u,{onClick:C,disabled:!p.trim()||w,children:[e.jsx(Ls,{className:"w-4 h-4 mr-2"}),"Buscar"]})]})]}),w&&e.jsx("div",{className:"text-center py-4 text-gray-500",children:"Buscando venda..."}),S&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded",children:[e.jsx(ls,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Erro ao buscar venda. Tente novamente."})]}),g&&!w&&!t&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 text-yellow-600 dark:text-yellow-400 rounded",children:[e.jsx(ls,{className:"w-5 h-5 flex-shrink-0"}),e.jsxs("span",{className:"text-sm",children:['Nenhuma venda encontrada com o cÃ³digo "',g,'"']})]}),t&&e.jsxs("div",{className:"border rounded-lg p-4 space-y-2 bg-gray-50 dark:bg-gray-800",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Pedido:"}),e.jsxs("span",{children:["#",t.order_code]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Data:"}),e.jsx("span",{children:new Date(t.created_date).toLocaleString("pt-BR")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Cliente:"}),e.jsx("span",{children:t.customer_name||"Cliente BalcÃ£o"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Itens:"}),e.jsx("span",{children:t.items?.length||0})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 mt-2",children:[e.jsx("span",{className:"font-bold text-lg",children:"Total:"}),e.jsx("span",{className:"font-bold text-lg",children:m(t.total)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Pagamento:"}),e.jsx("span",{children:t.payment_method||"-"})]}),t.change>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Troco:"}),e.jsx("span",{children:m(t.change)})]})]})]}),e.jsxs(re,{children:[e.jsx(u,{variant:"outline",onClick:O,children:"Cancelar"}),e.jsxs(u,{onClick:v,disabled:!t,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Reimprimir"]})]})]})})}function er(){const[x,c]=d.useState(null),[l,p]=d.useState(!0),[r,g]=d.useState(!1),[N,V]=d.useState(""),[w,S]=d.useState("all"),[t,C]=d.useState([]),[v,O]=d.useState(""),[b,A]=d.useState(""),[E,T]=d.useState(!1),[W,Y]=d.useState(!1),[z,f]=d.useState(null),[I,se]=d.useState(null),[ae,te]=d.useState("Cliente BalcÃ£o"),[de,pe]=d.useState(""),[h,oe]=d.useState(null),[qe,o]=d.useState(!1),[_,J]=d.useState(!1),[Ne,xs]=d.useState(""),[we,hs]=d.useState(""),[Bs,ze]=d.useState(!1),[us,Ie]=d.useState(null),[K,Re]=d.useState(null),[Ce,$e]=d.useState(""),[ce,Le]=d.useState(""),[Hs,ge]=d.useState(!1),M=ka(),{isMaster:Ke}=Ra(),{requireAuthorization:Z,modal:Us}=Ia(),{slug:Qs,subscriberEmail:ps,inSlugContext:Gs}=Ea(),R=Gs&&Ke&&ps?ps:void 0,[Be,B]=d.useState(!1),[Xs,me]=d.useState(!1),[Ws,be]=d.useState(!1),[Js,je]=d.useState(!1),[Ys,Se]=d.useState(!1),[Zs,gs]=d.useState(!1),[ea,bs]=d.useState(!1),[ie,He]=d.useState({amount:"",reason:""}),[ne,Ue]=d.useState({amount:"",reason:""}),[_e,js]=d.useState(""),[fs,vs]=d.useState(""),[sa,aa]=d.useState(0),[ta,ra]=d.useState(0);d.useEffect(()=>{(async()=>{try{const s=await j.auth.me();if(c(s),!s){j.auth.redirectToLogin("/PDV");return}console.log("[PDV] Verificando acesso para usuÃ¡rio:",{email:s.email,subscriber_email:s.subscriber_email,profile_role:s.profile_role,profile_roles:s.profile_roles,is_master:s.is_master});const a=s?.subscriber_email&&(s?.email||"").toLowerCase().trim()===(s?.subscriber_email||"").toLowerCase().trim(),n=s?.profile_roles?.length?s.profile_roles:s?.profile_role?[s.profile_role]:[],y=n.includes("gerente"),i=s?.profile_role==="pdv"||n.includes("pdv"),F=!s.subscriber_email||s.email&&s.subscriber_email&&s.email.toLowerCase().trim()===s.subscriber_email.toLowerCase().trim(),$=i||s?.is_master===!0||a||y||F;if(console.log("[PDV] Resultado da verificaÃ§Ã£o:",{isAssinante:a,isGerente:y,isPDV:i,isOwner:F,hasAccess:$}),g($),!$){p(!1);return}}catch(s){console.error("[PDV] Erro ao verificar permissÃµes:",s),j.auth.redirectToLogin("/PDV")}finally{p(!1)}})()},[]);const ys=Da(Ke?"Admin":"PainelAssinante",Ke?void 0:Qs||void 0),ke=R||x?.subscriber_email||x?.email,P=ke?{as_subscriber:ke}:{},{data:Ns=[]}=q({queryKey:["dishes",R??"me"],queryFn:()=>j.entities.Dish.list(null,P)}),{data:ia=[]}=q({queryKey:["categories",R??"me"],queryFn:()=>j.entities.Category.list("order",P)}),{data:ws=[]}=q({queryKey:["complementGroups",R??"me"],queryFn:()=>j.entities.ComplementGroup.list("order",P),refetchOnMount:"always"}),{data:fe=[],isLoading:Cs}=q({queryKey:["caixas",ke??"none"],queryFn:async()=>await j.entities.Caixa.list("-opening_date",P),enabled:!!ke&&!!x,refetchInterval:5e3}),{data:Qe=[]}=q({queryKey:["caixaOperations",R??"me"],queryFn:()=>j.entities.CaixaOperation.list("-date",P).catch(()=>[]),enabled:!!x&&r}),De=h&&Array.isArray(Qe)?Qe.filter(s=>String(s.caixa_id)===String(h.id)):[],{data:Ge=[]}=q({queryKey:["pedidosPDV",R??"me"],queryFn:()=>j.entities.PedidoPDV.list("-created_date",P).catch(()=>[])}),{data:na=[]}=q({queryKey:["store",R??"me"],queryFn:()=>j.entities.Store.list(P)}),ee=na[0]||{theme_primary_color:"#f97316"},la=Array.isArray(ee?.pdv_terminals)&&ee.pdv_terminals.length>0?ee.pdv_terminals:["PDV 1","PDV 2","PDV 3"],{data:Ss=[]}=q({queryKey:["pdvSessions",R??"me"],queryFn:()=>j.entities.PDVSession.list("-created_at",P).catch(()=>[]),enabled:!!x&&r}),_s=Array.isArray(Ss)?Ss.filter(s=>!s.ended_at):[],{data:ks=[]}=q({queryKey:["pizzaSizes",R??"me"],queryFn:()=>j.entities.PizzaSize.list("order",P)}),{data:Ds=[]}=q({queryKey:["pizzaFlavors",R??"me"],queryFn:()=>j.entities.PizzaFlavor.list("order",P)}),{data:da=[]}=q({queryKey:["pizzaEdges",R??"me"],queryFn:()=>j.entities.PizzaEdge.list(null,P)}),{data:oa=[]}=q({queryKey:["pizzaExtras",R??"me"],queryFn:()=>j.entities.PizzaExtra.list(null,P)}),{data:ca=[]}=q({queryKey:["pizzaCategories",R??"me"],queryFn:()=>j.entities.PizzaCategory.list("order",P)}),{data:As=[]}=q({queryKey:["promotions",R??"me"],queryFn:()=>j.entities.Promotion.list(P)}),{showUpsellModal:ma,upsellPromotions:xa,checkUpsell:ha,resetUpsell:ua,closeUpsell:Ae}=Oa(Array.isArray(As)?As:[],t.reduce((s,a)=>s+(a.totalPrice||0)*(a.quantity||1),0));d.useEffect(()=>{if(Cs)return;const s=(fe||[]).find(a=>a&&a.status==="open");s?(oe(s),J(!1)):Array.isArray(fe)&&fe.length>0&&!s?h&&h.status==="open"&&oe(null):fe.length===0&&!h&&J(!0)},[fe,Cs]);const Ps=ue({mutationFn:async s=>j.entities.PDVSession.create(s),onSuccess:s=>{M.invalidateQueries({queryKey:["pdvSessions"]}),Re(s),$e(s.terminal_id??s.terminal_name??""),Le(s.terminal_name??s.terminal_id??""),ge(!1)}}),Xe=ue({mutationFn:async s=>j.entities.PDVSession.update(s,{ended_at:new Date().toISOString()}),onSuccess:()=>{M.invalidateQueries({queryKey:["pdvSessions"]}),Re(null),$e(""),Le(""),ge(!0)}});d.useEffect(()=>{if(!x||!r||K)return;const s=_s.find(a=>a.operator_email===x.email);s?(Re(s),$e(s.terminal_id??s.terminal_name??""),Le(s.terminal_name??s.terminal_id??""),ge(!1)):ge(!0)},[x,r,_s,K]);const pa=ue({mutationFn:s=>j.entities.PedidoPDV.create(s),onSuccess:()=>{M.invalidateQueries({queryKey:["pedidosPDV"]})}}),We=ue({mutationFn:async s=>{const a=await j.auth.me();return j.entities.CaixaOperation.create({...s,subscriber_email:a?.subscriber_email||a?.email,operator:a.email,date:new Date().toISOString()})},onSuccess:()=>{M.invalidateQueries({queryKey:["caixaOperations"]})}}),Je=ue({mutationFn:async s=>{const a=await j.auth.me();return j.entities.Caixa.create({...s,subscriber_email:a?.subscriber_email||a?.email,owner_email:a?.subscriber_email||a?.email,opened_by:a.email,terminal_id:Ce||null,terminal_name:ce||null})},onSuccess:async s=>{console.log("[PDV] Caixa criado com sucesso:",s),await M.invalidateQueries({queryKey:["caixas"]}),await M.refetchQueries({queryKey:["caixas"]}),oe(s),console.log("[PDV] Estado openCaixa definido para:",{id:s.id,status:s.status}),J(!1),xs(""),hs(""),k.success("âœ… Caixa aberto com sucesso!")}}),Ye=ue({mutationFn:async({id:s,freshCaixa:a,totals:n,closingCash:y,closingNotes:i})=>{const F=await j.auth.me(),$={...a,opening_amount_cash:Number(a.opening_amount_cash)||0,status:"closed",total_cash:n.cash,total_pix:n.pix,total_debit:n.debit,total_credit:n.credit,total_other:n.other,closing_amount_cash:Number(y)||0,closing_notes:i||"",closed_by:F.email,closing_date:new Date().toISOString()};return delete $.id,delete $.created_date,delete $.updated_date,delete $.created_by,j.entities.Caixa.update(s,$,P)},onSuccess:async()=>{oe(null),Se(!1),me(!1),js(""),vs(""),await M.invalidateQueries({queryKey:["caixas"]}),await M.refetchQueries({queryKey:["caixas"]}),k.success("âœ… Caixa fechado com sucesso!"),setTimeout(()=>{J(!0)},300)}}),xe=h?.lock_threshold!=null&&(Number(h?.total_cash)||0)>=(Number(h?.lock_threshold)||0),ga=async()=>{if(!h||!ie.amount||!ie.reason){k.error("Preencha valor e motivo");return}const s=parseFloat(ie.amount),a=De.filter(D=>D.type==="venda_pdv"),n=De.filter(D=>D.type==="sangria"),y=De.filter(D=>D.type==="suprimento"),i=a.filter(D=>D.payment_method==="dinheiro").reduce((D,ve)=>D+ve.amount,0),F=n.reduce((D,ve)=>D+ve.amount,0),$=y.reduce((D,ve)=>D+ve.amount,0),Sa=(h.opening_amount_cash||0)+i+$-F;if(s>Sa){k.error("Saldo insuficiente no caixa");return}await We.mutateAsync({caixa_id:h.id,type:"sangria",description:`Sangria: ${ie.reason}`,amount:s,payment_method:"dinheiro",reason:ie.reason});const Ts=await j.entities.Caixa.list("-opening_date",P),ts=Array.isArray(Ts)?Ts.find(D=>String(D.id)===String(h.id)):null;if(ts){const D={...ts,withdrawals:(ts.withdrawals||0)+s};delete D.id,delete D.created_date,delete D.updated_date,delete D.created_by,await j.entities.Caixa.update(h.id,D,P)}M.invalidateQueries({queryKey:["caixas"]}),M.invalidateQueries({queryKey:["caixaOperations"]}),M.refetchQueries({queryKey:["caixas"]}),be(!1),He({amount:"",reason:""}),k.success("Sangria registrada")},ba=async()=>{if(!h||!ne.amount||!ne.reason){k.error("Preencha valor e motivo");return}const s=parseFloat(ne.amount);await We.mutateAsync({caixa_id:h.id,type:"suprimento",description:`Suprimento: ${ne.reason}`,amount:s,payment_method:"dinheiro",reason:ne.reason});const a=await j.entities.Caixa.list("-opening_date",P),n=Array.isArray(a)?a.find(y=>String(y.id)===String(h.id)):null;if(n){const y={...n,supplies:(n.supplies||0)+s};delete y.id,delete y.created_date,delete y.updated_date,delete y.created_by,await j.entities.Caixa.update(h.id,y,P)}M.invalidateQueries({queryKey:["caixas"]}),M.invalidateQueries({queryKey:["caixaOperations"]}),M.refetchQueries({queryKey:["caixas"]}),je(!1),Ue({amount:"",reason:""}),k.success("Suprimento registrado")},ja=async()=>{if(!h||!_e){k.error("Informe o valor em dinheiro ao fechar");return}const s=De.filter(i=>i.type==="venda_pdv"),a={cash:s.filter(i=>i.payment_method==="dinheiro").reduce((i,F)=>i+F.amount,0),pix:s.filter(i=>i.payment_method==="pix").reduce((i,F)=>i+F.amount,0),debit:s.filter(i=>i.payment_method==="debito").reduce((i,F)=>i+F.amount,0),credit:s.filter(i=>i.payment_method==="credito").reduce((i,F)=>i+F.amount,0),other:s.filter(i=>i.payment_method==="outro").reduce((i,F)=>i+F.amount,0)},n=await j.entities.Caixa.list("-opening_date",P),y=Array.isArray(n)?n.find(i=>String(i.id)===String(h.id)):null;if(!y){k.error("Caixa nÃ£o encontrado");return}Ye.mutate({id:h.id,freshCaixa:y,totals:a,closingCash:parseFloat(_e),closingNotes:fs})},Ze=Array.isArray(Ns)?Ns:[],Fs=Ze.filter(s=>s&&s.is_active!==!1),fa=Fs.some(s=>s.product_type==="pizza"),Es=Fs.filter(s=>{if(!s||!s.name)return!1;const a=!N||s.name.toLowerCase().includes(N.toLowerCase());let n=!0;return w==="pizzas"?n=s.product_type==="pizza":w!=="all"&&(n=s.category_id===w),a&&n}),va=s=>{if(!h){k.error("âš ï¸ Abra o caixa para iniciar as vendas"),J(!0);return}if(xe){k.error("ðŸ”’ Caixa travado. FaÃ§a uma retirada em Caixa para continuar.");return}if(s.product_type==="pizza"&&ks?.length>0&&Ds?.length>0){Ie(s);return}ws.filter(n=>s.complement_groups?.some(y=>y.group_id===n.id)).length>0?se(s):Pe({dish:s,totalPrice:s.price??0,selections:{}})},Pe=s=>{if(!h){k.error("âš ï¸ Abra o caixa para iniciar as vendas"),J(!0);return}if(xe){k.error("ðŸ”’ Caixa travado. FaÃ§a uma retirada em Caixa para continuar.");return}const a={...s,quantity:1,id:Date.now()};C(n=>{const y=[...n,a],i=y.reduce((F,$)=>F+($.totalPrice||0)*($.quantity||1),0);return setTimeout(()=>ha(i),100),y}),se(null),Ie(null),k.success(`${s.dish.name} adicionado!`)},ya=s=>{if(!s)return;const a=Ze.find(y=>y.id===s.offer_dish_id);if(!a){Ae();return}s.type==="replace"&&C([]);const n={dish:{...a,price:s.offer_price},totalPrice:s.offer_price,selections:{}};Pe(n),Ae()},Fe=(s,a)=>{a<=0?es(s):C(t.map(n=>n.id===s?{...n,quantity:a}:n))},es=s=>{C(t.filter(a=>a.id!==s)),k.success("Item removido")},ss=()=>{if(t.length===0)return;const s=calculateTotal();aa(a=>a+1),ra(a=>a+s),C([]),O(""),A(""),te("Cliente BalcÃ£o"),pe(""),ua(),k.success("Venda cancelada (F9)")};Ja({onOpenHelp:()=>gs(!0),onOpenMenuVendas:()=>K&&B(!0),onOpenFechamento:()=>{K&&h&&Z("fechar_caixa",()=>me(!0))},onCancelSale:ss,onFinishSale:()=>{t.length>0&&!xe&&h&&T(!0)}},Be);const Ee=t.reduce((s,a)=>s+a.totalPrice*a.quantity,0),Na=Ee*(parseFloat(b||0)/100),as=parseFloat(v||0)+Na,he=Math.max(0,Ee-as);if(l)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Vs,{className:"w-8 h-8 animate-spin text-orange-500 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Carregando..."})]})});if(!r)return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8 max-w-md text-center",children:[e.jsx(Ka,{className:"w-16 h-16 text-orange-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Acesso restrito"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Esta tela Ã© apenas para o perfil PDV."}),e.jsxs(u,{onClick:()=>j.auth.logout(),className:"bg-orange-600 hover:bg-orange-700 text-white",children:[e.jsx(ds,{className:"w-4 h-4 mr-2"}),"Sair"]})]})});const wa=()=>{const s=parseFloat(Ne);if(isNaN(s)||s<0){k.error("Informe um valor vÃ¡lido de abertura");return}const a=we?parseFloat(we):null;if(we&&(isNaN(a)||a<=0)){k.error("Valor limite de travamento deve ser maior que zero ou vazio");return}console.log("[PDV] Abrindo caixa com dados:",{opening_amount_cash:s,terminal_id:Ce,terminal_name:ce,lock_threshold:a}),Je.mutate({opening_amount_cash:s,opening_date:new Date().toISOString(),status:"open",total_cash:0,total_pix:0,total_debit:0,total_credit:0,total_other:0,withdrawals:0,supplies:0,lock_threshold:a||null})},Ca=async s=>{if(!h){k.error("âš ï¸ Abra o caixa para iniciar as vendas"),T(!1),J(!0);return}const a=await j.auth.me(),n=`PDV${Date.now().toString().slice(-8)}`,y={subscriber_email:a?.subscriber_email||a?.email,order_code:n,customer_name:ae,customer_phone:de,customer_document:s.document,items:t.map(i=>({dish_id:i.dish?.id,dish_name:i.dish?.name,quantity:i.quantity,unit_price:i.totalPrice??i.dish?.price,total_price:(i.totalPrice??i.dish?.price??0)*i.quantity,selections:i.selections||(i.flavors?{size:i.size,flavors:i.flavors,edge:i.edge,extras:i.extras,specifications:i.specifications}:{})})),subtotal:Ee,discount:as,total:he,payment_method:s.payments.length===1?s.payments[0].methodLabel:`Misto (${s.payments.map(i=>i.methodLabel).join(" + ")})`,payment_amount:s.payments.reduce((i,F)=>i+F.amount,0),change:s.change,caixa_id:h.id,seller_email:a.email,seller_name:a.full_name,...Ce&&{pdv_terminal_id:Ce},...ce&&{pdv_terminal_name:ce},...K?.id&&{pdv_session_id:K.id}};await pa.mutateAsync(y);for(const i of s.payments)await We.mutateAsync({caixa_id:h.id,type:"venda_pdv",description:`PDV #${n} - ${ae} (${i.methodLabel})`,amount:i.amount,payment_method:i.method,payment_amount:i.amount,change:0,pedido_pdv_id:n});M.invalidateQueries({queryKey:["caixas"]}),f({orderCode:n,total:he,payments:s.payments,change:s.change,items:t,customerName:ae}),C([]),O(""),A(""),te("Cliente BalcÃ£o"),pe(""),T(!1),o(!1),Y(!0)},Os=(s=null)=>{const a=s||z;a&&Ya(a,ee,"css")};return e.jsxs("div",{className:"min-h-screen min-h-screen-mobile h-screen flex flex-col bg-gray-50",children:[e.jsx(Aa,{position:"top-center"}),Us,e.jsx("div",{className:"bg-gray-900 text-white h-14 sm:h-16 flex-shrink-0 border-b border-gray-700 safe-top",children:e.jsxs("div",{className:"h-full px-3 sm:px-4 flex items-center justify-between max-w-[2000px] mx-auto gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 min-w-0",children:[e.jsx(Ms,{to:ys,className:"shrink-0",children:e.jsxs(u,{variant:"ghost",size:"sm",className:"text-white hover:bg-gray-800 min-h-touch min-w-touch h-10 sm:h-10 px-2 sm:px-3",children:[e.jsx(qs,{className:"w-4 h-4 mr-2"}),"Voltar"]})}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(os,{className:"w-4 h-4 sm:w-5 sm:h-5 shrink-0"}),e.jsx("h1",{className:"font-bold text-sm sm:text-lg truncate",children:"PDV - Venda Presencial"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 shrink-0",children:[e.jsx($a,{pageName:"PDV",compact:!0}),h?e.jsx(le,{variant:"outline",className:"bg-green-600 text-white border-green-600 h-8 font-semibold",children:"âœ… Caixa Aberto"}):e.jsx(le,{variant:"outline",className:"bg-red-600 text-white border-red-600 h-8 font-semibold",children:"ðŸ”’ Caixa Fechado"}),e.jsxs(le,{variant:"outline",className:"text-white border-gray-600 h-8 hidden sm:flex",children:[t.length," ",t.length===1?"item":"itens"]}),e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>K&&B(!0),className:"text-white hover:bg-gray-800 h-10 hidden sm:flex",title:"Menu de Vendas (F2) - Suprimento, Sangria, Fechamento",children:[e.jsx(Ba,{className:"w-4 h-4 mr-2"}),"Menu"]}),e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>ze(!0),className:"text-white hover:bg-gray-800 h-10 hidden sm:flex",children:[e.jsx(zs,{className:"w-4 h-4 mr-2"}),"HistÃ³rico"]}),K&&e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>Xe.mutate(K.id),disabled:Xe.isPending,className:"text-white hover:bg-gray-800 h-10 hidden sm:flex",title:"Sair deste PDV (encerra sua sessÃ£o)",children:[Xe.isPending?e.jsx(Vs,{className:"w-4 h-4 animate-spin"}):e.jsx(ds,{className:"w-4 h-4 mr-2"}),"Sair do PDV"]}),K&&e.jsx(le,{variant:"outline",className:"text-white border-gray-500 h-8 font-normal",children:ce})]})]})}),e.jsx(U,{open:Hs,onOpenChange:ge,children:e.jsxs(Q,{className:"sm:max-w-md",children:[e.jsx(G,{children:e.jsx(X,{children:"Selecionar terminal PDV"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"Em qual PDV vocÃª estÃ¡ operando?"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 py-2",children:la.map((s,a)=>e.jsx(u,{variant:"outline",className:"h-12",disabled:Ps.isPending,onClick:async()=>{const n=await j.auth.me();await Ps.mutateAsync({terminal_id:String(a+1),terminal_name:typeof s=="string"?s:`PDV ${a+1}`,operator_email:n?.email,operator_name:n?.full_name,started_at:new Date().toISOString()})},children:typeof s=="string"?s:`PDV ${a+1}`},a))}),e.jsx(re,{})]})}),e.jsx(U,{open:Be,onOpenChange:B,children:e.jsxs(Q,{className:"sm:max-w-sm",children:[e.jsx(G,{children:e.jsx(X,{children:"Menu de Vendas"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 py-2",children:[e.jsxs(u,{variant:"outline",className:"h-14 flex flex-col gap-1",onClick:()=>{B(!1),Z("suprimento",()=>je(!0))},children:[e.jsx(Rs,{className:"w-6 h-6 text-green-600"}),e.jsx("span",{children:"Suprimento (F2)"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Adicionar troco"})]}),e.jsxs(u,{variant:"outline",className:"h-14 flex flex-col gap-1",onClick:()=>{B(!1),Z("sangria",()=>be(!0))},children:[e.jsx($s,{className:"w-6 h-6 text-red-600"}),e.jsx("span",{children:"Sangria (F3)"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Retirada"})]}),e.jsxs(u,{variant:"outline",className:"h-14 flex flex-col gap-1 col-span-2",onClick:()=>{B(!1),me(!0)},children:[e.jsx(ms,{className:"w-6 h-6"}),e.jsx("span",{children:"Fechamento (F4)"}),e.jsx("span",{className:"text-xs text-gray-500",children:"RelatÃ³rio e fechar caixa"})]})]})]})}),e.jsx(tt,{open:Xs,onOpenChange:me,caixa:h,operations:Qe||[],storeName:ee?.name,operatorName:x?.full_name||x?.email,terminalName:ce,canceledInScreenCount:sa,canceledInScreenTotal:ta,onFecharClick:h?.status==="open"?()=>Z("fechar_caixa",()=>{me(!1),Se(!0)}):void 0}),e.jsx(rt,{open:Be,onOpenChange:B,onSuprimento:()=>{B(!1),Z("suprimento",()=>je(!0))},onSangria:()=>{B(!1),Z("sangria",()=>be(!0))},onReimpressao:()=>{B(!1),bs(!0)},onFechamento:()=>{B(!1),Z("fechar_caixa",()=>me(!0))},onAbertura:()=>{B(!1),Z("abrir_caixa",()=>J(!0))},onCancelarVenda:()=>{B(!1),ss()},caixaAberto:!!h}),e.jsx(it,{open:Zs,onOpenChange:gs}),e.jsx(nt,{open:ea,onOpenChange:bs,onPrintReceipt:Os}),e.jsx(U,{open:Ys,onOpenChange:Se,children:e.jsxs(Q,{children:[e.jsx(G,{children:e.jsx(X,{children:"Fechar caixa"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(H,{children:"Valor em dinheiro ao fechar (R$)"}),e.jsx(L,{type:"number",step:"0.01",value:_e,onChange:s=>js(s.target.value),placeholder:"0,00"}),e.jsx(H,{children:"ObservaÃ§Ãµes (opcional)"}),e.jsx(L,{value:fs,onChange:s=>vs(s.target.value),placeholder:"ObservaÃ§Ãµes do fechamento"})]}),e.jsxs(re,{children:[e.jsx(u,{variant:"outline",onClick:()=>Se(!1),children:"Cancelar"}),e.jsx(u,{onClick:ja,disabled:!_e||Ye.isPending,children:Ye.isPending?"Fechando...":"Confirmar Fechamento"})]})]})}),e.jsx(U,{open:Ws,onOpenChange:be,children:e.jsxs(Q,{children:[e.jsx(G,{children:e.jsx(X,{children:"Registrar Sangria (retirada)"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(H,{children:"Valor (R$)"}),e.jsx(L,{type:"number",step:"0.01",value:ie.amount,onChange:s=>He(a=>({...a,amount:s.target.value})),placeholder:"0,00"})]}),e.jsxs("div",{children:[e.jsx(H,{children:"Motivo"}),e.jsx(L,{value:ie.reason,onChange:s=>He(a=>({...a,reason:s.target.value})),placeholder:"Ex: DepÃ³sito bancÃ¡rio"})]})]}),e.jsxs(re,{children:[e.jsx(u,{variant:"outline",onClick:()=>be(!1),children:"Cancelar"}),e.jsx(u,{className:"bg-red-600",onClick:ga,children:"Registrar Sangria"})]})]})}),e.jsx(U,{open:Js,onOpenChange:je,children:e.jsxs(Q,{children:[e.jsx(G,{children:e.jsx(X,{children:"Registrar Suprimento (adicionar troco)"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(H,{children:"Valor (R$)"}),e.jsx(L,{type:"number",step:"0.01",value:ne.amount,onChange:s=>Ue(a=>({...a,amount:s.target.value})),placeholder:"0,00"})]}),e.jsxs("div",{children:[e.jsx(H,{children:"Motivo"}),e.jsx(L,{value:ne.reason,onChange:s=>Ue(a=>({...a,reason:s.target.value})),placeholder:"Ex: ReforÃ§o de caixa"})]})]}),e.jsxs(re,{children:[e.jsx(u,{variant:"outline",onClick:()=>je(!1),children:"Cancelar"}),e.jsx(u,{className:"bg-orange-600",onClick:ba,children:"Registrar Suprimento"})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:!K&&r?e.jsx("div",{className:"flex items-center justify-center h-full p-8",children:e.jsx("p",{className:"text-gray-500",children:"Selecione o terminal PDV acima para continuar."})}):e.jsxs("div",{className:"h-full max-w-[2000px] mx-auto grid grid-cols-1 lg:grid-cols-[1fr_480px]",children:[e.jsxs("div",{className:"flex flex-col bg-white h-full overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-b px-3 sm:px-4 py-2 sm:py-3",children:e.jsxs("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide",children:[e.jsx("button",{onClick:()=>S("all"),className:`px-4 sm:px-5 py-2 sm:py-2.5 rounded-lg text-xs sm:text-sm font-bold whitespace-nowrap transition-colors min-h-touch ${w==="all"?"bg-orange-500 text-white":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:"TODOS"}),fa&&e.jsx("button",{onClick:()=>S("pizzas"),className:`px-4 sm:px-5 py-2 sm:py-2.5 rounded-lg text-xs sm:text-sm font-bold whitespace-nowrap transition-colors min-h-touch ${w==="pizzas"?"bg-orange-500 text-white":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:"PIZZAS"}),(ia||[]).filter(s=>s&&s.name).map(s=>e.jsx("button",{onClick:()=>S(s.id),className:`px-4 sm:px-5 py-2 sm:py-2.5 rounded-lg text-xs sm:text-sm font-bold whitespace-nowrap transition-colors min-h-touch ${w===s.id?"bg-orange-500 text-white":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:(s.name||"Categoria").toUpperCase()},s.id))]})}),e.jsx("div",{className:"flex-shrink-0 px-4 py-3 bg-white border-b",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ls,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx(L,{placeholder:"Buscar produto por nome...",value:N,onChange:s=>V(s.target.value),className:"pl-10 h-11 bg-gray-50"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-3",children:Es.map(s=>e.jsxs("button",{onClick:()=>va(s),className:"group bg-white rounded-xl border-2 border-gray-200 hover:border-orange-400 hover:shadow-md transition-all overflow-hidden",children:[e.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden",children:s.image?e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-5xl",children:"ðŸ½ï¸"})}),e.jsxs("div",{className:"p-3",children:[e.jsx("h4",{className:"font-bold text-sm text-gray-900 mb-2 line-clamp-2 min-h-[40px]",children:s.name}),e.jsx("div",{className:"text-xl font-bold text-orange-600",children:s.product_type==="pizza"?s.pizza_config?.sizes?.[0]?m(s.pizza_config.sizes[0].price_tradicional):"Montar":m(s.price)})]})]},s.id))}),Es.length===0&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-gray-400",children:"Nenhum produto encontrado"})})]})]}),e.jsxs("div",{className:"hidden lg:flex flex-col bg-gray-900 h-full overflow-hidden border-l border-gray-700",children:[e.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-6 h-6 text-orange-400"}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Comanda"})]}),e.jsx(le,{className:"bg-orange-500 text-white px-3 py-1",children:t.length})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[e.jsx(rs,{className:"w-16 h-16 text-gray-700 mb-3"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Nenhum item na comanda"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Clique em um produto para adicionar"})]}):t.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 border border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 pr-2",children:[e.jsx("h4",{className:"font-bold text-white text-sm mb-1",children:s.dish.name}),(s.flavors?.length>0||s.selections&&Object.keys(s.selections).length>0)&&e.jsxs("div",{className:"mb-1",children:[s.size&&e.jsxs("p",{className:"text-xs text-gray-400",children:["â€¢ ",s.size.name]}),s.flavors?.map((a,n)=>e.jsxs("p",{className:"text-xs text-gray-400",children:["â€¢ ",a.name]},n)),s.edge&&s.edge.id!=="none"&&e.jsxs("p",{className:"text-xs text-gray-400",children:["â€¢ Borda: ",s.edge.name]}),!s.flavors?.length&&Object.entries(s.selections||{}).map(([a,n])=>Array.isArray(n)?n.map((y,i)=>e.jsxs("p",{className:"text-xs text-gray-400",children:["â€¢ ",y?.name]},`${a}-${i}`)):n?e.jsxs("p",{className:"text-xs text-gray-400",children:["â€¢ ",n?.name]},a):null)]}),e.jsxs("p",{className:"text-xs text-gray-400",children:[m(s.totalPrice)," un."]})]}),e.jsx("button",{onClick:()=>es(s.id),className:"text-red-400 hover:text-red-300 p-1.5 hover:bg-red-900/20 rounded",children:e.jsx(ns,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-700 rounded-lg p-0.5",children:[e.jsx("button",{onClick:()=>Fe(s.id,s.quantity-1),className:"w-9 h-9 min-h-touch min-w-touch rounded hover:bg-gray-600 flex items-center justify-center",children:e.jsx(Is,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"w-10 text-center font-bold text-lg text-white",children:s.quantity}),e.jsx("button",{onClick:()=>Fe(s.id,s.quantity+1),className:"w-9 h-9 min-h-touch min-w-touch rounded hover:bg-gray-600 flex items-center justify-center",children:e.jsx(Te,{className:"w-4 h-4 text-white"})})]}),e.jsx("span",{className:"font-bold text-xl text-orange-400",children:m(s.totalPrice*s.quantity)})]})]},s.id))}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-700 p-3 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(L,{type:"number",step:"0.01",value:v,onChange:s=>O(s.target.value),placeholder:"Desc. R$",className:"h-8 bg-gray-800 border-gray-700 text-white text-xs"}),e.jsx(L,{type:"number",step:"0.01",value:b,onChange:s=>A(s.target.value),placeholder:"Desc. %",className:"h-8 bg-gray-800 border-gray-700 text-white text-xs"})]}),as>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs py-1 border-b border-gray-700",children:[e.jsx("span",{className:"text-gray-400",children:"Subtotal"}),e.jsx("span",{className:"font-semibold text-white",children:m(Ee)})]}),e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-base font-bold text-white",children:"TOTAL"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:m(he)})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(u,{onClick:ss,disabled:t.length===0,variant:"outline",className:"h-9 border-gray-700 text-gray-300 hover:bg-gray-800 text-sm",children:"Limpar"}),e.jsx(u,{onClick:()=>{if(xe){k.error("ðŸ”’ Caixa travado. FaÃ§a uma retirada em Caixa para continuar.");return}T(!0)},disabled:t.length===0,className:"h-9 bg-green-600 hover:bg-green-700 font-bold text-sm",children:"Finalizar"})]})]})]})]})}),K&&e.jsxs("div",{className:"hidden lg:flex flex-shrink-0 px-4 py-2 bg-gray-800 border-t border-gray-700 text-gray-400 text-xs justify-center gap-6 flex-wrap",children:[e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-700 rounded",children:"F2"})," Menu de Vendas"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-700 rounded",children:"F4"})," Fechamento"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-700 rounded",children:"F9"})," Cancelar venda"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-700 rounded",children:"F11"})," Recebimento"]})]}),K&&e.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 p-4 pb-[max(1rem,env(safe-area-inset-bottom,0px))] bg-gray-900 border-t border-gray-700",children:e.jsxs(u,{onClick:()=>o(!0),className:"w-full min-h-[48px] h-14 bg-orange-500 hover:bg-orange-600 text-white font-bold text-lg",disabled:t.length===0,children:[e.jsx(rs,{className:"w-5 h-5 mr-2"}),"Ver Comanda (",t.length,")",t.length>0&&e.jsxs("span",{className:"ml-2",children:["â€¢ ",m(he)]})]})}),qe&&e.jsxs("div",{className:"lg:hidden fixed inset-0 z-50 bg-gray-900 flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Comanda"}),e.jsx("button",{onClick:()=>o(!1),className:"text-white min-h-touch min-w-touch flex items-center justify-center p-2 -m-1 hover:bg-gray-800 rounded","aria-label":"Fechar comanda",children:e.jsx(cs,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:t.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-white text-sm",children:s.dish.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[m(s.totalPrice)," un."]})]}),e.jsx("button",{onClick:()=>es(s.id),className:"text-red-400 p-2 min-h-touch min-w-touch rounded hover:bg-red-900/20",children:e.jsx(ns,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-700 rounded-lg p-0.5",children:[e.jsx("button",{onClick:()=>Fe(s.id,s.quantity-1),className:"w-9 h-9 min-h-touch min-w-touch rounded flex items-center justify-center hover:bg-gray-600",children:e.jsx(Is,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"w-10 text-center font-bold text-white",children:s.quantity}),e.jsx("button",{onClick:()=>Fe(s.id,s.quantity+1),className:"w-9 h-9 min-h-touch min-w-touch rounded flex items-center justify-center hover:bg-gray-600",children:e.jsx(Te,{className:"w-4 h-4 text-white"})})]}),e.jsx("span",{className:"font-bold text-lg text-orange-400",children:m(s.totalPrice*s.quantity)})]})]},s.id))}),e.jsxs("div",{className:"flex-shrink-0 p-4 pb-[max(1rem,env(safe-area-inset-bottom,0px))] border-t border-gray-700 space-y-3",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg font-bold text-white",children:"TOTAL"}),e.jsx("span",{className:"text-3xl font-bold text-white",children:m(he)})]})}),e.jsx(u,{onClick:()=>{if(!h){k.error("âš ï¸ Abra o caixa para iniciar as vendas"),o(!1),J(!0);return}if(xe){k.error("ðŸ”’ Caixa travado. FaÃ§a uma retirada em Caixa para continuar.");return}if(t.length===0){k.error("Adicione itens Ã  comanda antes de finalizar");return}o(!1),T(!0)},disabled:t.length===0||!h||xe,className:"w-full min-h-[48px] h-12 bg-green-600 hover:bg-green-700 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Finalizar Venda"})]})]}),e.jsx(Ta,{isOpen:!!I,onClose:()=>se(null),dish:I,complementGroups:ws,onAddToCart:Pe,primaryColor:ee.theme_primary_color||"#f97316"}),us&&e.jsx(Va,{dish:us,sizes:ks,flavors:Ds,edges:da,extras:oa,categories:ca,onAddToCart:Pe,onClose:()=>Ie(null),primaryColor:ee.theme_primary_color||"#f97316",store:ee}),e.jsx(Ma,{isOpen:ma,onClose:Ae,promotions:xa,dishes:Ze,onAccept:ya,onDecline:Ae,primaryColor:ee.theme_primary_color||"#f97316",darkMode:!0}),e.jsx(Xa,{isOpen:E,onClose:()=>T(!1),total:he,formatCurrency:m,onConfirm:Ca}),e.jsx(Wa,{isOpen:W,onClose:()=>Y(!1),orderCode:z?.orderCode,total:z?.total,payments:z?.payments,change:z?.change,formatCurrency:m,onPrint:Os}),e.jsx(U,{open:Bs,onOpenChange:ze,children:e.jsxs(Q,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(G,{children:e.jsxs(X,{className:"flex items-center gap-2 text-xl",children:[e.jsx(zs,{className:"w-6 h-6 text-orange-500"}),"HistÃ³rico de Vendas PDV"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 py-4",children:!Ge||Ge.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(os,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhuma venda registrada ainda"})]}):(Ge||[]).filter(s=>s).map(s=>{let a=null;try{const n=s.created_date||s.created_at;n&&typeof n=="string"&&n.trim()!==""&&(a=new Date(n),isNaN(a.getTime())&&(a=null))}catch(n){console.error("Erro ao processar data:",n),a=null}return e.jsx(Pa,{className:"border-l-4 border-l-orange-500",children:e.jsxs(Fa,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(le,{className:"bg-orange-500",children:["#",s.order_code]}),a&&e.jsxs("span",{className:"text-sm text-gray-600",children:[e.jsx(Ha,{className:"w-4 h-4 inline mr-1"}),a.toLocaleString("pt-BR")]})]}),e.jsx("p",{className:"font-semibold text-lg",children:s.customer_name}),s.customer_phone&&e.jsxs("p",{className:"text-sm text-gray-600",children:["ðŸ“ž ",s.customer_phone]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:m(s.total)}),e.jsx(le,{variant:"outline",className:"mt-1",children:s.payment_method})]})]}),e.jsxs("div",{className:"space-y-1 border-t pt-2",children:[s.items?.map((n,y)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[n.quantity,"x ",n.dish_name]}),e.jsx("span",{className:"font-medium",children:m(n.total_price)})]},y)),s.discount>0&&e.jsxs("div",{className:"flex justify-between text-sm text-red-600 pt-1 border-t",children:[e.jsx("span",{children:"Desconto"}),e.jsxs("span",{children:["-",m(s.discount)]})]}),s.change>0&&e.jsxs("div",{className:"flex justify-between text-sm text-blue-600",children:[e.jsx("span",{children:"Troco"}),e.jsx("span",{children:m(s.change)})]})]})]})},s.id)})}),e.jsx(re,{children:e.jsx(u,{variant:"outline",onClick:()=>ze(!1),children:"Fechar"})})]})}),e.jsx(U,{open:_,onOpenChange:s=>{if(!s&&!h){k.error("ðŸš« Ã‰ OBRIGATÃ“RIO abrir o caixa para usar o PDV!");return}J(s)},children:e.jsxs(Q,{className:"sm:max-w-md",onInteractOutside:s=>{h||s.preventDefault()},onEscapeKeyDown:s=>{h||s.preventDefault()},children:[e.jsx(G,{children:e.jsx(X,{className:"text-xl font-bold text-red-600",children:h?"ðŸ”“ Abrir Novo Caixa":"ðŸ”’ CAIXA FECHADO - PDV BLOQUEADO"})}),e.jsxs("div",{className:"space-y-6 py-4",children:[!h&&e.jsxs("div",{className:"bg-red-50 border-2 border-red-500 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-red-800 font-bold mb-2",children:"âš ï¸ O PDV estÃ¡ bloqueado!"}),e.jsx("p",{className:"text-xs text-red-700",children:"Para realizar vendas no PDV, vocÃª DEVE abrir um caixa primeiro. Esta Ã© uma operaÃ§Ã£o obrigatÃ³ria para controle financeiro."})]}),h&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"ðŸ’¡ JÃ¡ existe um caixa aberto. Deseja abrir um novo?"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(H,{className:"text-base font-semibold",children:"Valor de Abertura em Dinheiro (R$) *"}),e.jsx(L,{type:"number",step:"0.01",min:"0",value:Ne,onChange:s=>xs(s.target.value),placeholder:"0,00",className:"text-2xl font-bold h-16 text-center border-2",autoFocus:!0}),e.jsx("p",{className:"text-xs text-gray-600",children:"Valor em dinheiro fÃ­sico disponÃ­vel no caixa ao abrir"})]}),e.jsxs("div",{className:"space-y-3 p-3 rounded-lg border border-amber-200 bg-amber-50/50",children:[e.jsx(H,{className:"text-base font-semibold",children:"Valor limite de travamento (R$) â€“ opcional"}),e.jsx(L,{type:"number",step:"0.01",min:"0",value:we,onChange:s=>hs(s.target.value),placeholder:"Ex: 500",className:"h-12 border-2 bg-white"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Quando as vendas em dinheiro atingirem este valor, o PDV trava atÃ© ser feita uma retirada em Caixa"})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsx("p",{className:"text-xs text-green-800 font-medium",children:"âœ… ApÃ³s abrir o caixa, vocÃª poderÃ¡ realizar vendas normalmente"})})]}),e.jsxs(re,{className:"gap-2 sm:gap-0 flex-col sm:flex-row",children:[h?e.jsx(u,{variant:"outline",onClick:()=>J(!1),className:"w-full sm:w-auto",children:"Cancelar"}):e.jsx(Ms,{to:ys,className:"w-full sm:w-auto",children:e.jsxs(u,{variant:"outline",className:"w-full",children:[e.jsx(qs,{className:"w-4 h-4 mr-2"}),"Voltar"]})}),e.jsx(u,{onClick:()=>Z("abrir_caixa",()=>wa()),disabled:!Ne||parseFloat(Ne)<0||Je.isPending,className:"bg-green-600 hover:bg-green-700 font-semibold w-full sm:w-auto",children:Je.isPending?"Abrindo Caixa...":"âœ… Confirmar Abertura"})]})]})})]})}export{er as default};
