import{r as d,j as e,T as J,B as j,i as ee,k as se,L as E,g as U,e as re,f as ae,d as M}from"./main-5wCJ0shd.js";import{B as z}from"./badge-tC6tpDVj.js";import{A as te,h as ie,a as oe,b as ne,c as le,d as me,e as ce,f as de,g as pe}from"./alert-dialog-CsqCNnx-.js";import{u as xe}from"./usePermission-CvwVjOfT.js";import{P as he}from"./PlanPresets-DhKoJrBx.js";import{V as $,W as B,M as ue}from"./LimitBlockModal-CxIjaPQ-.js";import"./dialog-BQt4A9EY.js";import{c as F}from"./planLimits-Asbb4bbl.js";import{b as O,u as ge}from"./useDocumentHead-nN5iF5wF.js";import{u as fe}from"./useSlugContext-DE6V1uue.js";import{u as be}from"./useQuery-TBRlwA9F.js";import{S as je}from"./SharedSidebar-CxNvGutE.js";import{I as we}from"./InstallAppButton-D7LO9hfL.js";import{W as ve,M as Ne,D as I,L as ye,T as Ce,C as ke,a as Se,P as Te,b as Ae,S as _e,c as Pe,d as De,e as Le,f as Ee,g as Me,h as ze,i as $e,j as Be,F as Fe,k as Oe,O as Ie,l as Ve,m as Ue}from"./TablesTab-CaoLSTus.js";import"./base44Client-BjweZdup.js";import"./label-BGurCIwA.js";import"./card-co3zywKC.js";import"./EmptyState-DwIWL_NX.js";import"./select-D68HeZiV.js";import{A as We,I as Re,B as Ge}from"./AffiliateProgram-DLEbygd4.js";import{L as He}from"./log-out-DCopNCEG.js";import{M as qe}from"./menu-RhFNat6_.js";import{S as V}from"./store-DBfh0a_B.js";import{P as Ke}from"./power-CLRjBc1X.js";import{C as Qe}from"./crown-BHw4UscZ.js";import{C as Ye}from"./calendar-Bijjub7E.js";import"./index-XPl2RJU8.js";import"./index-BjH-urEE.js";import"./index-DJGIH_vd.js";import"./formatters-CvOEClq0.js";import"./format-D5amLcIy.js";import"./differenceInCalendarDays-DQNRMz4Z.js";import"./constants-CG7Neo-X.js";import"./index-DxdNJ03y.js";import"./index-DBH5IvqS.js";import"./chevron-right-CodG0qo6.js";import"./check-b5qncWl4.js";import"./useManagerialAuth-SxIBd_kH.js";import"./circle-alert-CSoTi2zi.js";import"./download-DOPNSAwp.js";import"./dollar-sign-BdBkW913.js";import"./shopping-bag-Bd6hIey6.js";import"./trending-up-8OxCq5vE.js";import"./credit-card-DjT0Ipnr.js";import"./chevron-left-BxOhQUkW.js";import"./wallet-Cywk4d79.js";import"./chart-column-Da9oBHTD.js";import"./history-Cqrz1KjB.js";import"./users-BsPmyBXt.js";import"./message-circle-CIMJfci3.js";import"./whatsappService-DTdPogZi.js";import"./receipt-DLhuB_An.js";import"./map-pin-Cc9ILfAa.js";import"./shield-DAgABFti.js";import"./settings-CVkD5Rnm.js";import"./ticket-B7bgD8TJ.js";import"./sparkles-DNoIDe0Q.js";import"./chevron-down-LYt6GC0H.js";import"./proxy-CaN4jGBq.js";import"./star-BGayr--b.js";import"./target-DVKGgDzt.js";import"./clock-8p17jiPd.js";import"./shopping-cart-BukW6CqG.js";import"./circle-check-big-C21gM6y_.js";import"./copy-DcaS5Ul6.js";import"./useMutation-CfjUJVgq.js";import"./calculator-CLN8Z376.js";import"./chef-hat-Tma-MV-q.js";import"./index-BrRbWNqX.js";import"./textarea-BBItVPmi.js";import"./switch-CiXzU0WK.js";import"./index-DJsYT-OT.js";import"./search-C1Oe3veH.js";import"./plus-DJfFeu4q.js";import"./useComandaWebSocket-DLthfoyN.js";import"./index-CL3SdtP1.js";import"./bell-BP42pcPs.js";import"./trash-2-CxXzmM5w.js";import"./filter-BiXx4-4p.js";import"./gift-XBKin6Vd.js";import"./cloudinaryUpload-vqCefYaz.js";import"./tabs-DLr74N5K.js";import"./zap-BFRB5ZLZ.js";import"./phone-DEvhMYo9.js";import"./eye-CkTGamEz.js";import"./mail-CqIb88cT.js";import"./sun-DNFYo3QJ.js";import"./save-CE2DQko5.js";import"./circle-x-C3c2vtU6.js";import"./circle-check-B4wdpzyW.js";import"./separator-CYlVdodZ.js";import"./circle-help-BqbVHdsR.js";import"./message-square-rxsYttZX.js";import"./arrow-left-nPuylZ-_.js";import"./trending-down-BL8QcX6r.js";import"./truck-BfUKktyx.js";import"./user-SYMNLJbz.js";import"./ColaboradorProfile-hI86Ih0T.js";import"./camera-BlP5SAbE.js";import"./layout-dashboard-DOJuJQFu.js";import"./user-plus-Cpsd25vN.js";import"./smartphone-DTStAEkb.js";import"./thermometer-yqJr1fEX.js";const W="digimenu_80_cooldown_";function R(){const i=new Date;return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`}function Xe(i){try{const o=W+i,f=localStorage.getItem(o),n=R();return f!==n}catch{return!0}}function Ze(i){try{const o=W+i;localStorage.setItem(o,R())}catch{}}function Je({onViewPlans:i,className:o,percentUsed:f,suggestion:n="Dica: Pro libera até 3.000 pedidos/mês."}){const[p,u]=d.useState(!1),l=f??0,x=Xe("orders");if(d.useEffect(()=>{l>=80&&l<100&&x?(u(!0),Ze("orders"),$(B.limit_orders_80_percent,{percent:l})):u(!1)},[l,x]),!p)return null;const w=typeof l=="number"?`Você já usou ${l}% do seu limite de pedidos/mês. ${n}`:F.limit_orders_80.banner;return e.jsxs("div",{role:"alert",className:o||"flex flex-wrap items-center justify-between gap-2 rounded-lg border border-amber-500/40 bg-amber-500/10 dark:bg-amber-500/10 dark:border-amber-500/40 px-3 py-2 text-sm text-foreground dark:text-slate-100",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-amber-600 dark:text-amber-400 shrink-0"}),e.jsx("span",{children:w})]}),e.jsx(j,{variant:"outline",size:"sm",className:"shrink-0",onClick:()=>{$(B.plan_upgrade_clicked,{from:"banner_80",action:"view_plans"}),i?.()},children:F.limit_orders_80.cta})]})}function r(){return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow text-center",children:[e.jsx(U,{className:"w-10 h-10 text-red-500 mx-auto mb-3"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Acesso não permitido"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Esta funcionalidade não está disponível no seu plano atual."})]})})}function Qr(){const i=ee(),[o,f]=se(),n=o.get("tab"),[p,u]=d.useState(()=>n||"dashboard"),[l,x]=d.useState(!1),[w,G]=d.useState(!1),{loading:v,permissions:H,isMaster:m,hasModuleAccess:s,user:t,subscriberData:a,refresh:_}=xe(),{percentUsed:N}=ue();d.useEffect(()=>{!m&&typeof _=="function"&&_()},[]);const c=a?.expires_at?Math.ceil((new Date(a.expires_at).getTime()-Date.now())/(1e3*60*60*24)):null,q=a?.plan?he[a.plan]?.name||a.plan.charAt(0).toUpperCase()+a.plan.slice(1):"",K=a?.expires_at?c!==null&&c<=0?`Expirado em ${O(a.expires_at)}`:`Válido até ${O(a.expires_at)}${c!==null&&c>0?` (${c} dias restantes)`:""}`:"Permanente",{slug:y,subscriberEmail:b,inSlugContext:P}=fe(),C=P&&m&&b?b:void 0;!P||m||(t?.email||"").toLowerCase()===(b||"").toLowerCase()||((t?.subscriber_email||"").toLowerCase(),(b||"").toLowerCase());const{data:Q=[]}=be({queryKey:["store",C??"me"],queryFn:()=>M.entities.Store.list(null,C?{as_subscriber:C}:{})}),h=Q[0];ge(h),d.useEffect(()=>{n&&n!==p&&u(n)},[n]);const k=g=>{u(g),x(!1),f({tab:g},{replace:!0})},D=()=>{M.auth.logout()},S=t?t?.profile_roles?.length?t.profile_roles:t?.profile_role?[t.profile_role]:[]:[],Y=S.length>0&&S.includes("gerente"),X=S.length>0,T=(a?.email||"").toLowerCase().trim(),L=T&&(t?.email||"").toLowerCase().trim()===T,A=!m&&t&&(X&&!L||!L&&T);if(d.useEffect(()=>{!v&&A&&i("/colaborador",{replace:!0})},[v,A,i]),v)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(E,{className:"w-8 h-8 animate-spin text-orange-500"})});if(t&&A)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(E,{className:"w-8 h-8 animate-spin text-orange-500"})});if(!m&&a&&a.status!=="active")return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-md text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(U,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Assinatura Inativa"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Sua assinatura está inativa. Entre em contato para renovar."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("a",{href:"https://wa.me/5586988196114",target:"_blank",rel:"noopener noreferrer",className:"block",children:e.jsx(j,{className:"w-full bg-green-600 hover:bg-green-700",children:"Falar no WhatsApp"})}),e.jsx(re,{to:ae("Cardapio",y||void 0),className:"block",children:e.jsx(j,{variant:"outline",className:"w-full",children:"Ver Cardápio"})}),e.jsxs(j,{variant:"ghost",onClick:D,className:"w-full text-gray-500",children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),"Sair"]})]})]})});const Z=()=>{switch(p){case"dashboard":return e.jsx(I,{user:t,subscriberData:a,onNavigateToTab:k});case"pdv":return s("pdv")?e.jsx("div",{className:"p-8 text-center",children:"Use o botão PDV no header"}):e.jsx(r,{});case"caixa":return s("caixa")?e.jsx(Ue,{}):e.jsx(r,{});case"orders":return s("orders")?e.jsx(Ve,{}):e.jsx(r,{});case"history":return s("history")?e.jsx(Ie,{}):e.jsx(r,{});case"clients":return s("clients")?e.jsx(Oe,{}):e.jsx(r,{});case"financial":return s("financial")?e.jsx(Fe,{}):e.jsx(r,{});case"dishes":case"categories":case"complements":return s("dishes")?e.jsx(Be,{initialTab:p==="categories"?"categories":p==="complements"?"complements":"dishes"}):e.jsx(r,{});case"pizza_config":return s("pizza_config")?e.jsx($e,{}):e.jsx(r,{});case"beverages":return s("dishes")?e.jsx(Ge,{}):e.jsx(r,{});case"inventory":return s("inventory")?e.jsx(Re,{}):e.jsx(r,{});case"delivery_zones":return s("delivery_zones")?e.jsx(ze,{}):e.jsx(r,{});case"coupons":return s("coupons")?e.jsx(Me,{}):e.jsx(r,{});case"promotions":return s("promotions")?e.jsx(Ee,{}):e.jsx(r,{});case"affiliates":return s("affiliates")?e.jsx(We,{}):e.jsx(r,{});case"comandas":return s("comandas")?e.jsx(Le,{subscriberEmail:a?.email||b||t?.subscriber_email||t?.email}):e.jsx(r,{});case"tables":return s("tables")?e.jsx(De,{}):e.jsx(r,{});case"theme":return s("theme")?e.jsx(Pe,{}):e.jsx(r,{});case"store":return s("store")?e.jsx(_e,{}):e.jsx(r,{});case"payments":return s("payments")?e.jsx(Ae,{}):e.jsx(r,{});case"printer":return s("printer")?e.jsx(Te,{}):e.jsx(r,{});case"whatsapp":return s("whatsapp")?e.jsx(Se,{}):e.jsx(r,{});case"colaboradores":return s("colaboradores")?e.jsx(ke,{}):e.jsx(r,{});case"2fa":return s("2fa")?e.jsx(Ce,{user:t}):e.jsx(r,{});case"lgpd":return s("lgpd")?e.jsx(ye,{}):e.jsx(r,{});default:return e.jsx(I,{user:t,subscriberData:a,onNavigateToTab:k})}};return e.jsxs("div",{className:"min-h-screen min-h-screen-mobile bg-background flex flex-col",children:[e.jsx("header",{className:"bg-gradient-to-r from-orange-600 via-orange-500 to-orange-600 text-white flex-shrink-0 sticky top-0 z-50 shadow-lg safe-top",children:e.jsxs("div",{className:"px-2 sm:px-4 py-2 sm:py-3 flex items-center justify-between gap-1 sm:gap-2 max-w-full overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-3 flex-1 min-w-0",children:[e.jsx("button",{onClick:()=>x(!0),className:"lg:hidden min-h-touch min-w-touch flex items-center justify-center p-2 -m-1 hover:bg-white/10 rounded-lg transition flex-shrink-0","aria-label":"Abrir menu",children:e.jsx(qe,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),h?.logo?e.jsxs("div",{className:"w-9 h-9 sm:w-10 sm:h-10 rounded-lg overflow-hidden flex-shrink-0 border-2 border-white/30 shadow-md",children:[e.jsx("img",{src:h.logo,alt:h.name||"Loja",className:"w-full h-full object-cover",onError:g=>{g.target.style.display="none",g.target.nextSibling&&(g.target.nextSibling.style.display="flex")}}),e.jsx("div",{className:"w-full h-full bg-white/20 flex items-center justify-center hidden",children:e.jsx(V,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})})]}):e.jsx("div",{className:"w-9 h-9 sm:w-10 sm:h-10 rounded-lg bg-white/20 flex items-center justify-center flex-shrink-0 border-2 border-white/30",children:e.jsx(V,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-bold text-sm sm:text-base md:text-lg truncate",children:h?.name||"Meu Painel"}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-wrap lg:flex-nowrap",children:[a?.plan&&e.jsxs(z,{className:"bg-white/20 text-white text-[9px] sm:text-[10px] px-1 sm:px-1.5 py-0.5 border-white/30",children:["Plano ",a.plan.charAt(0).toUpperCase()+a.plan.slice(1)]}),c!==null&&e.jsx(z,{className:`text-[9px] sm:text-[10px] px-1 sm:px-1.5 py-0.5 lg:hidden ${c<=7?"bg-red-500/80":"bg-green-500/80"} text-white border-0`,children:c>0?`${c}d restantes`:"Expirado"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 flex-wrap overflow-x-auto scrollbar-hide lg:flex-nowrap lg:overflow-visible",children:[e.jsx(we,{pageName:"Painel",compact:!0}),(h?.id||a?.id)&&e.jsx(ve,{store:h,subscriber:a,compact:!0}),e.jsx(Ne,{isMaster:m,hasGestorAccess:s("orders"),hasModuleAccess:s,slug:y,plan:a?.plan||"basic"}),e.jsxs(te,{children:[e.jsx(ie,{asChild:!0,children:e.jsx(j,{size:"sm",variant:"ghost",className:"text-white hover:bg-white/10 flex min-h-touch min-w-touch",title:"Sair",children:e.jsx(Ke,{className:"w-4 h-4 sm:w-5 sm:h-5"})})}),e.jsxs(oe,{children:[e.jsxs(ne,{children:[e.jsx(le,{children:"Deseja realmente sair?"}),e.jsx(me,{children:"Você precisará fazer login novamente para acessar o painel."})]}),e.jsxs(ce,{children:[e.jsx(de,{children:"Cancelar"}),e.jsx(pe,{onClick:D,className:"bg-red-600 hover:bg-red-700",children:"Sair"})]})]})]})]})]})}),l&&e.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-40",onClick:()=>x(!1)}),e.jsxs("div",{className:"flex flex-1 overflow-x-hidden overflow-y-auto lg:overflow-y-hidden",children:[e.jsx("div",{className:`
            fixed lg:static inset-y-0 left-0 z-40
            transform transition-transform duration-300 ease-in-out
            ${l?"translate-x-0":"-translate-x-full lg:translate-x-0"}
          `,children:e.jsx(je,{activeTab:p,setActiveTab:k,isMaster:m,isGerente:Y,slug:y,permissions:H,plan:a?.plan||"basic",collapsed:w,setCollapsed:G,onClose:()=>x(!1),showStoreLogo:!0})}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-4 lg:p-6 lg:max-w-6xl xl:max-w-7xl lg:mx-auto",children:[!m&&a&&e.jsxs("div",{className:"mb-4 p-3 sm:p-4 rounded-xl bg-card border border-border shadow-sm flex flex-wrap items-center gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-orange-100 dark:bg-orange-900/40",children:e.jsx(Qe,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"Plano ativo"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:q||"—"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 border-l border-gray-200 dark:border-gray-600 pl-3 sm:pl-4",children:[e.jsx(Ye,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"Período"}),e.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-200",children:K})]})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-auto",children:"As ferramentas ao lado são as incluídas no seu plano pelo administrador."})]}),!m&&N?.orders>=80&&N?.orders<100&&e.jsx("div",{className:"mb-4",children:e.jsx(Je,{percentUsed:N.orders,onViewPlans:()=>u("store")})}),Z()]})})]})]})}export{Qr as default};
