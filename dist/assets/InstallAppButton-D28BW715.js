import{r as i,j as r,B as m,X as w}from"./main-BRmc9wuQ.js";import{D as p}from"./download-BLDsYadX.js";function h(e,a){const[l,o]=i.useState(()=>{if(typeof window>"u")return a;try{const t=window.localStorage.getItem(e);return t==null?a:JSON.parse(t)}catch{return a}}),c=i.useCallback(t=>{o(n=>{try{const s=t instanceof Function?t(n):t;return typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(s)),s}catch(s){return console.warn(`[useLocalStorage] Erro ao salvar "${e}":`,s),n}})},[e]);return i.useEffect(()=>{if(typeof window>"u")return;const t=n=>{if(n.key===e&&n.newValue!=null)try{o(JSON.parse(n.newValue))}catch{o(n.newValue)}};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[e]),[l,c]}const f="digimenu_install_dismissed",x=7;function S(){const[e,a]=i.useState(null),[l,o]=i.useState(!1),[c,t]=i.useState(!1);return i.useEffect(()=>{const s=d=>{d.preventDefault(),a(d),t(!0)};window.addEventListener("beforeinstallprompt",s);const u=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");return o(u),()=>window.removeEventListener("beforeinstallprompt",s)},[]),{deferredPrompt:e,isInstalled:l,isSupported:c,install:async()=>{if(!e)return!1;e.prompt();const{outcome:s}=await e.userChoice;return s==="accepted"?(a(null),o(!0),!0):!1}}}function v({pageName:e="App",compact:a=!1}){const{deferredPrompt:l,isInstalled:o,isSupported:c,install:t}=S(),[n,s]=h(f,null),u=n?.until&&Date.now()<n.until,d=()=>{s({until:Date.now()+x*24*60*60*1e3})};return!c||o||u||!l?null:a?r.jsx(m,{variant:"ghost",size:"icon",onClick:t,className:"min-h-touch min-w-touch text-inherit opacity-90 hover:opacity-100 hover:bg-black/5 dark:hover:bg-white/10",title:`Instalar ${e} como app`,"aria-label":`Instalar ${e} como app`,children:r.jsx(p,{className:"w-4 h-4"})}):r.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white/10 backdrop-blur-sm border border-white/20",children:[r.jsxs("span",{className:"text-sm text-white/90 hidden sm:inline",children:["Instalar ",e," como app"]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsxs(m,{size:"sm",variant:"secondary",onClick:t,className:"bg-white/20 hover:bg-white/30 text-white border-0 h-8 text-xs font-medium",children:[r.jsx(p,{className:"w-3.5 h-3.5 mr-1.5"}),"Instalar"]}),r.jsx("button",{onClick:d,className:"p-1.5 rounded hover:bg-white/10 text-white/70 hover:text-white min-h-touch min-w-touch flex items-center justify-center","aria-label":"Ocultar",children:r.jsx(w,{className:"w-4 h-4"})})]})]})}export{v as I,h as u};
