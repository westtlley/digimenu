import{c as et,p as K,r as u,u as He,P as ve,z as B,j as e,X as xe,B as O,R as ds,L as Ps,q as ft,a as tr,s as Ke,t as da,e as Qe,g as Os,f as ts,F as sr,S as ar}from"./main-5wCJ0shd.js";import{b as W}from"./base44Client-BjweZdup.js";import{u as Ae}from"./useQuery-TBRlwA9F.js";import{I as he,L as se}from"./label-BGurCIwA.js";import{e as rr,C as nr,P as ir,t as Be,D as or,a as lr,b as cr,c as We}from"./index-DxdNJ03y.js";import{B as ie}from"./badge-tC6tpDVj.js";import{S as Oe,a as Re,b as De,c as Me,d as de,e as ma}from"./select-D68HeZiV.js";import{u as Ce}from"./useMutation-CfjUJVgq.js";import{C as ws}from"./chef-hat-Tma-MV-q.js";import{C as fe}from"./circle-check-big-C21gM6y_.js";import{T as $e}from"./truck-BfUKktyx.js";import{S as ua}from"./search-C1Oe3veH.js";import{F as xa}from"./filter-BiXx4-4p.js";import{M as dr,a as mr,d as Dt,T as ur}from"./differenceInMinutes-Dz30xM9P.js";import{C as xr,u as hr,a as pr}from"./index-DJsYT-OT.js";import{A as gr}from"./index-BrRbWNqX.js";import{m as Ee}from"./proxy-CaN4jGBq.js";import{B as Pt}from"./bell-BP42pcPs.js";import{C as Le}from"./clock-8p17jiPd.js";import{S as qt,f as ss,a as Rs,u as fr,H as Ds,L as Mt}from"./useDocumentHead-nN5iF5wF.js";import{D as je,a as Ne,c as we,d as Ms,b as xt,e as _s}from"./dialog-BQt4A9EY.js";import{T as dt}from"./textarea-BBItVPmi.js";import{p as Ts,g as $s,f as pe,r as ha,a as br,b as pa,c as yr,i as Xe,T as Ss,d as Ie,L as ke,e as ga,h as ks,j as fa,D as vr,C as jr,k as mt,l as nt,S as Nr,A as wr,m as _r,n as Is,o as Sr,q as it,s as kr,u as Cr,G as Er,t as It,v as Ar,w as ba,x as Pr,y as Tt,z as Ls,B as Or,E as Rr,R as Fs,F as Dr,X as Mr,Y as Tr,H as zs,I as $r,J as Ir,K as Lr,M as Fr,N as zr,O as as,P as Br,Q as qr,U as Kr}from"./LimitBlockModal-CxIjaPQ-.js";import{C as Ct}from"./check-b5qncWl4.js";import{C as Vr}from"./circle-alert-CSoTi2zi.js";import{f as ms,B as _t}from"./format-D5amLcIy.js";import{C as us}from"./circle-x-C3c2vtU6.js";import{P as Et,u as Hr}from"./useManagerialAuth-SxIBd_kH.js";import{M as Ot}from"./message-square-rxsYttZX.js";import{M as qe}from"./map-pin-Cc9ILfAa.js";import{C as Ur}from"./copy-DcaS5Ul6.js";import{Z as Kt}from"./zap-BFRB5ZLZ.js";import{S as Ve}from"./star-BGayr--b.js";import{N as rs}from"./navigation-BASsHeDs.js";import{T as ya}from"./trending-up-8OxCq5vE.js";import{A as va}from"./award-DTiEf67r.js";import{C as Lt}from"./calendar-Bijjub7E.js";import{P as xs}from"./plus-DJfFeu4q.js";import{P as ja}from"./phone-DEvhMYo9.js";import{M as Gr}from"./mail-CqIb88cT.js";import{S as Qr}from"./differenceInCalendarDays-DQNRMz4Z.js";import{S as Te}from"./switch-CiXzU0WK.js";import{u as Wr,c as Yr,a as ot,P as Rt}from"./index-XPl2RJU8.js";import{c as Jr,u as Xr}from"./index-DBH5IvqS.js";import{V as Na}from"./volume-2-tCXURf6C.js";import{P as Zr}from"./play-Cg3R6ahj.js";import{S as en}from"./store-DBfh0a_B.js";import{U as wa}from"./user-SYMNLJbz.js";import{S as Ft}from"./save-CE2DQko5.js";import{T as tn}from"./trash-2-CxXzmM5w.js";import{L as sn}from"./log-out-DCopNCEG.js";import{P as ns}from"./progress-C57mHLoD.js";import{D as At}from"./dollar-sign-BdBkW913.js";import{K as an}from"./keyboard-CBrWP3Ze.js";import{P as rn,a as nn,b as on}from"./popover-BtTeZi4R.js";import{C as ln}from"./credit-card-DjT0Ipnr.js";import{U as cn}from"./UserAuthButton-BbxpONeD.js";import{u as dn}from"./usePermission-CvwVjOfT.js";import{u as mn}from"./useSlugContext-DE6V1uue.js";import{u as un,I as xn}from"./InstallAppButton-D7LO9hfL.js";import"./planLimits-Asbb4bbl.js";import{D as hn}from"./download-DOPNSAwp.js";import{C as Bs}from"./circle-help-BqbVHdsR.js";import{H as pn}from"./headphones-DT9e2T5b.js";import{M as gn}from"./message-circle-CIMJfci3.js";import{M as qs}from"./menu-RhFNat6_.js";import{C as fn}from"./chevron-left-BxOhQUkW.js";import{S as Ks}from"./settings-CVkD5Rnm.js";import"./index-BjH-urEE.js";import"./index-DJGIH_vd.js";import"./chevron-right-CodG0qo6.js";import"./chevron-down-LYt6GC0H.js";import"./constants-CG7Neo-X.js";import"./formatters-CvOEClq0.js";import"./card-co3zywKC.js";import"./shopping-bag-Bd6hIey6.js";import"./alert-dialog-CsqCNnx-.js";import"./log-in-DU8-DLrh.js";import"./power-CLRjBc1X.js";import"./PlanPresets-DhKoJrBx.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],yn=et("ChartNoAxesColumn",bn);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],jn=et("CheckCheck",vn);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],wn=et("Ellipsis",Nn);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Vs=et("Lightbulb",_n);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],kn=et("List",Sn);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],En=et("Map",Cn);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],Pn=et("VolumeX",An),_a=K.createContext({}),Sa=!0;function On({baseColor:t,highlightColor:s,width:a,height:r,borderRadius:n,circle:i,direction:o,duration:c,enableAnimation:m=Sa,customHighlightBackground:x}){const h={};return o==="rtl"&&(h["--animation-direction"]="reverse"),typeof c=="number"&&(h["--animation-duration"]=`${c}s`),m||(h["--pseudo-element-display"]="none"),(typeof a=="string"||typeof a=="number")&&(h.width=a),(typeof r=="string"||typeof r=="number")&&(h.height=r),(typeof n=="string"||typeof n=="number")&&(h.borderRadius=n),i&&(h.borderRadius="50%"),typeof t<"u"&&(h["--base-color"]=t),typeof s<"u"&&(h["--highlight-color"]=s),typeof x=="string"&&(h["--custom-highlight-background"]=x),h}function Nt({count:t=1,wrapper:s,className:a,containerClassName:r,containerTestId:n,circle:i=!1,style:o,...c}){var m,x,h;const l=K.useContext(_a),y={...c};for(const[w,L]of Object.entries(c))typeof L>"u"&&delete y[w];const R={...l,...y,circle:i},k={...o,...On(R)};let v="react-loading-skeleton";a&&(v+=` ${a}`);const g=(m=R.inline)!==null&&m!==void 0?m:!1,E=[],p=Math.ceil(t);for(let w=0;w<p;w++){let L=k;if(p>t&&w===p-1){const M=(x=L.width)!==null&&x!==void 0?x:"100%",S=t%1,P=typeof M=="number"?M*S:`calc(${M} * ${S})`;L={...L,width:P}}const d=K.createElement("span",{className:v,style:L,key:w},"‚Äå");g?E.push(d):E.push(K.createElement(K.Fragment,{key:w},d,K.createElement("br",null)))}return K.createElement("span",{className:r,"data-testid":n,"aria-live":"polite","aria-busy":(h=R.enableAnimation)!==null&&h!==void 0?h:Sa},s?E.map((w,L)=>K.createElement(s,{key:L},w)):E)}function Hs({children:t,...s}){return K.createElement(_a.Provider,{value:s},t)}const is=[{id:"new",label:"Em preparo",icon:ws,bgColor:"bg-orange-50",textColor:"text-orange-600",borderColor:"border-orange-200",statuses:["new","accepted","preparing"],darkBg:"bg-orange-900/20",darkBorder:"border-orange-700"},{id:"ready",label:"Pronto",icon:fe,bgColor:"bg-green-50",textColor:"text-green-600",borderColor:"border-green-200",statuses:["ready","going_to_store","arrived_at_store","picked_up"],darkBg:"bg-green-900/20",darkBorder:"border-green-700"},{id:"delivery",label:"Em rota",icon:$e,bgColor:"bg-blue-50",textColor:"text-blue-600",borderColor:"border-blue-200",statuses:["out_for_delivery","arrived_at_customer"],darkBg:"bg-blue-900/20",darkBorder:"border-blue-700"},{id:"done",label:"Finalizados",icon:ve,bgColor:"bg-gray-50",textColor:"text-gray-600",borderColor:"border-gray-200",statuses:["delivered","cancelled"],darkBg:"bg-gray-900/20",darkBorder:"border-gray-700"}];function Rn({orders:t,onSelectOrder:s,darkMode:a=!1,isLoading:r=!1}){const n=Array.isArray(t)?t:[],[i,o]=u.useState({}),[c,m]=u.useState(""),[x,h]=u.useState("all"),[l,y]=u.useState("all"),[R,k]=u.useState(!1),[v,g]=u.useState(!1),[E,p]=u.useState(()=>Date.now()),[w,L]=u.useState(!1),d=He();u.useEffect(()=>{const _=window.matchMedia("(prefers-reduced-motion: reduce)");L(_.matches);const F=()=>L(_.matches);return _.addEventListener("change",F),()=>_.removeEventListener("change",F)},[]),K.useEffect(()=>{const _=setInterval(()=>p(Date.now()),6e4);return()=>clearInterval(_)},[]);const M=Ce({mutationFn:async({orderId:_,newStatus:F})=>{const U=n.find(G=>String(G.id)===String(_));if(!U)throw new Error("Pedido n√£o encontrado");const te={...U,status:F};return F==="ready"&&(te.ready_at=new Date().toISOString(),U.pickup_code||(te.pickup_code=Math.floor(1e3+Math.random()*9e3).toString()),!U.delivery_code&&U.delivery_method==="delivery"&&(te.delivery_code=Math.floor(1e3+Math.random()*9e3).toString())),F==="delivered"&&(te.delivered_at=new Date().toISOString()),await W.entities.Order.update(_,te),{orderId:_,newStatus:F}},onSuccess:()=>{d.invalidateQueries({queryKey:["gestorOrders"]}),B.success("Status atualizado!")},onError:_=>{B.error(_.message||"Erro ao atualizar pedido")}}),S=_=>{let F=n.filter(U=>_.includes(U.status));return c&&(F=F.filter(U=>U.order_code?.toLowerCase().includes(c.toLowerCase())||U.customer_name?.toLowerCase().includes(c.toLowerCase())||U.customer_phone?.includes(c))),l!=="all"&&(F=F.filter(U=>U.delivery_method===l)),F=[...F].sort((U,te)=>{const G=new Date(U.created_at||U.created_date||0).getTime(),N=new Date(te.created_at||te.created_date||0).getTime();return G-N}),F},P=_=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(_||0),A=_=>{if(!_)return"";const F=Dt(new Date(E),new Date(_));return F<1?"Agora":F<60?`H√° ${F} min`:`H√° ${Math.floor(F/60)}h ${F%60}min`},b=_=>_?.created_at||_?.created_date,D=_=>{const F=b(_);return F?Dt(new Date(E),new Date(F))>30&&!["delivered","cancelled"].includes(_.status):!1},z=_=>{const F=b(_);return F?Dt(new Date(E),new Date(F))>45&&!["delivered","cancelled"].includes(_.status):!1},V=_=>_.accepted_at?Dt(new Date(E),new Date(_.accepted_at)):null,ae=_=>{const F=V(_),U=_.prep_time||30;return F!=null&&F>=U-5&&F<U&&!["delivered","cancelled"].includes(_.status)},Z=_=>{const F=V(_),U=_.prep_time||30;return F!=null&&F>=U&&!["delivered","cancelled"].includes(_.status)},oe=_=>{o(F=>({...F,[_]:!F[_]}))},le=u.useCallback(_=>{const{destination:F,source:U,draggableId:te}=_;if(!F||F.droppableId===U.droppableId&&F.index===U.index)return;const G=is.find(J=>J.id===F.droppableId);if(!G)return;const N=n.find(J=>String(J.id)===String(te));if(!N)return;let j;if(G.id==="new")j=["new","accepted","preparing"].includes(N.status)?N.status:"preparing";else if(G.id==="ready")j="ready";else if(G.id==="delivery")if(N.status==="ready"||N.status==="picked_up")j="out_for_delivery";else{B.error("Pedido precisa estar pronto antes de ir para entrega");return}else if(G.id==="done")if(["out_for_delivery","arrived_at_customer"].includes(N.status))j="delivered";else{B.error("Pedido precisa estar em entrega para ser finalizado");return}else return;const H=d.getQueryData(["gestorOrders"])||[];d.setQueryData(["gestorOrders"],H.map(J=>String(J.id)===String(te)?{...J,status:j}:J)),M.mutate({orderId:te,newStatus:j},{onError:()=>{d.setQueryData(["gestorOrders"],H)}})},[M,t,d]);return r&&n.length===0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border rounded-lg p-4`,children:e.jsxs(Hs,{baseColor:"#ebebeb",highlightColor:"#f5f5f5",children:[e.jsx(Nt,{height:40,className:"mb-3",enableAnimation:!w}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Nt,{width:140,height:36,enableAnimation:!w}),e.jsx(Nt,{width:80,height:36,enableAnimation:!w})]})]})}),e.jsx("div",{className:"flex gap-2.5 h-[calc(100vh-280px)]",children:is.map(_=>e.jsx("div",{className:`flex-1 flex flex-col ${a?"bg-gray-800/50 border-gray-700":"bg-gray-50 border-gray-200"} border rounded-lg p-2`,children:e.jsxs(Hs,{baseColor:"#ebebeb",highlightColor:"#f5f5f5",children:[e.jsx(Nt,{height:36,className:"mb-2",enableAnimation:!w}),e.jsx(Nt,{count:3,height:100,style:{marginBottom:8},enableAnimation:!w})]})},_.id))})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border rounded-lg p-4`,children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(he,{placeholder:"Buscar por c√≥digo, nome ou telefone...",value:c,onChange:_=>m(_.target.value),className:`pl-10 ${a?"bg-gray-700 border-gray-600 text-white":""}`}),c&&e.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(xe,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Oe,{value:l,onValueChange:y,children:[e.jsx(Re,{className:`w-[140px] ${a?"bg-gray-700 border-gray-600":""}`,children:e.jsx(De,{placeholder:"Tipo"})}),e.jsxs(Me,{children:[e.jsx(de,{value:"all",children:"Todos"}),e.jsx(de,{value:"delivery",children:"Entrega"}),e.jsx(de,{value:"pickup",children:"Retirada"})]})]}),e.jsxs(O,{variant:"outline",onClick:()=>k(!R),className:a?"border-gray-600":"",children:[e.jsx(xa,{className:"w-4 h-4 mr-2"}),"Filtros"]}),e.jsx(O,{variant:"outline",size:"sm",onClick:()=>g(_=>!_),className:"h-9",title:v?"Expandir":"Compacto",children:v?e.jsx(dr,{className:"w-4 h-4"}):e.jsx(mr,{className:"w-4 h-4"})})]})]})}),e.jsx(rr,{onDragEnd:le,children:e.jsx("div",{className:"flex gap-2.5 h-[calc(100vh-280px)]",children:is.map(_=>{const F=S(_.statuses),U=_.icon,te=i[_.id];return e.jsxs("div",{className:`${te?"w-10":"flex-1"} transition-all duration-300 flex flex-col ${a?`${_.darkBg} ${_.darkBorder} border`:`${_.bgColor} ${_.borderColor} border`} rounded-lg`,children:[e.jsx("button",{onClick:()=>oe(_.id),className:`border-b p-2.5 flex items-center justify-between hover:opacity-80 transition-opacity ${a?"border-gray-700":"border-gray-200"}`,children:te?e.jsxs("div",{className:"flex flex-col items-center gap-1.5 w-full",children:[e.jsx(U,{className:`w-4 h-4 ${_.textColor}`}),e.jsx("span",{className:`text-[10px] font-bold ${a?"text-gray-300":"text-gray-500"}`,children:F.length})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:`w-4 h-4 ${_.textColor}`}),e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:`font-semibold text-xs ${a?"text-white":"text-gray-700"}`,children:[_.label,_.id==="new"&&F.some(G=>G.status==="new")&&e.jsxs("span",{className:`ml-1 font-medium ${_.textColor}`,children:["¬∑ ",F.filter(G=>G.status==="new").length," novo(s)"]})]}),e.jsxs("p",{className:"text-[10px] text-gray-400",children:[F.length," pedidos"]})]})]}),e.jsx(xr,{className:"w-3.5 h-3.5 text-gray-400"})]})}),!te&&e.jsx(nr,{droppableId:_.id,children:(G,N)=>e.jsxs("div",{ref:G.innerRef,...G.droppableProps,className:`flex-1 overflow-y-auto p-1.5 space-y-1.5 transition-colors ${N.isDraggingOver?a?"bg-gray-700/50":"bg-gray-100/50":""}`,children:[e.jsx(gr,{children:F.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[e.jsx(U,{className:`w-8 h-8 ${_.textColor} opacity-15 mb-1.5`}),e.jsx("p",{className:`text-[10px] ${a?"text-gray-500":"text-gray-400"} leading-relaxed`,children:_.id==="new"?"Nenhum pedido em preparo":_.id==="ready"?"Nenhum pedido pronto":_.id==="delivery"?"Nenhuma entrega em rota":"Nenhum pedido finalizado"})]}):F.map((j,H)=>e.jsx(ir,{draggableId:j.id,index:H,children:(J,re)=>e.jsxs(Ee.div,{ref:J.innerRef,...J.draggableProps,...J.dragHandleProps,initial:{opacity:0,scale:.98},animate:{opacity:re.isDragging?.8:1,scale:re.isDragging?1.05:1},exit:{opacity:0,scale:.98},whileHover:{y:-2},onClick:()=>s(j),className:`${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-md hover:shadow-md transition-all cursor-pointer border-l-2 ${v?"p-1.5":"p-2.5"} ${z(j)||Z(j)?"border-red-600 bg-red-100/50 dark:bg-red-900/30 ring-1 ring-red-300":D(j)?"border-red-500 bg-red-50/30 dark:bg-red-900/20":ae(j)?"border-amber-500 bg-amber-50/50 dark:bg-amber-900/20":j.priority==="alta"?"border-orange-400 dark:border-orange-500":a?"border-gray-600":"border-gray-200"} ${re.isDragging?"shadow-xl":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-1.5",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:`font-semibold text-[11px] ${a?"text-white":"text-gray-900"}`,children:["#",j.order_code||j.id?.slice(-6)]}),(D(j)||Z(j))&&e.jsxs(ie,{className:"bg-red-500 text-white text-[8px] h-3.5 mt-0.5 px-1 flex items-center gap-0.5 w-fit",children:[z(j)&&e.jsx(Pt,{className:"w-2.5 h-2.5"}),"Atrasado"]}),ae(j)&&!Z(j)&&e.jsx(ie,{className:"bg-amber-500 text-white text-[8px] h-3.5 mt-0.5 px-1 flex items-center w-fit",children:"Quase no limite"})]}),e.jsx("span",{className:"text-[11px] flex-shrink-0",title:j.delivery_method==="delivery"?"Entrega":"Retirada",children:j.delivery_method==="delivery"?"üö¥":"üè™"})]}),e.jsx("p",{className:`text-[11px] font-medium ${a?"text-gray-200":"text-gray-700"} mb-1 truncate`,children:j.customer_name}),e.jsxs("p",{className:`text-[10px] ${a?"text-gray-400":"text-gray-500"} mb-1.5 truncate`,children:[(j.items||[]).slice(0,3).map((be,tt)=>`${be.quantity}x ${be.dish?.name||"Item"}`).join(", "),(j.items||[]).length>3&&` +${(j.items||[]).length-3}`]}),e.jsxs("div",{className:`flex items-center justify-between pt-1.5 border-t ${a?"border-gray-700":"border-gray-100"}`,children:[e.jsx("span",{className:`font-bold text-[11px] ${a?"text-green-400":"text-green-600"}`,children:P(j.total)}),e.jsxs("span",{className:`text-[9px] ${a?"text-gray-500":"text-gray-400"} flex items-center gap-0.5`,children:[e.jsx(Le,{className:"w-2.5 h-2.5"}),A(j.created_at||j.created_date)]})]})]})},j.id))}),G.placeholder]})})]},_.id)})})})]})}function Dn({order:t,entregador:s,onClose:a}){const[r,n]=u.useState(""),i=He(),{data:o=[]}=Ae({queryKey:["orderMessages",t.id],queryFn:()=>W.entities.DeliveryMessage.filter({order_id:t.id},"-created_date",50),refetchInterval:3e3}),c=Ce({mutationFn:y=>W.entities.DeliveryMessage.create(y),onSuccess:()=>{i.invalidateQueries({queryKey:["orderMessages",t.id]}),n(""),B.success("Mensagem enviada!")}}),m=["Pedido urgente - priorizar","Cliente aguardando contato","Confirme sua localiza√ß√£o","Retorne √† loja"],x=y=>{c.mutate({entregador_id:t.entregador_id,order_id:t.id,title:"Mensagem do Gestor",message:y,priority:"urgent",type:"order_update"})},h=()=>{r.trim()&&c.mutate({entregador_id:t.entregador_id,order_id:t.id,title:"Mensagem do Gestor",message:r,priority:"normal",type:"order_update"})},l=y=>{const R=new Date,k=new Date(y),v=R-k,g=Math.floor(v/6e4);if(g<1)return"Agora";if(g<60)return`${g}m`;const E=Math.floor(g/60);return E<24?`${E}h`:`${Math.floor(E/24)}d`};return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs(Ee.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[80vh]",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-500 text-white p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Chat com Entregador"}),e.jsx("p",{className:"text-sm opacity-90",children:s?.name||"Entregador"})]}),e.jsx("button",{onClick:a,className:"text-white hover:bg-white/20 p-2 rounded-lg",children:e.jsx(xe,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"bg-white/20 backdrop-blur-sm rounded-lg p-2",children:e.jsxs("p",{className:"text-xs font-semibold",children:["Pedido #",t.order_code]})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50",children:o.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Nenhuma mensagem ainda"})}):o.map(y=>e.jsxs(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`p-3 rounded-xl ${y.status==="pending"?"bg-blue-50 border-2 border-blue-200":"bg-white border border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[y.priority==="urgent"&&e.jsx(ie,{className:"bg-red-500 text-white text-[10px]",children:"üî• Urgente"}),y.status==="pending"&&e.jsx(ie,{className:"bg-green-500 text-white text-[10px]",children:"‚ú® Nova"}),y.status==="read"&&e.jsx(jn,{className:"w-4 h-4 text-blue-500"})]}),e.jsxs("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Le,{className:"w-3 h-3"}),l(y.created_date)]})]}),y.title&&e.jsx("p",{className:"font-bold text-sm mb-1",children:y.title}),e.jsx("p",{className:"text-sm text-gray-700",children:y.message})]},y.id))}),e.jsxs("div",{className:"p-4 bg-white border-t",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-2",children:"RESPOSTAS R√ÅPIDAS:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:m.map((y,R)=>e.jsx("button",{onClick:()=>x(y),disabled:c.isPending,className:"text-xs p-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300 transition-colors text-left disabled:opacity-50",children:y},R))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-2",children:"MENSAGEM PERSONALIZADA:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r,onChange:y=>n(y.target.value),onKeyPress:y=>y.key==="Enter"&&h(),placeholder:"Digite sua mensagem...",disabled:c.isPending,className:"flex-1 px-3 py-2 rounded-lg text-sm bg-gray-50 border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),e.jsx(O,{onClick:h,disabled:!r.trim()||c.isPending,className:"bg-blue-600 hover:bg-blue-700 px-4",children:e.jsx(qt,{className:"w-4 h-4"})})]})]})]})]})})}function Mn({order:t,logs:s=[]}){const a=[{key:"created",label:"Pedido Recebido",icon:ve,date:t.created_date,color:"blue",status:"completed"},{key:"accepted",label:"Pedido Aceito",icon:Ct,date:t.accepted_at,color:"green",status:t.accepted_at?"completed":t.status==="cancelled"?"skipped":"pending"},{key:"preparing",label:"Em Preparo",icon:ws,date:t.status==="preparing"?new Date().toISOString():null,color:"yellow",status:["preparing","ready","out_for_delivery","delivered"].includes(t.status)?"completed":t.status==="cancelled"?"skipped":"pending"},{key:"ready",label:"Pedido Pronto",icon:Le,date:t.ready_at,color:"green",status:t.ready_at?"completed":t.status==="cancelled"?"skipped":"pending"}];t.delivery_method==="delivery"&&a.push({key:"out_for_delivery",label:"Saiu para Entrega",icon:$e,date:t.status==="out_for_delivery"?new Date().toISOString():null,color:"blue",status:["out_for_delivery","delivered"].includes(t.status)?"completed":t.status==="cancelled"?"skipped":"pending"}),a.push({key:"delivered",label:t.delivery_method==="delivery"?"Entregue":"Retirado",icon:Ct,date:t.delivered_at,color:"green",status:t.status==="delivered"?"completed":t.status==="cancelled"?"skipped":"pending"}),t.status==="cancelled"&&a.push({key:"cancelled",label:"Pedido Cancelado",icon:Vr,date:t.updated_date,color:"red",status:"completed",description:t.rejection_reason});const r={completed:"bg-green-500 border-green-500",pending:"bg-gray-200 border-gray-300",skipped:"bg-gray-100 border-gray-200"},n={completed:"text-white",pending:"text-gray-400",skipped:"text-gray-300"};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-700 mb-3",children:"Hist√≥rico do Pedido"}),e.jsx("div",{className:"space-y-3",children:a.map((i,o)=>{const c=i.icon,m=o===a.length-1;return e.jsxs("div",{className:"relative flex gap-3",children:[!m&&e.jsx("div",{className:`absolute left-4 top-10 bottom-0 w-0.5 ${i.status==="completed"?"bg-green-500":"bg-gray-200"}`}),e.jsx("div",{className:`relative z-10 w-8 h-8 rounded-full border-2 flex items-center justify-center flex-shrink-0 ${r[i.status]}`,children:e.jsx(c,{className:`w-4 h-4 ${n[i.status]}`})}),e.jsx("div",{className:"flex-1 pb-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:`font-medium text-sm ${i.status==="completed"?"text-gray-900":"text-gray-500"}`,children:i.label}),i.date&&e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:ms(new Date(i.date),"dd/MM/yyyy '√†s' HH:mm",{locale:Ts})}),i.description&&e.jsx("p",{className:"text-xs text-red-600 mt-1 bg-red-50 px-2 py-1 rounded",children:i.description})]})})})]},i.key)})}),s.length>0&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsx("h4",{className:"font-semibold text-xs text-gray-600 mb-2",children:"Atividades Recentes"}),e.jsx("div",{className:"space-y-2",children:s.slice(0,5).map((i,o)=>e.jsxs("div",{className:"text-xs text-gray-500 flex items-start gap-2",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-gray-400 mt-1.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{children:i.action}),e.jsxs("p",{className:"text-gray-400",children:[ms(new Date(i.created_date),"dd/MM/yyyy HH:mm",{locale:Ts}),i.user_email&&` - ${i.user_email}`]})]})]},o))})]})]})}const Tn={pix:"PIX",dinheiro:"Dinheiro",cartao_credito:"Cart√£o de Cr√©dito",cartao_debito:"Cart√£o de D√©bito"},$n=["Loja fechada","Produto indispon√≠vel","Problema no endere√ßo","√Årea fora de cobertura","Pedido duplicado","Outro motivo"];function In({order:t,entregadores:s,onClose:a,onUpdate:r,user:n,asSub:i,suggestedPrepTime:o=30,quickStatusKey:c,onClearQuickStatus:m,onViewMap:x,onDuplicate:h,onAddToPrintQueue:l}){const[y,R]=u.useState(!1),[k,v]=u.useState(!1),[g,E]=u.useState(!1),[p,w]=u.useState(""),[L,d]=u.useState(""),[M,S]=u.useState(""),[P,A]=u.useState(!1),[b,D]=u.useState(""),[z,V]=u.useState(t.prep_time||o||30),[ae,Z]=u.useState(!1),[oe,le]=u.useState(!1),[ee,_]=u.useState(t.internal_notes||""),[F,U]=u.useState(t.priority||"normal"),te=(()=>{try{return JSON.parse(localStorage.getItem("gestorSettings")||"{}").can_alter_prep_per_order!==!1}catch{return!0}})(),G=He();K.useEffect(()=>{if(!c||j.isPending)return;(()=>{if(c==="accepted"&&t.status==="new"){const q=te?z:o||30;j.mutate({id:t.id,updates:{status:"accepted",accepted_at:new Date().toISOString(),prep_time:q}},{onSuccess:()=>m?.()});return}if(c==="ready"&&["accepted","preparing"].includes(t.status)){const q={status:"ready",ready_at:new Date().toISOString()};t.pickup_code||(q.pickup_code=Math.floor(1e3+Math.random()*9e3).toString()),!t.delivery_code&&t.delivery_method==="delivery"&&(q.delivery_code=Math.floor(1e3+Math.random()*9e3).toString()),j.mutate({id:t.id,updates:q},{onSuccess:()=>m?.()});return}if(c==="out_for_delivery"&&["ready","picked_up"].includes(t.status)){j.mutate({id:t.id,updates:{status:"out_for_delivery"}},{onSuccess:()=>m?.()});return}if(c==="delivered"&&["ready","out_for_delivery","arrived_at_customer"].includes(t.status)){j.mutate({id:t.id,updates:{status:"delivered",delivered_at:new Date().toISOString()}},{onSuccess:()=>m?.()});return}m?.()})()},[c]);const{data:N=[]}=Ae({queryKey:["orderLogs",t.id],queryFn:()=>W.entities.OrderLog.filter({order_id:t.id},"-created_date"),enabled:!!t.id}),j=Ce({mutationFn:async({id:f,updates:q})=>{if(q.status==="accepted"&&t.status!=="new")throw new Error("Apenas pedidos novos podem ser aceitos");if(q.status==="cancelled"&&!["new","accepted"].includes(t.status))throw new Error("Pedidos em andamento n√£o podem ser cancelados");if(q.status==="accepted"&&(!q.prep_time||q.prep_time<5))throw new Error("Tempo de preparo deve ser no m√≠nimo 5 minutos");q.status==="ready"&&(t.pickup_code||(q.pickup_code=Math.floor(1e3+Math.random()*9e3).toString()),!t.delivery_code&&t.delivery_method==="delivery"&&(q.delivery_code=Math.floor(1e3+Math.random()*9e3).toString()));const Q={...t,...q},C=i?{as_subscriber:i}:{},$=await W.entities.Order.update(f,Q,C);try{await W.entities.OrderLog.create({order_id:f,action:`Status alterado para ${q.status}`,old_status:t.status,new_status:q.status,user_email:n?.email,details:q.rejection_reason||null,...i&&{as_subscriber:i}})}catch(_e){console.log("Log error:",_e)}return{status:q.status,order:$||Q}},onSuccess:f=>{const q=f?.status;G.invalidateQueries({queryKey:["gestorOrders"]}),G.invalidateQueries({queryKey:["orderLogs",t.id]});const Q=new Audio("https://assets.mixkit.co/active_storage/sfx/2018/2018-preview.mp3");Q.volume=.5,Q.play().catch(()=>{});const C={accepted:"‚úÖ Pedido aceito!",preparing:"üë®‚Äçüç≥ Em preparo!",ready:"‚úÖ Pronto!",out_for_delivery:"üöö Saiu para entrega!",delivered:"‚úÖ Entregue!",cancelled:"‚ùå Cancelado"};C[q]&&B.success(C[q]),r(f?.order)},onError:f=>{console.error("Update error:",f);const q=f.message||"Erro ao atualizar pedido. Tente novamente.";B.error(q)}}),H=f=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(f||0),J=async()=>{if(j.isPending)return;const f=te?z:o||30;if(!f||f<5||f>180){B.error("Tempo de preparo deve ser entre 5 e 180 minutos");return}if(t.status!=="new"){B.error("Este pedido j√° foi processado");return}j.mutate({id:t.id,updates:{status:"accepted",accepted_at:new Date().toISOString(),prep_time:f}})},re=()=>{const q={accepted:"preparing",preparing:"ready",ready:t.delivery_method==="delivery"?"ready":"delivered",out_for_delivery:"delivered"}[t.status];if(!q)return;const Q={status:q};q==="ready"&&(Q.ready_at=new Date().toISOString()),q==="delivered"&&(Q.delivered_at=new Date().toISOString()),j.mutate({id:t.id,updates:Q})},be=async()=>{if(j.isPending)return;if(!["new","accepted"].includes(t.status)){B.error("Este pedido n√£o pode mais ser cancelado");return}if(!L){B.error("Selecione um motivo para rejeitar o pedido");return}const f=L==="Outro motivo"?M.trim():L;if(L==="Outro motivo"&&!M.trim()){A(!0),B.error("Descreva o motivo da rejei√ß√£o");return}if(f.length<5){L==="Outro motivo"&&A(!0),B.error("Motivo muito curto. M√≠nimo de 5 caracteres");return}A(!1),j.mutate({id:t.id,updates:{status:"cancelled",rejection_reason:f}}),R(!1),d(""),S(""),A(!1)},tt=async()=>{if(j.isPending)return;if(!b){B.error("Selecione um entregador");return}const f=s.find(q=>q.id===b);if(!f){B.error("Entregador n√£o encontrado");return}if(f.status!=="available"){B.error("Entregador n√£o est√° dispon√≠vel");return}try{const Q=(await W.entities.Store.list())[0],C=s.find(_e=>_e.id===b),$={status:"going_to_store",entregador_id:b,store_latitude:Q?.store_latitude||-5.0892,store_longitude:Q?.store_longitude||-42.8019};if(t.pickup_code||($.pickup_code=Math.floor(1e3+Math.random()*9e3).toString()),t.delivery_code||($.delivery_code=Math.floor(1e3+Math.random()*9e3).toString()),j.mutate({id:t.id,updates:$}),C){const _e=i?{as_subscriber:i}:{};await W.entities.Entregador.update(b,{...C,current_order_id:t.id,status:"busy"},_e)}v(!1),B.success(`Entregador ${C.name} est√° indo buscar o pedido`)}catch(q){console.error("Assign delivery error:",q),B.error("Erro ao atribuir entregador")}},st=async()=>{try{const f=i?{as_subscriber:i}:{};await W.entities.Order.update(t.id,{...t,customer_change_status:"approved"},f),G.invalidateQueries({queryKey:["gestorOrders"]}),B.success("Altera√ß√£o do cliente aceita."),r()}catch(f){B.error(f?.message||"Erro ao aceitar altera√ß√£o.")}},yt=async()=>{const f=(p||"").trim();if(f.length<3){B.error("Informe um breve motivo da reprova√ß√£o (m√≠n. 3 caracteres).");return}try{const q=i?{as_subscriber:i}:{};await W.entities.Order.update(t.id,{...t,customer_change_status:"rejected",customer_change_response:f},q),G.invalidateQueries({queryKey:["gestorOrders"]}),B.success("Altera√ß√£o reprovada."),E(!1),w(""),r()}catch(q){B.error(q?.message||"Erro ao reprovar altera√ß√£o.")}},vt=()=>{try{const f=window.open("","_blank");if(!f){B.error("Popup bloqueado! Permita popups para imprimir.");return}const q={pix:"PIX",dinheiro:"Dinheiro",cartao_credito:"Cart√£o de Cr√©dito",cartao_debito:"Cart√£o de D√©bito"}[t.payment_method]||t.payment_method;let Q="";(t.items||[]).forEach((C,$)=>{const _e=C.dish?.product_type==="pizza",Y=C.size||C.selections?.size,Ue=C.flavors||C.selections?.flavors,rt=C.edge||C.selections?.edge,ze=C.extras||C.selections?.extras;if(Q+='<div style="margin-bottom: 12px; border-left: 3px solid #666; padding-left: 8px;">',Q+=`<p style="margin: 0; font-weight: bold;">#${$+1} - ${C.dish?.name} x${C.quantity||1}</p>`,_e&&Y){if(Q+=`<p style="margin: 4px 0 0 12px; font-size: 10px; font-weight: bold;">üçï ${Y.name} (${Y.slices||""} fatias ‚Ä¢ ${Ue?.length||0} sabores)</p>`,Ue&&Ue.length>0){Q+='<p style="margin: 2px 0 0 12px; font-size: 10px;">Sabores:</p>';const Se=Ue.reduce((ue,Ge)=>(ue[Ge.name]=(ue[Ge.name]||0)+1,ue),{});Object.entries(Se).forEach(([ue,Ge])=>{Q+=`<p style="margin: 2px 0; font-size: 10px; margin-left: 24px;">  ‚Ä¢ ${Ge}/${Y.slices||""} ${ue}</p>`})}rt&&(Q+=`<p style="margin: 2px 0; font-size: 10px; margin-left: 12px;">üßÄ Borda: ${rt.name}</p>`),ze&&ze.length>0&&(Q+='<p style="margin: 2px 0; font-size: 10px; margin-left: 12px;">Extras:</p>',ze.forEach(Se=>{Q+=`<p style="margin: 2px 0; font-size: 10px; margin-left: 24px;">  ‚Ä¢ ${Se.name}</p>`})),C.specifications&&(Q+=`<p style="margin: 2px 0; font-size: 10px; margin-left: 12px; font-style: italic;">üìù ${C.specifications}</p>`)}else C.selections&&Object.keys(C.selections).length>0&&Object.values(C.selections).forEach(Se=>{Array.isArray(Se)?Se.forEach(ue=>{Q+=`<p style="margin: 2px 0; font-size: 10px; margin-left: 12px;">  ‚Ä¢ ${ue.name}</p>`}):Se&&(Q+=`<p style="margin: 2px 0; font-size: 10px; margin-left: 12px;">  ‚Ä¢ ${Se.name}</p>`)});C.observations&&(Q+=`<p style="margin: 2px 0; font-size: 10px; margin-left: 12px; font-style: italic;">üìù ${C.observations}</p>`),Q+=`<p style="margin: 4px 0 0 0;">Valor: ${H(C.totalPrice*(C.quantity||1))}</p>`,Q+="</div>"}),f.document.open(),f.document.write(`
      <html>
        <head>
          <title>Comanda #${t.order_code||t.id?.slice(-6).toUpperCase()}</title>
          <style>
            body {
              font-family: 'Courier New', monospace;
              font-size: 11px;
              line-height: 1.35;
              padding: 10mm;
              margin: 0;
              max-width: 80mm;
              word-wrap: break-word;
              overflow-wrap: break-word;
              word-break: break-word;
            }
            p, div { word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; }
            h1 {
              text-align: center;
              font-size: 16px;
              margin: 0 0 5px 0;
            }
            .header {
              text-align: center;
              margin-bottom: 10px;
              padding-bottom: 10px;
              border-bottom: 2px dashed #000;
            }
            .section {
              margin: 10px 0;
            }
            .total {
              border-top: 2px solid #000;
              margin-top: 10px;
              padding-top: 10px;
              font-weight: bold;
              font-size: 14px;
            }
            .code-box {
              background: #fff3cd;
              border: 2px solid #ff9800;
              padding: 10px;
              margin: 10px 0;
              text-align: center;
            }
            .code-box .code {
              font-size: 24px;
              font-weight: bold;
              letter-spacing: 5px;
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>COMANDA</h1>
            <p style="margin: 0;">Pedido #${t.order_code||t.id?.slice(-6).toUpperCase()}</p>
            <p style="margin: 0; font-size: 11px;">${t.created_at||t.created_date?ss(t.created_at||t.created_date):"‚Äî"}</p>
          </div>
          
          <div class="section">
            <p style="margin: 0;"><strong>Cliente:</strong> ${t.customer_name||""}</p>
            <p style="margin: 0;"><strong>Contato:</strong> ${t.customer_phone||""}</p>
            <p style="margin: 0;"><strong>Tipo:</strong> ${t.delivery_method==="delivery"?"Entrega üö¥":"Retirada üè™"}</p>
            ${$s(t)||t.address?`<p style="margin: 0;"><strong>Endere√ßo:</strong> ${$s(t)||t.address||""}</p>`:""}
            <p style="margin: 0;"><strong>Pagamento:</strong> ${q}</p>
            ${t.payment_method==="dinheiro"&&t.needs_change&&t.change_amount?`<p style="margin: 0; color: #ff6600;"><strong>Troco para:</strong> ${H(t.change_amount)} (Troco: ${H(t.change_amount-t.total)})</p>`:""}
            ${t.scheduled_date&&t.scheduled_time?`<p style="margin: 0; color: #0066cc; font-weight: bold;">‚è∞ AGENDADO: ${Rs(t.scheduled_date,t.scheduled_time)}</p>`:""}
            ${t.customer_change_request?`<p style="margin: 4px 0 0 0; padding: 6px; background: #fef3c7; border: 1px solid #f59e0b; border-radius: 4px;"><strong>‚úèÔ∏è Altera√ß√£o/adicional:</strong> ${t.customer_change_request}${t.customer_change_status==="approved"?' <span style="color:green;">(Aceito)</span>':t.customer_change_status==="rejected"?' <span style="color:red;">(Reprovado)</span>':' <span style="color:#b45309;">(Pendente)</span>'}</p>`:""}
          </div>


          
          <div class="section">
            <p style="margin: 0; font-weight: bold; border-bottom: 1px solid #000; padding-bottom: 5px;">--- Pedido ---</p>
            ${Q}
          </div>
          
          <div class="total">
            <p style="margin: 0;">Subtotal itens: ${H(t.subtotal)}</p>
            ${t.delivery_fee>0?`<p style="margin: 0;">Taxa de entrega: ${H(t.delivery_fee)}</p>`:""}
            ${t.discount>0?`<p style="margin: 0; color: green;">Desconto: -${H(t.discount)}</p>`:""}
            <p style="margin: 5px 0 0 0; font-size: 16px;">TOTAL: ${H(t.total)}</p>
          </div>

          <div style="text-align: center; margin-top: 15px; font-size: 10px; color: #666;">
            Enviado em ${t.created_at||t.created_date?ss(t.created_at||t.created_date):"‚Äî"}
          </div>
        </body>
      </html>
    `),f.document.close(),f.focus(),setTimeout(()=>{try{f.print(),B.success("Comanda enviada para impress√£o!")}catch(C){console.error("Erro ao imprimir:",C),B.error("Erro ao imprimir. Verifique se popups est√£o permitidos.")}},350)}catch(f){console.error("Erro ao imprimir:",f),B.error("Erro ao imprimir. Verifique se popups est√£o permitidos.")}},at=s.filter(f=>f.status==="available");return e.jsxs(e.Fragment,{children:[e.jsx(je,{open:!0,onOpenChange:a,children:e.jsxs(Ne,{className:"max-w-md max-h-[85vh] overflow-y-auto p-0","aria-describedby":void 0,children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-600 to-orange-500 text-white p-4 z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(we,{className:"font-bold text-lg text-white",children:"COMANDA"}),e.jsxs("p",{className:"text-sm opacity-90",children:["Pedido #",t.order_code||t.id?.slice(-6).toUpperCase()]}),e.jsx("p",{className:"text-xs opacity-75",children:t.created_at||t.created_date?ss(t.created_at||t.created_date):"‚Äî"})]}),e.jsx("button",{onClick:a,className:"text-white",children:e.jsx(xe,{className:"w-5 h-5"})})]}),["ready","going_to_store","arrived_at_store","picked_up"].includes(t.status)&&t.pickup_code&&e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm border-2 border-white/50 rounded-xl p-3 text-center mt-3",children:[e.jsx("p",{className:"text-xs font-semibold mb-1",children:t.status==="picked_up"?"‚úÖ C√≥digo Validado":"C√≥digo de Retirada"}),e.jsx("p",{className:"text-4xl font-bold tracking-widest",children:t.pickup_code}),e.jsx("p",{className:"text-[10px] opacity-90 mt-1",children:t.status==="picked_up"?"Pedido coletado":t.status==="ready"?"Pronto para coleta":"Forne√ßa ao entregador"})]})]}),e.jsxs("div",{className:"p-4 space-y-3 text-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-bold text-base",children:t.customer_name}),e.jsx("p",{className:"text-xs text-gray-600",children:t.customer_phone}),t.delivery_method==="delivery"&&t.address&&e.jsxs("p",{className:"text-xs text-gray-600",children:["üìç ",t.address]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(ie,{variant:"outline",className:"text-xs",children:t.delivery_method==="delivery"?"üö¥ Entrega":"üè™ Retirada"}),e.jsx(ie,{variant:"outline",className:"text-xs",children:Tn[t.payment_method]||t.payment_method})]}),t.scheduled_date&&t.scheduled_time&&e.jsxs("p",{className:"text-xs text-blue-600 font-bold bg-blue-50 p-2 rounded",children:["‚è∞ AGENDADO: ",Rs(t.scheduled_date,t.scheduled_time)]})]}),t.customer_change_request&&e.jsxs("div",{className:`rounded-lg p-3 border ${t.customer_change_status==="approved"?"bg-green-50 border-green-200":t.customer_change_status==="rejected"?"bg-red-50 border-red-200":"bg-amber-50 border-amber-200"}`,children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-1",children:"‚úèÔ∏è Solicita√ß√£o do cliente"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.customer_change_request}),(!t.customer_change_status||t.customer_change_status==="pending")&&e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs(O,{size:"sm",onClick:st,className:"rounded bg-green-600 hover:bg-green-700 uppercase font-bold transition-all duration-100",children:[e.jsx(Ct,{className:"w-3.5 h-3.5 mr-1"})," Aceitar"]}),e.jsxs(O,{size:"sm",variant:"outline",onClick:()=>E(!0),className:"rounded border-red-300 text-red-600 hover:bg-red-50 uppercase font-bold transition-all duration-100",children:[e.jsx(us,{className:"w-3.5 h-3.5 mr-1"})," Reprovar"]})]}),t.customer_change_status==="approved"&&e.jsx(ie,{className:"mt-2 bg-green-600",children:"Altera√ß√£o aceita"}),t.customer_change_status==="rejected"&&e.jsxs("div",{className:"mt-2",children:[e.jsx(ie,{variant:"outline",className:"border-red-300 text-red-700",children:"Reprovada"}),t.customer_change_response&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Motivo: ",t.customer_change_response]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600 block mb-1",children:"Notas internas"}),e.jsx(dt,{value:ee,onChange:f=>_(f.target.value),placeholder:"S√≥ voc√™ v√™",rows:2,className:"resize-none text-sm focus:border-gray-800 focus:ring-1 focus:ring-gray-800/20 focus:outline-none"}),e.jsx(O,{type:"button",size:"sm",variant:"ghost",className:"mt-1 h-7 text-xs",onClick:()=>j.mutate({id:t.id,updates:{internal_notes:ee}}),disabled:j.isPending,children:"Salvar notas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Prioridade:"}),e.jsxs("select",{value:F,onChange:f=>{const q=f.target.value;U(q),j.mutate({id:t.id,updates:{priority:q}})},className:"border rounded px-2 py-1 text-xs focus:border-gray-800 focus:ring-1 focus:ring-gray-800/20 focus:outline-none",children:[e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"alta",children:"Alta"}),e.jsx("option",{value:"baixa",children:"Baixa"})]})]})]}),e.jsxs(O,{variant:"outline",size:"sm",onClick:()=>Z(!ae),className:"w-full",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),ae?"Ocultar Hist√≥rico":"Ver Hist√≥rico do Pedido"]}),ae&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsx(Mn,{order:t,logs:N})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"font-bold mb-2 text-xs text-gray-500",children:"ITENS DO PEDIDO"}),e.jsx("div",{className:"space-y-3",children:(t.items||[]).map((f,q)=>{const Q=f.dish?.product_type==="pizza";return e.jsxs("div",{className:"border-l-2 border-gray-300 pl-2",children:[e.jsxs("p",{className:"font-bold text-sm",children:[f.quantity||1,"x ",f.dish?.name]}),Q&&f.size&&e.jsxs("div",{className:"ml-2 text-xs mt-1 space-y-1",children:[e.jsxs("p",{className:"font-semibold text-gray-700",children:["üçï ",f.size.name," (",f.size.slices," fatias ‚Ä¢ ",f.flavors?.length||0," sabores)"]}),f.flavors&&f.flavors.length>0&&e.jsxs("div",{className:"ml-2",children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Sabores:"}),Object.entries(f.flavors.reduce((C,$)=>(C[$.name]=(C[$.name]||0)+1,C),{})).map(([C,$])=>e.jsxs("p",{className:"ml-2 text-gray-600",children:["‚Ä¢ ",$,"/",f.size.slices," ",C]},C))]}),f.edge&&e.jsxs("p",{className:"font-medium text-gray-600 ml-2",children:["üßÄ Borda: ",f.edge.name]}),f.extras&&f.extras.length>0&&e.jsxs("div",{className:"ml-2",children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Extras:"}),f.extras.map((C,$)=>e.jsxs("p",{className:"ml-2 text-gray-600",children:["‚Ä¢ ",C.name]},$))]}),f.specifications&&e.jsxs("p",{className:"text-gray-600 ml-2 italic",children:["üìù ",f.specifications]})]}),!Q&&f.selections&&Object.keys(f.selections).length>0&&e.jsx("div",{className:"ml-2 text-xs text-gray-600 mt-1 space-y-0.5",children:Object.entries(f.selections).map(([C,$])=>Array.isArray($)?$.map((_e,Y)=>e.jsxs("p",{children:["‚Ä¢ ",_e.name]},Y)):$?e.jsxs("p",{children:["‚Ä¢ ",$.name]},C):null)}),f.observations&&e.jsxs("p",{className:"ml-2 text-xs text-gray-600 italic mt-1",children:["üìù ",f.observations]}),e.jsx("p",{className:"font-semibold text-sm text-green-700 mt-1",children:H(f.totalPrice*(f.quantity||1))})]},q)})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg p-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:H(t.subtotal)})]}),t.delivery_fee>0&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Taxa de entrega"}),e.jsx("span",{children:H(t.delivery_fee)})]}),t.discount>0&&e.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[e.jsx("span",{children:"Desconto"}),e.jsxs("span",{children:["-",H(t.discount)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-base pt-2 border-t",children:[e.jsx("span",{children:"TOTAL"}),e.jsx("span",{className:"text-green-600",children:H(t.total)})]})]})]}),e.jsx("div",{className:"p-4 border-t bg-gray-50 space-y-2",children:e.jsxs("div",{className:"space-y-2",children:[t.status==="new"&&e.jsxs(e.Fragment,{children:[te&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 bg-white p-2 rounded border flex-wrap",children:[e.jsx(ur,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-xs",children:"Tempo de preparo:"}),e.jsx("select",{value:z,onChange:f=>V(parseInt(f.target.value)),className:"border rounded px-2 py-1 text-xs font-medium min-h-[52px] focus:border-gray-800 focus:ring-1 focus:ring-gray-800/20 focus:outline-none",children:[10,15,20,25,30,40,45,60,90].map(f=>e.jsxs("option",{value:f,children:[f," min"]},f))}),o&&o!==z&&e.jsxs("button",{type:"button",onClick:()=>V(o),className:"text-[10px] text-blue-600 underline",children:["Sugerido: ",o,"min"]})]}),!te&&e.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Tempo de preparo: ",o||30," min (padr√£o)"]}),e.jsx(O,{onClick:J,className:"rounded w-full bg-green-600 hover:bg-green-700 h-12 font-bold uppercase disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-100",disabled:j.isPending,children:j.isPending?e.jsxs(e.Fragment,{children:[e.jsx(ds,{className:"w-5 h-5 mr-2 animate-spin"})," Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ct,{className:"w-5 h-5 mr-2"})," Aceitar Pedido"]})}),e.jsxs(O,{onClick:()=>R(!0),variant:"outline",className:"rounded w-full border-red-300 text-red-600 hover:bg-red-50 h-10 uppercase font-bold transition-all duration-100",disabled:j.isPending,children:[e.jsx(us,{className:"w-4 h-4 mr-2"})," Rejeitar"]})]}),t.status==="accepted"&&e.jsxs(O,{onClick:re,className:"rounded w-full bg-yellow-600 hover:bg-yellow-700 h-12 font-semibold transition-all duration-100",children:[e.jsx(ws,{className:"w-5 h-5 mr-2"})," Iniciar Preparo"]}),t.status==="preparing"&&e.jsxs(O,{onClick:re,className:"rounded w-full bg-green-600 hover:bg-green-700 h-12 font-semibold transition-all duration-100",children:[e.jsx(fe,{className:"w-5 h-5 mr-2"})," Marcar como Pronto"]}),t.status==="ready"&&t.delivery_method==="delivery"&&e.jsxs(O,{onClick:()=>v(!0),className:"rounded w-full bg-blue-600 hover:bg-blue-700 h-12 font-semibold transition-all duration-100",children:[e.jsx($e,{className:"w-5 h-5 mr-2"})," Chamar Entregador"]}),t.status==="ready"&&t.delivery_method==="pickup"&&e.jsxs(O,{onClick:re,className:"rounded w-full bg-green-600 hover:bg-green-700 h-12 font-semibold transition-all duration-100",children:[e.jsx(fe,{className:"w-5 h-5 mr-2"})," Marcar como Entregue"]}),t.status==="out_for_delivery"&&e.jsxs(e.Fragment,{children:[t.entregador_id&&e.jsxs(O,{onClick:()=>le(!0),variant:"outline",className:"w-full border-blue-500 text-blue-600 hover:bg-blue-50 h-10 font-medium mb-2",children:[e.jsx(qt,{className:"w-4 h-4 mr-2"})," Enviar Mensagem ao Entregador"]}),e.jsxs(O,{onClick:re,className:"rounded w-full bg-green-600 hover:bg-green-700 h-12 font-semibold transition-all duration-100",children:[e.jsx(fe,{className:"w-5 h-5 mr-2"})," Confirmar Entrega"]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2 pt-2 border-t border-gray-200",children:[e.jsx(O,{size:"sm",variant:t.status==="new"?"default":"outline",className:"min-h-touch bg-green-600 hover:bg-green-700 text-white border-0",disabled:t.status!=="new"||j.isPending,onClick:()=>{const f=te?z:o||30;j.mutate({id:t.id,updates:{status:"accepted",accepted_at:new Date().toISOString(),prep_time:f}})},children:"Aceitar"}),e.jsx(O,{size:"sm",variant:["accepted","preparing"].includes(t.status)?"default":"outline",className:"min-h-touch bg-yellow-600 hover:bg-yellow-700 text-white border-0",disabled:!["accepted","preparing"].includes(t.status)||j.isPending,onClick:()=>j.mutate({id:t.id,updates:{status:"preparing"}}),children:"Preparo"}),e.jsx(O,{size:"sm",variant:t.status==="ready"?"default":"outline",className:"min-h-touch bg-emerald-600 hover:bg-emerald-700 text-white border-0",disabled:!["accepted","preparing"].includes(t.status)||j.isPending,onClick:()=>{const f={status:"ready",ready_at:new Date().toISOString()};t.pickup_code||(f.pickup_code=Math.floor(1e3+Math.random()*9e3).toString()),!t.delivery_code&&t.delivery_method==="delivery"&&(f.delivery_code=Math.floor(1e3+Math.random()*9e3).toString()),j.mutate({id:t.id,updates:f})},children:"Pronto"}),e.jsx(O,{size:"sm",variant:t.status==="out_for_delivery"?"default":"outline",className:"min-h-touch bg-blue-600 hover:bg-blue-700 text-white border-0",disabled:!["ready","picked_up"].includes(t.status)||j.isPending,onClick:()=>j.mutate({id:t.id,updates:{status:"out_for_delivery"}}),children:"Saiu"}),e.jsx(O,{size:"sm",variant:t.status==="delivered"?"default":"outline",className:"min-h-touch bg-gray-700 hover:bg-gray-800 text-white border-0",disabled:!["ready","out_for_delivery","arrived_at_customer"].includes(t.status)||j.isPending,onClick:()=>j.mutate({id:t.id,updates:{status:"delivered",delivered_at:new Date().toISOString()}}),children:"Entregue"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(O,{onClick:vt,variant:"outline",size:"sm",className:"rounded uppercase font-bold transition-all duration-100 min-h-touch",children:[e.jsx(Et,{className:"w-4 h-4 mr-1"})," Imprimir"]}),l&&e.jsxs(O,{onClick:l,variant:"outline",size:"sm",children:[e.jsx(Et,{className:"w-4 h-4 mr-1"})," Na fila"]}),t.customer_phone&&e.jsxs(e.Fragment,{children:[e.jsxs(O,{variant:"outline",size:"sm",onClick:()=>{const f=t.customer_phone?.replace(/\D/g,""),q=`Ol√°! Seu pedido #${t.order_code||t.id} est√°: ${t.status}.`;window.open(`https://wa.me/55${f}?text=${encodeURIComponent(q)}`,"_blank")},children:[e.jsx(qt,{className:"w-4 h-4 mr-1"})," Enviar status"]}),e.jsxs(O,{variant:"outline",size:"sm",onClick:()=>window.open(`https://wa.me/55${t.customer_phone?.replace(/\D/g,"")}`,"_blank"),children:[e.jsx(Ot,{className:"w-4 h-4 mr-1"})," WhatsApp"]})]}),x&&t.delivery_method==="delivery"&&t.address&&e.jsxs(O,{onClick:x,variant:"outline",size:"sm",children:[e.jsx(qe,{className:"w-4 h-4 mr-1"})," Ver no mapa"]}),h&&e.jsxs(O,{onClick:()=>h(t),variant:"outline",size:"sm",children:[e.jsx(Ur,{className:"w-4 h-4 mr-1"})," Duplicar"]})]}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"1‚Äì4: atalhos de status | Esc: fechar"})]})})]})}),e.jsx(je,{open:y,onOpenChange:R,children:e.jsx(Ne,{className:"max-w-sm",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(we,{className:"font-bold text-lg text-red-600",children:"‚ö†Ô∏è Rejeitar Pedido"}),e.jsx(Ms,{className:"text-sm text-gray-600",children:"Tem certeza? Selecione o motivo da rejei√ß√£o. Esta a√ß√£o n√£o pode ser desfeita."}),e.jsx("div",{className:"space-y-2",children:$n.map(f=>e.jsx("button",{onClick:()=>d(f),className:`w-full p-3 rounded-lg border-2 text-left text-sm transition-colors ${L===f?"border-red-500 bg-red-50 font-medium":"border-gray-200 hover:border-gray-300"}`,children:f},f))}),L==="Outro motivo"&&e.jsxs("div",{children:[e.jsx("label",{className:`text-sm font-medium mb-2 block ${P?"text-red-500":"text-gray-700"}`,children:"Descreva o motivo *"}),e.jsx(dt,{value:M,onChange:f=>{S(f.target.value),A(!1)},placeholder:"Ex: Cliente solicitou cancelamento...",rows:3,className:`resize-none min-h-[52px] focus:outline-none focus:ring-1 focus:ring-gray-800/20 focus:border-gray-800 ${P?"border-2 border-red-500":""}`}),e.jsx("p",{className:`text-xs mt-1 ${P?"text-red-500":"text-gray-500"}`,children:"M√≠nimo de 5 caracteres"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(O,{onClick:()=>{R(!1),d(""),S(""),A(!1)},className:"flex-1 bg-[#a6a6a5] hover:bg-[#929290] text-white border-0 rounded transition-all duration-100",children:"Cancelar"}),e.jsx(O,{onClick:be,disabled:!L||j.isPending,className:"rounded flex-1 bg-red-600 hover:bg-red-700 disabled:opacity-50 transition-all duration-100",children:j.isPending?e.jsxs(e.Fragment,{children:[e.jsx(ds,{className:"w-4 h-4 mr-2 animate-spin"}),"Processando..."]}):"Confirmar Rejei√ß√£o"})]})]})})}),e.jsx(je,{open:g,onOpenChange:f=>{E(f),f||w("")},children:e.jsx(Ne,{className:"max-w-sm",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(we,{className:"font-bold text-lg text-amber-700",children:"Reprovar altera√ß√£o solicitada"}),e.jsx(Ms,{className:"text-sm text-gray-600",children:'Informe um breve motivo para o cliente (m√≠n. 3 caracteres). Ex.: "Ingrediente indispon√≠vel".'}),e.jsx(dt,{value:p,onChange:f=>w(f.target.value),placeholder:"Motivo da reprova√ß√£o...",rows:3,className:"resize-none min-h-[52px] focus:border-gray-800 focus:ring-1 focus:ring-gray-800/20 focus:outline-none"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(O,{onClick:()=>{E(!1),w("")},className:"flex-1 bg-[#a6a6a5] hover:bg-[#929290] text-white border-0 rounded transition-all duration-100",children:"Cancelar"}),e.jsx(O,{onClick:yt,disabled:(p||"").trim().length<3,className:"rounded flex-1 bg-amber-600 hover:bg-amber-700 transition-all duration-100",children:"Reprovar altera√ß√£o"})]})]})})}),e.jsx(je,{open:k,onOpenChange:v,children:e.jsx(Ne,{className:"max-w-sm","aria-describedby":void 0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(we,{className:"font-bold text-lg",children:"Chamar Entregador"}),at.length===0?e.jsx("p",{className:"text-center text-gray-500 py-4",children:"Nenhum entregador dispon√≠vel"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:at.map(f=>e.jsxs("button",{onClick:()=>D(f.id),className:`w-full p-3 rounded-lg border-2 text-left ${b===f.id?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[e.jsx("p",{className:"font-medium",children:f.name}),e.jsx("p",{className:"text-sm text-gray-500",children:f.phone})]},f.id))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(O,{onClick:()=>v(!1),className:"flex-1 bg-[#a6a6a5] hover:bg-[#929290] text-white border-0 rounded transition-all duration-100",children:"Cancelar"}),e.jsx(O,{onClick:tt,disabled:!b||j.isPending,className:"rounded flex-1 bg-blue-600 disabled:opacity-50 transition-all duration-100",children:j.isPending?"Processando...":"Confirmar"})]})]})]})})}),oe&&t.entregador_id&&e.jsx(Dn,{order:t,entregador:s.find(f=>f.id===t.entregador_id),onClose:()=>le(!1)})]})}function Ln({isOpen:t,onClose:s,order:a,entregadores:r,onAssign:n}){const[i,o]=u.useState("nearest"),c=l=>(Math.random()*4.5+.5).toFixed(1),x=[...r.filter(l=>l.status==="available")].sort((l,y)=>i==="nearest"?parseFloat(c())-parseFloat(c()):i==="least_busy"?(l.total_deliveries||0)-(y.total_deliveries||0):i==="best_rated"?(y.rating||0)-(l.rating||0):0),h=x[0];return e.jsx(je,{open:t,onOpenChange:s,children:e.jsxs(Ne,{className:"max-w-2xl",children:[e.jsx(xt,{children:e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-orange-500"}),"Atribui√ß√£o Autom√°tica de Entregador"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border",children:[e.jsxs("p",{className:"font-bold text-sm mb-1",children:["Pedido #",a?.order_code]}),e.jsx("p",{className:"text-xs text-gray-600",children:a?.customer_name}),e.jsx("p",{className:"text-xs text-gray-500",children:a?.address})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"M√©todo de sele√ß√£o:"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:()=>o("nearest"),className:`p-3 rounded-lg border-2 text-left transition-all ${i==="nearest"?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(qe,{className:"w-4 h-4 mb-1 text-orange-500"}),e.jsx("p",{className:"font-medium text-xs",children:"Mais Pr√≥ximo"})]}),e.jsxs("button",{onClick:()=>o("least_busy"),className:`p-3 rounded-lg border-2 text-left transition-all ${i==="least_busy"?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(ve,{className:"w-4 h-4 mb-1 text-orange-500"}),e.jsx("p",{className:"font-medium text-xs",children:"Menos Ocupado"})]}),e.jsxs("button",{onClick:()=>o("best_rated"),className:`p-3 rounded-lg border-2 text-left transition-all ${i==="best_rated"?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(Ve,{className:"w-4 h-4 mb-1 text-orange-500"}),e.jsx("p",{className:"font-medium text-xs",children:"Melhor Avaliado"})]})]})]}),h&&e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-500 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(_t,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-bold",children:["Melhor Op√ß√£o: ",h.name]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ie,{className:"bg-green-600 text-xs",children:"Dispon√≠vel"}),e.jsxs("span",{className:"text-xs text-gray-600",children:["~",c(),"km de dist√¢ncia"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/50 rounded p-2",children:[e.jsx("p",{className:"text-gray-600",children:"Entregas"}),e.jsx("p",{className:"font-bold",children:h.total_deliveries||0})]}),e.jsxs("div",{className:"bg-white/50 rounded p-2",children:[e.jsx("p",{className:"text-gray-600",children:"Avalia√ß√£o"}),e.jsxs("p",{className:"font-bold flex items-center gap-1",children:[e.jsx(Ve,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),h.rating?.toFixed(1)||"N/A"]})]}),e.jsxs("div",{className:"bg-white/50 rounded p-2",children:[e.jsx("p",{className:"text-gray-600",children:"Ve√≠culo"}),e.jsx("p",{className:"font-bold uppercase",children:h.vehicle_type||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Outras op√ß√µes dispon√≠veis:"}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:x.slice(1,5).map(l=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer",onClick:()=>n?.(a.id,l.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_t,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:l.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["~",c(),"km"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-xs",children:["‚≠ê ",l.rating?.toFixed(1)||"N/A"]})})]},l.id))})]})]}),e.jsxs(_s,{children:[e.jsx(O,{variant:"outline",onClick:s,children:"Cancelar"}),e.jsxs(O,{onClick:()=>{h&&(n?.(a.id,h.id),s())},className:"bg-green-600 hover:bg-green-700",disabled:!h,children:[e.jsx(Kt,{className:"w-4 h-4 mr-2"}),"Atribuir para ",h?.name]})]})]})})}function Fn({isOpen:t,onClose:s,entregador:a}){const[r,n]=u.useState(""),[i,o]=u.useState(!1),c=["Pedido urgente dispon√≠vel","Por favor, confirme sua localiza√ß√£o","Cliente aguardando contato","Retorne √† loja para nova entrega"],m=async()=>{r.trim()&&(o(!0),await new Promise(h=>setTimeout(h,1e3)),Be.success(`Mensagem enviada para ${a.name}`),n(""),o(!1))},x=async()=>{o(!0),await new Promise(h=>setTimeout(h,800)),Be.success(`Notifica√ß√£o push enviada para ${a.name}`),o(!1)};return e.jsx(je,{open:t,onOpenChange:s,children:e.jsxs(Ne,{className:"max-w-md",children:[e.jsx(xt,{children:e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-blue-500"}),"Mensagem para ",a?.name]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Mensagens r√°pidas:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:c.map((h,l)=>e.jsx("button",{onClick:()=>n(h),className:"p-2 text-xs text-left border rounded-lg hover:bg-gray-50 transition-colors",children:h},l))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Mensagem personalizada:"}),e.jsx(dt,{value:r,onChange:h=>n(h.target.value),placeholder:"Digite sua mensagem...",rows:4,className:"resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(O,{onClick:x,disabled:i,variant:"outline",className:"w-full",children:[e.jsx(Pt,{className:"w-4 h-4 mr-2"}),"Notifica√ß√£o Push"]}),e.jsxs(O,{onClick:m,disabled:i||!r.trim(),className:"w-full bg-blue-600 hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4 mr-2"}),"Enviar Mensagem"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border text-xs",children:[e.jsx("p",{className:"font-medium mb-1",children:"Contato:"}),e.jsxs("p",{className:"text-gray-600",children:["üì± ",a?.phone||"N√£o informado"]})]})]})]})})}function zn({isOpen:t,onClose:s,entregador:a,orderId:r}){const[n,i]=u.useState(0),[o,c]=u.useState(0),[m,x]=u.useState(""),h=He(),l=Ce({mutationFn:async R=>{await W.entities.DeliveryRating.create(R);const k=a.rating||5,v=a.total_ratings||0,g=v+1,E=(k*v+R.rating)/g;await W.entities.Entregador.update(a.id,{...a,rating:E,total_ratings:g})},onSuccess:()=>{h.invalidateQueries({queryKey:["entregadores"]}),Be.success("Avalia√ß√£o registrada com sucesso!"),s(),i(0),x("")}}),y=()=>{if(n===0){Be.error("Por favor, selecione uma avalia√ß√£o");return}l.mutate({order_id:r,entregador_id:a.id,rating:n,comment:m.trim()||void 0,rated_by:"customer"})};return e.jsx(je,{open:t,onOpenChange:s,children:e.jsxs(Ne,{className:"max-w-md",children:[e.jsx(xt,{children:e.jsx(we,{children:"Avaliar Entregador"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-bold text-lg",children:a?.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[a?.total_deliveries||0," entregas ‚Ä¢ ‚≠ê ",a?.rating?.toFixed(1)||"N/A"]})]}),e.jsx("div",{className:"flex justify-center gap-2 py-4",children:[1,2,3,4,5].map(R=>e.jsx("button",{onMouseEnter:()=>c(R),onMouseLeave:()=>c(0),onClick:()=>i(R),className:"transition-transform hover:scale-110",children:e.jsx(Ve,{className:`w-10 h-10 ${R<=(o||n)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},R))}),n>0&&e.jsxs("p",{className:"text-center text-sm font-medium",children:[n===1&&"P√©ssimo",n===2&&"Ruim",n===3&&"Regular",n===4&&"Bom",n===5&&"Excelente"]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Coment√°rio (opcional)"}),e.jsx(dt,{value:m,onChange:R=>x(R.target.value),placeholder:"Deixe um coment√°rio sobre a entrega...",rows:3,className:"resize-none"})]})]}),e.jsxs(_s,{children:[e.jsx(O,{variant:"outline",onClick:s,children:"Cancelar"}),e.jsx(O,{onClick:y,disabled:n===0||l.isPending,className:"bg-yellow-500 hover:bg-yellow-600",children:l.isPending?"Enviando...":"Enviar Avalia√ß√£o"})]})]})})}const Bn=(t,s={lat:-5.0892,lng:-42.8019})=>{if(t.length===0)return{optimizedOrders:[],totalDistance:0,estimatedTime:0};const a=[...t],r=[];let n=s,i=0;for(;a.length>0;){let c=0,m=Us(n,a[0].coordinates||zt());for(let h=1;h<a.length;h++){const l=Us(n,a[h].coordinates||zt());l<m&&(m=l,c=h)}const x=a.splice(c,1)[0];r.push(x),n=x.coordinates||zt(),i+=m}const o=Math.round(i/30*60+r.length*5);return{optimizedOrders:r,totalDistance:Math.round(i*10)/10,estimatedTime:o}},Us=(t,s)=>{const r=$t(s.lat-t.lat),n=$t(s.lng-t.lng),i=$t(t.lat),o=$t(s.lat),c=Math.sin(r/2)*Math.sin(r/2)+Math.sin(n/2)*Math.sin(n/2)*Math.cos(i)*Math.cos(o);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))},$t=t=>t*(Math.PI/180),zt=()=>({lat:-5.0892+(Math.random()-.5)*.1,lng:-42.8019+(Math.random()-.5)*.1});function qn({isOpen:t,onClose:s,entregador:a,orders:r}){const[n,i]=u.useState([]),[o,c]=u.useState(null),[m,x]=u.useState(!1),h=He(),l=r.filter(g=>g.status==="ready"&&g.delivery_method==="delivery"&&!g.entregador_id);u.useEffect(()=>{t&&(i([]),c(null))},[t]);const y=g=>{i(E=>E.some(w=>w.id===g.id)?E.filter(w=>w.id!==g.id):[...E,g])},R=()=>{if(n.length===0){B.error("Selecione pelo menos um pedido");return}x(!0),setTimeout(()=>{const g=n.map(p=>({...p,coordinates:p.coordinates||zt()})),E=Bn(g);c(E),x(!1),B.success("Rota otimizada com sucesso!")},800)},k=Ce({mutationFn:async()=>{if(o){for(const g of o.optimizedOrders)await W.entities.Order.update(g.id,{status:"out_for_delivery",entregador_id:a.id});await W.entities.Entregador.update(a.id,{...a,status:"busy",current_order_id:o.optimizedOrders[0].id})}},onSuccess:()=>{h.invalidateQueries({queryKey:["gestorOrders"]}),h.invalidateQueries({queryKey:["entregadores"]}),B.success("Rota atribu√≠da ao entregador!"),s()},onError:()=>{B.error("Erro ao atribuir rota")}}),v=g=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(g||0);return e.jsx(je,{open:t,onOpenChange:s,children:e.jsxs(Ne,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(xt,{children:e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-5 h-5 text-blue-600"}),"Otimiza√ß√£o de Rota - ",a?.name]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-center border border-blue-200",children:[e.jsx(qe,{className:"w-5 h-5 mx-auto mb-1 text-blue-600"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:n.length}),e.jsx("p",{className:"text-xs text-blue-700",children:"Entregas"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center border border-green-200",children:[e.jsx(ya,{className:"w-5 h-5 mx-auto mb-1 text-green-600"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:o?`${o.totalDistance}km`:"-"}),e.jsx("p",{className:"text-xs text-green-700",children:"Dist√¢ncia"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 text-center border border-orange-200",children:[e.jsx(Le,{className:"w-5 h-5 mx-auto mb-1 text-orange-600"}),e.jsx("p",{className:"text-2xl font-bold text-orange-900",children:o?`${o.estimatedTime}min`:"-"}),e.jsx("p",{className:"text-xs text-orange-700",children:"Tempo Est."})]})]}),!o&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"font-bold",children:["Pedidos Dispon√≠veis (",l.length,")"]}),e.jsx(O,{onClick:R,disabled:n.length===0||m,className:"bg-blue-600 hover:bg-blue-700",size:"sm",children:m?e.jsxs(e.Fragment,{children:[e.jsx(Ps,{className:"w-4 h-4 mr-2 animate-spin"}),"Otimizando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(rs,{className:"w-4 h-4 mr-2"}),"Otimizar Rota"]})})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:l.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(qe,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),e.jsx("p",{children:"Nenhum pedido dispon√≠vel para entrega"})]}):l.map(g=>{const E=n.some(p=>p.id===g.id);return e.jsx("div",{onClick:()=>y(g),className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${E?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 bg-white"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("p",{className:"font-bold",children:["#",g.order_code]}),e.jsx(ie,{className:"text-xs bg-green-500",children:"Pronto"})]}),e.jsx("p",{className:"text-sm text-gray-700",children:g.customer_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.jsx(qe,{className:"w-3 h-3 inline mr-1"}),g.address]}),e.jsx("p",{className:"text-sm font-bold text-green-600 mt-2",children:v(g.total)})]}),E&&e.jsx(fe,{className:"w-6 h-6 text-blue-600 flex-shrink-0"})]})},g.id)})})]}),o&&e.jsxs("div",{children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-4 mb-4 border-2 border-blue-200",children:[e.jsxs("h3",{className:"font-bold text-lg mb-2 flex items-center gap-2",children:[e.jsx(rs,{className:"w-5 h-5 text-blue-600"}),"Rota Otimizada"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Total de Entregas"}),e.jsx("p",{className:"font-bold text-lg",children:o.optimizedOrders.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Dist√¢ncia Total"}),e.jsxs("p",{className:"font-bold text-lg",children:[o.totalDistance," km"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Tempo Estimado"}),e.jsxs("p",{className:"font-bold text-lg",children:[o.estimatedTime," min"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-sm text-gray-700",children:"Sequ√™ncia de Entrega:"}),o.optimizedOrders.map((g,E)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded-lg border",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm",children:E+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("p",{className:"font-bold",children:["#",g.order_code]}),e.jsx(ie,{className:"text-xs",children:g.customer_name})]}),e.jsxs("p",{className:"text-xs text-gray-600 flex items-start gap-1",children:[e.jsx(qe,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:g.address})]}),e.jsx("p",{className:"text-sm font-semibold text-green-600 mt-1",children:v(g.total)})]})]},g.id))]}),e.jsxs("div",{className:"mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm",children:[e.jsx("p",{className:"font-semibold text-yellow-900 mb-1",children:"üí° Dica de Otimiza√ß√£o:"}),e.jsx("p",{className:"text-yellow-800",children:"Esta rota foi calculada usando o algoritmo de vizinho mais pr√≥ximo, priorizando menor dist√¢ncia entre pontos de entrega."})]})]})]}),e.jsx(_s,{className:"flex gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(O,{variant:"outline",onClick:()=>c(null),children:"Voltar"}),e.jsx(O,{onClick:()=>k.mutate(),disabled:k.isPending,className:"bg-green-600 hover:bg-green-700",children:k.isPending?e.jsxs(e.Fragment,{children:[e.jsx(Ps,{className:"w-4 h-4 mr-2 animate-spin"}),"Atribuindo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"Confirmar e Iniciar Entregas"]})})]}):e.jsx(O,{variant:"outline",onClick:s,children:"Cancelar"})})]})})}const Kn={};function Vn(t=0,s="#22c55e"){const a=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><g transform="rotate(${t-90} 24 24)"><path fill="${s}" stroke="#166534" stroke-width="1" d="M12 30q2-1 4-2t4-1l-2-4h-4q-1 2-2 4t-2 3zm8-14l4 8 8-2-4-8q-2 1-4 2t-4 2zm-8 20q-2 0-4-1t-4-3 -2-4q0-3 2.5-5.5T20 28q3 0 5.5 2.5T28 36q0 2-1 4t-3 4-4 2q-3 0-5.5-2.5T12 36z"/><circle cx="36" cy="36" r="6" fill="#475569"/></g></svg>`;return"data:image/svg+xml,"+encodeURIComponent(a)}function Hn({entregadores:t=[],orders:s=[],stores:a=[],onSelectEntregador:r,onSelectOrder:n,darkMode:i=!1}){u.useRef(null);const o=u.useRef(null),c=u.useRef({}),m=u.useRef({}),[x,h]=u.useState(!1),[l,y]=u.useState(null),[R,k]=u.useState({}),[v,g]=u.useState({}),[E,p]=u.useState(null),w="";u.useEffect(()=>{s.filter(P=>["going_to_store","out_for_delivery"].includes(P.status)&&P.address).forEach(async P=>{if(!R[P.id])try{const b=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(P.address)}&limit=1`)).json();b?.[0]&&k(D=>({...D,[P.id]:{lat:parseFloat(b[0].lat),lng:parseFloat(b[0].lon)}}))}catch(A){console.error(A)}})},[s]),u.useEffect(()=>{},[t,s,R,void 0]);const d=t.filter(P=>(P.status==="busy"||P.current_order_id)&&P.current_latitude&&P.current_longitude),M=s.filter(P=>P.status==="ready"&&P.delivery_method==="delivery"),S=[...d.map(P=>({lat:P.current_latitude,lng:P.current_longitude})),...Object.values(R),...a.filter(P=>P.store_latitude&&P.store_longitude).map(P=>({lat:P.store_latitude,lng:P.store_longitude}))];return S.length>0&&(S.reduce((P,A)=>P+A.lat,0)/S.length,S.reduce((P,A)=>P+A.lng,0)/S.length),u.useEffect(()=>{},[w]),u.useEffect(()=>{const P=o.current;P&&P.setOptions({styles:i?[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]}]:void 0})},[x,i]),u.useEffect(()=>{const P=o.current;!P||!x||(Object.values(c.current).forEach(A=>A?.setMap?.(null)),Object.values(m.current).forEach(A=>A?.setMap?.(null)),c.current={},m.current={},a.forEach(A=>{if(!A.store_latitude||!A.store_longitude)return;const b=new google.maps.Marker({map:P,position:{lat:A.store_latitude,lng:A.store_longitude},title:A.name||"Restaurante",icon:{path:google.maps.SymbolPath.BACKWARD_CLOSED_ARROW,scale:8,fillColor:"#8b5cf6",fillOpacity:1,strokeColor:"#fff",strokeWeight:2}});c.current[`store-${A.id}`]=b}),d.forEach(A=>{const b=s.find(V=>V.id===A.current_order_id);if(!b||!R[b.id])return;const D=v[`${A.id}-${b.id}`];if(!D?.path?.length)return;const z=new google.maps.Polyline({map:P,path:D.path,strokeColor:E===A.id?"#3b82f6":"#10b981",strokeWeight:E===A.id?6:4,strokeOpacity:.7});m.current[`route-${A.id}`]=z}),d.forEach(A=>{const b=s.find(Z=>Z.id===A.current_order_id),D=b?v[`${A.id}-${b.id}`]:null;let z=0;if(D?.path?.length>=2){const Z=D.path[0],oe=D.path[1],le=(oe.lng-Z.lng)*Math.PI/180;z=(Math.atan2(Math.sin(le)*Math.cos(oe.lat*Math.PI/180),Math.cos(Z.lat*Math.PI/180)*Math.sin(oe.lat*Math.PI/180)-Math.sin(Z.lat*Math.PI/180)*Math.cos(oe.lat*Math.PI/180)*Math.cos(le))*180/Math.PI+360)%360}const V=E===A.id?"#3b82f6":A.status==="busy"?"#eab308":"#22c55e",ae=new google.maps.Marker({map:P,position:{lat:A.current_latitude,lng:A.current_longitude},title:A.name,icon:{url:Vn(z,V),scaledSize:new google.maps.Size(44,44),anchor:new google.maps.Point(22,22)}});ae.addListener("click",()=>{p(A.id),r?.(A),b&&n?.(b)}),c.current[`ent-${A.id}`]=ae}),Object.entries(R).forEach(([A,b])=>{const D=s.find(V=>V.id===A);if(!D)return;const z=new google.maps.Marker({map:P,position:b,title:D.customer_name,icon:{path:google.maps.SymbolPath.CIRCLE,scale:10,fillColor:"#ef4444",fillOpacity:1,strokeColor:"#fff",strokeWeight:2}});z.addListener("click",()=>n?.(D)),c.current[`cust-${A}`]=z}),M.forEach(A=>{const b=R[A.id];if(!b)return;const D=new google.maps.Marker({map:P,position:b,title:`#${A.order_code}`,icon:{path:google.maps.SymbolPath.CIRCLE,scale:10,fillColor:"#ef4444",fillOpacity:1,strokeColor:"#fff",strokeWeight:2}});D.addListener("click",()=>n?.(A)),c.current[`pend-${A.id}`]=D}))},[x,d,R,v,a,s,M,E,r,n]),u.useEffect(()=>{const P=o.current;if(!P||S.length<2)return;const A=new google.maps.LatLngBounds;S.forEach(b=>A.extend(b)),P.fitBounds(A,60)},[x,S.length]),e.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-amber-50 dark:bg-amber-900/20 rounded-xl p-6",children:[e.jsx(qe,{className:"w-12 h-12 text-amber-500 mb-2"}),e.jsx("p",{className:"text-amber-800 dark:text-amber-200 text-sm font-medium text-center mb-1",children:"Chave do Google Maps n√£o configurada"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-xs text-center max-w-xs",children:["Adicione ",e.jsx("code",{className:"bg-black/5 dark:bg-white/10 px-1 rounded",children:"VITE_GOOGLE_MAPS_KEY"})," (ou ",e.jsx("code",{className:"bg-black/5 dark:bg-white/10 px-1 rounded",children:"VITE_GOOGLE_MAPS_API_KEY"}),") no ",e.jsx("code",{className:"bg-black/5 dark:bg-white/10 px-1 rounded",children:".env"})," na raiz e reinicie (",e.jsx("code",{children:"npm run dev"}),"). Na Vercel: Settings ‚Üí Environment Variables."]})]})}function Un({entregador:t,onClose:s,darkMode:a}){const{data:r=[]}=Ae({queryKey:["deliveryRatings",t.id],queryFn:()=>W.entities.DeliveryRating.filter({entregador_id:t.id},"-created_date")}),{data:n=[]}=Ae({queryKey:["ratedOrders",t.id],queryFn:async()=>(await W.entities.Order.filter({entregador_id:t.id,status:"delivered"})).filter(x=>x.restaurant_rating||x.rating_comment)}),i=r.length>0?(r.reduce((m,x)=>m+(x.rating||0),0)/r.length).toFixed(1):"5.0",o=[5,4,3,2,1].map(m=>({star:m,count:r.filter(x=>x.rating===m).length,percentage:r.length>0?r.filter(x=>x.rating===m).length/r.length*100:0})),c=[...r.map(m=>({...m,type:"delivery",date:m.created_date,rating:m.rating,comment:m.comment})),...n.map(m=>({...m,type:"restaurant",date:m.delivered_at,rating:m.restaurant_rating,comment:m.rating_comment}))].sort((m,x)=>new Date(x.date)-new Date(m.date));return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(Ee.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:`w-full max-w-2xl max-h-[90vh] ${a?"bg-gray-800":"bg-white"} rounded-2xl shadow-2xl overflow-hidden`,children:[e.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white p-6 relative",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 hover:bg-white/20 rounded-lg p-2 transition-colors",children:e.jsx(xe,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",children:e.jsx(va,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Hist√≥rico de Avalia√ß√µes"}),e.jsx("p",{className:"text-white/80 text-sm",children:"Suas avalia√ß√µes de clientes e restaurantes"})]})]})]}),e.jsxs("div",{className:"p-6 border-b",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-amber-500",children:i}),e.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:[...Array(5)].map((m,x)=>e.jsx(Ve,{className:`w-4 h-4 ${x<Math.round(parseFloat(i))?"fill-amber-400 text-amber-400":"text-gray-300"}`},x))}),e.jsx("p",{className:"text-xs text-gray-500",children:"M√©dia Geral"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-500",children:c.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Total de Avalia√ß√µes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-500",children:c.filter(m=>m.rating>=4).length}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Positivas"})]})]}),e.jsx("div",{className:"space-y-2",children:o.map(({star:m,count:x,percentage:h})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1 w-16",children:[e.jsx(Ve,{className:"w-3 h-3 fill-amber-400 text-amber-400"}),e.jsx("span",{className:"text-sm font-medium",children:m})]}),e.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-amber-400 transition-all duration-500",style:{width:`${h}%`}})}),e.jsx("span",{className:"text-xs text-gray-500 w-12 text-right",children:x})]},m))})]}),e.jsx("div",{className:"overflow-y-auto max-h-[400px] p-6 space-y-4",children:c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ot,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhuma avalia√ß√£o ainda"})]}):c.map((m,x)=>e.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:x*.05},className:`p-4 rounded-xl border ${a?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`px-2 py-1 rounded-lg text-xs font-medium ${m.type==="delivery"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:m.type==="delivery"?"üë§ Cliente":"üçΩÔ∏è Restaurante"}),e.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((h,l)=>e.jsx(Ve,{className:`w-4 h-4 ${l<m.rating?"fill-amber-400 text-amber-400":"text-gray-300"}`},l))})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(Lt,{className:"w-3 h-3"}),new Date(m.date).toLocaleDateString("pt-BR")]})]}),m.comment&&e.jsxs("p",{className:`text-sm ${a?"text-gray-300":"text-gray-700"} mt-2`,children:['"',m.comment,'"']}),m.order_code&&e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Pedido #",m.order_code]})]},x))}),e.jsx("div",{className:`p-4 border-t ${a?"bg-gray-750 border-gray-700":"bg-gray-50 border-gray-200"} text-center`,children:e.jsx("p",{className:"text-xs text-gray-500",children:"Continue fazendo um √≥timo trabalho para receber mais avalia√ß√µes positivas! üåü"})})]})})}function Gn({entregadores:t,orders:s,stores:a=[]}){const r=Array.isArray(s)?s:[],n=Array.isArray(t)?t:[],[i,o]=u.useState("list"),[c,m]=u.useState(null),[x,h]=u.useState(!1),[l,y]=u.useState(null),[R,k]=u.useState(!1),[v,g]=u.useState(!1),[E,p]=u.useState(!1),[w,L]=u.useState(null),[d,M]=u.useState(!1),[S,P]=u.useState(null),[A,b]=u.useState(!1),D=He(),{data:z=[]}=Ae({queryKey:["entregadorRatings"],queryFn:()=>W.entities.DeliveryRating.list()}),V=N=>{const j=z.filter(J=>J.entregador_id===N&&J.rated_by==="customer");return j.length===0?null:(j.reduce((J,re)=>J+re.rating,0)/j.length).toFixed(1)},ae=N=>s.filter(j=>j.entregador_id===N&&j.status==="delivered"),Z=Ce({mutationFn:async({orderId:N,entregadorId:j})=>{const H=s.find(re=>re.id===N),J=t.find(re=>re.id===j);await W.entities.Order.update(N,{...H,entregador_id:j,status:"out_for_delivery"}),await W.entities.Entregador.update(j,{...J,status:"busy",current_order_id:N})},onSuccess:()=>{D.invalidateQueries({queryKey:["gestorOrders"]}),D.invalidateQueries({queryKey:["entregadores"]}),Be.success("Entregador atribu√≠do com sucesso!")}}),oe=n.filter(N=>N.status==="available"),le=n.filter(N=>N.status==="busy"),ee=r.filter(N=>N.status==="ready"&&N.delivery_method==="delivery"),[_,F]=u.useState({name:"",phone:"",email:""}),U=N=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(N||0),te=Ce({mutationFn:N=>W.entities.Entregador.create({...N,status:"offline",total_deliveries:0,total_earnings:0,rating:5}),onSuccess:()=>{D.invalidateQueries({queryKey:["entregadores"]}),b(!1),F({name:"",phone:"",email:""}),Be.success("Entregador cadastrado com sucesso!")}}),G=Ce({mutationFn:async({id:N,data:j})=>{const H=t.find(J=>J.id===N);return await W.entities.Entregador.update(N,{...H,...j})},onSuccess:()=>{D.invalidateQueries({queryKey:["entregadores"]}),P(null),Be.success("Entregador atualizado!")}});return Ce({mutationFn:N=>W.entities.Entregador.delete(N),onSuccess:()=>{D.invalidateQueries({queryKey:["entregadores"]}),Be.success("Entregador removido!")}}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-700 font-medium",children:"Dispon√≠veis"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:oe.length})]}),e.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xl",children:"‚úì"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-yellow-700 font-medium",children:"Em entrega"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:le.length})]}),e.jsx("div",{className:"w-10 h-10 bg-yellow-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xl",children:"üö¥"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-orange-700 font-medium",children:"Aguardando"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:ee.length})]}),e.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx(ve,{className:"w-5 h-5 text-white"})})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white rounded-lg p-1 border w-fit",children:[e.jsxs(O,{size:"sm",variant:i==="map"?"default":"ghost",onClick:()=>o("map"),className:i==="map"?"bg-orange-500 hover:bg-orange-600":"",children:[e.jsx(En,{className:"w-4 h-4 mr-1"}),"Mapa ao Vivo"]}),e.jsxs(O,{size:"sm",variant:i==="list"?"default":"ghost",onClick:()=>o("list"),className:i==="list"?"bg-orange-500 hover:bg-orange-600":"",children:[e.jsx(kn,{className:"w-4 h-4 mr-1"}),"Lista"]})]}),i==="map"&&e.jsxs("div",{className:"grid lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"lg:col-span-2 h-[400px] min-h-[300px] lg:h-[480px] rounded-xl overflow-hidden border border-gray-200",children:e.jsx(Hn,{orders:s,entregadores:t,stores:a,onSelectOrder:m,onSelectEntregador:N=>{const j=s.find(H=>H.id===N.current_order_id);j&&m(j)},darkMode:!1})}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-white border rounded-lg p-3",children:[e.jsxs("h4",{className:"font-semibold text-sm mb-2 flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4 text-orange-500"}),"Pedidos Prontos (",ee.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-[450px] overflow-y-auto",children:ee.slice(0,10).map(N=>e.jsxs("div",{className:"bg-gray-50 p-2 rounded text-xs",children:[e.jsxs("p",{className:"font-bold text-gray-900",children:["#",N.order_code]}),e.jsx("p",{className:"text-gray-600",children:N.customer_name}),e.jsxs(O,{size:"sm",onClick:()=>{m(N),h(!0)},className:"w-full mt-2 h-7 text-xs bg-orange-500 hover:bg-orange-600",children:[e.jsx(Kt,{className:"w-3 h-3 mr-1"}),"Atribuir"]})]},N.id))})]})})]}),i==="list"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-end mb-3",children:e.jsxs(O,{onClick:()=>b(!0),className:"bg-orange-500 hover:bg-orange-600",children:[e.jsx(xs,{className:"w-4 h-4 mr-2"}),"Novo Entregador"]})}),t.length===0?e.jsxs("div",{className:"bg-white rounded-xl p-12 text-center border",children:[e.jsx(_t,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Nenhum entregador cadastrado"}),e.jsxs(O,{onClick:()=>b(!0),className:"bg-orange-500 hover:bg-orange-600",children:[e.jsx(xs,{className:"w-4 h-4 mr-2"}),"Cadastrar Primeiro Entregador"]})]}):e.jsx("div",{className:"grid gap-3",children:t.map(N=>{const j=N.current_order_id?s.find(re=>re.id===N.current_order_id):null,H=ae(N.id),J=V(N.id);return e.jsxs("div",{className:"bg-white rounded-lg border p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[N.photo?e.jsx("img",{src:N.photo,alt:N.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${N.status==="available"?"bg-green-100":N.status==="busy"?"bg-yellow-100":"bg-gray-100"}`,children:e.jsx(_t,{className:`w-6 h-6 ${N.status==="available"?"text-green-600":N.status==="busy"?"text-yellow-600":"text-gray-400"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-base",children:N.name}),e.jsxs("div",{className:"flex flex-col gap-0.5 mt-0.5",children:[e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(ja,{className:"w-3 h-3"}),N.phone]}),N.email&&e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(Gr,{className:"w-3 h-3"}),N.email]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:`text-[10px] h-5 ${N.status==="available"?"bg-green-500":N.status==="busy"?"bg-yellow-500":"bg-gray-500"}`,children:N.status==="available"?"Online":N.status==="busy"?"Ocupado":"Offline"}),e.jsx(O,{size:"icon",variant:"ghost",onClick:()=>P(N),className:"h-7 w-7",children:e.jsx(Qr,{className:"w-3.5 h-3.5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-blue-50 rounded-md p-2 text-center",children:[e.jsx(ve,{className:"w-4 h-4 mx-auto mb-0.5 text-blue-600"}),e.jsx("p",{className:"text-lg font-bold text-blue-700",children:N.total_deliveries||0}),e.jsx("p",{className:"text-[9px] text-gray-600",children:"Entregas"})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-md p-2 text-center",children:[e.jsx(Ve,{className:"w-4 h-4 mx-auto mb-0.5 text-yellow-500"}),e.jsx("p",{className:"text-lg font-bold text-yellow-600",children:J||"5.0"}),e.jsx("p",{className:"text-[9px] text-gray-600",children:"Nota"})]}),e.jsxs("div",{className:"bg-green-50 rounded-md p-2 text-center",children:[e.jsx(fe,{className:"w-4 h-4 mx-auto mb-0.5 text-green-600"}),e.jsx("p",{className:"text-lg font-bold text-green-700",children:H.length}),e.jsx("p",{className:"text-[9px] text-gray-600",children:"Hoje"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-md p-2 text-center",children:[e.jsx(_t,{className:"w-4 h-4 mx-auto mb-0.5 text-purple-600"}),e.jsx("p",{className:"text-base font-bold text-purple-700",children:N.vehicle_type==="bike"?"üö¥":N.vehicle_type==="motorcycle"?"üèçÔ∏è":N.vehicle_type==="car"?"üöó":"N/A"}),e.jsx("p",{className:"text-[9px] text-gray-600",children:"Ve√≠culo"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-md p-2 text-center",children:[e.jsx(Le,{className:"w-4 h-4 mx-auto mb-0.5 text-orange-600"}),e.jsx("p",{className:"text-xs font-bold text-orange-700",children:U(N.total_earnings||0)}),e.jsx("p",{className:"text-[9px] text-gray-600",children:"Ganhos"})]})]}),j&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-2.5 mb-3",children:[e.jsxs("p",{className:"font-semibold text-blue-900 mb-1 text-xs flex items-center gap-1",children:[e.jsx(ve,{className:"w-3.5 h-3.5"}),"Em entrega agora:"]}),e.jsxs("p",{className:"text-xs text-blue-700 font-medium",children:["#",j.order_code," ‚Ä¢ ",j.customer_name]}),e.jsx("p",{className:"text-[10px] text-blue-600 truncate",children:j.address})]}),H.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"font-semibold text-xs text-gray-600 mb-1.5",children:"√öltimas 3 entregas"}),e.jsx("div",{className:"space-y-1",children:H.slice(0,3).map(re=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-md p-1.5 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(fe,{className:"w-3 h-3 text-green-500 flex-shrink-0"}),e.jsxs("span",{className:"font-medium truncate",children:["#",re.order_code]})]}),e.jsx("span",{className:"text-[10px] text-gray-500 flex-shrink-0",children:re.delivered_at&&ms(new Date(re.delivered_at),"HH:mm")})]},re.id))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[e.jsxs(O,{size:"sm",variant:"outline",onClick:()=>{y(N),k(!0)},className:"text-xs h-8",children:[e.jsx(Ot,{className:"w-3.5 h-3.5 mr-1"}),"Msg"]}),e.jsxs(O,{size:"sm",variant:"outline",onClick:()=>{y(N),g(!0)},className:"text-xs h-8",children:[e.jsx(Ve,{className:"w-3.5 h-3.5 mr-1"}),"Avaliar"]}),e.jsxs(O,{size:"sm",variant:"outline",onClick:()=>{y(N),M(!0)},className:"text-xs h-8",children:[e.jsx(va,{className:"w-3.5 h-3.5 mr-1"}),"Notas"]})]}),j&&e.jsxs(O,{size:"sm",onClick:()=>{y(N),m(j),k(!0)},className:"w-full bg-blue-500 hover:bg-blue-600 text-xs h-8 mt-1.5",children:[e.jsx(qe,{className:"w-3.5 h-3.5 mr-1"}),"Ver Entrega Ativa"]})]},N.id)})})]}),x&&c&&e.jsx(Ln,{isOpen:x,onClose:()=>{h(!1),m(null)},order:c,entregadores:t,onAssign:(N,j)=>Z.mutate({orderId:N,entregadorId:j})}),R&&l&&e.jsx(Fn,{isOpen:R,onClose:()=>{k(!1),y(null)},entregador:l}),v&&l&&e.jsx(zn,{isOpen:v,onClose:()=>{g(!1),y(null)},entregador:l,orderId:l.current_order_id}),E&&l&&e.jsx(qn,{isOpen:E,onClose:()=>{p(!1),y(null)},entregador:l,orders:s}),d&&l&&e.jsx(Un,{entregador:l,onClose:()=>{M(!1),y(null)},darkMode:!1}),e.jsx(je,{open:A,onOpenChange:b,children:e.jsxs(Ne,{className:"max-w-md","aria-describedby":void 0,children:[e.jsx(xt,{children:e.jsx(we,{children:"Novo Entregador"})}),e.jsxs("form",{onSubmit:N=>{N.preventDefault(),te.mutate(_)},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(se,{htmlFor:"name",children:"Nome *"}),e.jsx(he,{id:"name",value:_.name,onChange:N=>F({..._,name:N.target.value}),placeholder:"Nome completo",required:!0})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"phone",children:"Telefone *"}),e.jsx(he,{id:"phone",value:_.phone,onChange:N=>F({..._,phone:N.target.value}),placeholder:"(00) 00000-0000",required:!0})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"email",children:"Email (opcional)"}),e.jsx(he,{id:"email",type:"email",value:_.email,onChange:N=>F({..._,email:N.target.value}),placeholder:"email@exemplo.com"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(O,{type:"button",variant:"outline",onClick:()=>b(!1),className:"flex-1",children:"Cancelar"}),e.jsx(O,{type:"submit",className:"flex-1 bg-orange-500 hover:bg-orange-600",children:"Cadastrar"})]})]})]})}),S&&e.jsx(je,{open:!!S,onOpenChange:()=>P(null),children:e.jsxs(Ne,{className:"max-w-md","aria-describedby":void 0,children:[e.jsx(xt,{children:e.jsx(we,{children:"Editar Entregador"})}),e.jsxs("form",{onSubmit:N=>{N.preventDefault(),G.mutate({id:S.id,data:S})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(se,{htmlFor:"edit_name",children:"Nome *"}),e.jsx(he,{id:"edit_name",value:S.name,onChange:N=>P({...S,name:N.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"edit_phone",children:"Telefone *"}),e.jsx(he,{id:"edit_phone",value:S.phone,onChange:N=>P({...S,phone:N.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"edit_email",children:"Email"}),e.jsx(he,{id:"edit_email",type:"email",value:S.email||"",onChange:N=>P({...S,email:N.target.value})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(O,{type:"button",variant:"outline",onClick:()=>P(null),className:"flex-1",children:"Cancelar"}),e.jsx(O,{type:"submit",className:"flex-1 bg-orange-500 hover:bg-orange-600",children:"Salvar"})]})]})]})})]})}var ka=["PageUp","PageDown"],Ca=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ea={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},bt="Slider",[hs,Qn,Wn]=Jr(bt),[Aa]=Yr(bt,[Wn]),[Yn,Gt]=Aa(bt),Pa=u.forwardRef((t,s)=>{const{name:a,min:r=0,max:n=100,step:i=1,orientation:o="horizontal",disabled:c=!1,minStepsBetweenThumbs:m=0,defaultValue:x=[r],value:h,onValueChange:l=()=>{},onValueCommit:y=()=>{},inverted:R=!1,form:k,...v}=t,g=u.useRef(new Set),E=u.useRef(0),w=o==="horizontal"?Jn:Xn,[L=[],d]=Wr({prop:h,defaultProp:x,onChange:D=>{[...g.current][E.current]?.focus(),l(D)}}),M=u.useRef(L);function S(D){const z=ai(L,D);b(D,z)}function P(D){b(D,E.current)}function A(){const D=M.current[E.current];L[E.current]!==D&&y(L)}function b(D,z,{commit:V}={commit:!1}){const ae=oi(i),Z=li(Math.round((D-r)/i)*i+r,ae),oe=ma(Z,[r,n]);d((le=[])=>{const ee=ti(le,oe,z);if(ii(ee,m*i)){E.current=ee.indexOf(oe);const _=String(ee)!==String(le);return _&&V&&y(ee),_?ee:le}else return le})}return e.jsx(Yn,{scope:t.__scopeSlider,name:a,disabled:c,min:r,max:n,valueIndexToChangeRef:E,thumbs:g.current,values:L,orientation:o,form:k,children:e.jsx(hs.Provider,{scope:t.__scopeSlider,children:e.jsx(hs.Slot,{scope:t.__scopeSlider,children:e.jsx(w,{"aria-disabled":c,"data-disabled":c?"":void 0,...v,ref:s,onPointerDown:ot(v.onPointerDown,()=>{c||(M.current=L)}),min:r,max:n,inverted:R,onSlideStart:c?void 0:S,onSlideMove:c?void 0:P,onSlideEnd:c?void 0:A,onHomeKeyDown:()=>!c&&b(r,0,{commit:!0}),onEndKeyDown:()=>!c&&b(n,L.length-1,{commit:!0}),onStepKeyDown:({event:D,direction:z})=>{if(!c){const Z=ka.includes(D.key)||D.shiftKey&&Ca.includes(D.key)?10:1,oe=E.current,le=L[oe],ee=i*Z*z;b(le+ee,oe,{commit:!0})}}})})})})});Pa.displayName=bt;var[Oa,Ra]=Aa(bt,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Jn=u.forwardRef((t,s)=>{const{min:a,max:r,dir:n,inverted:i,onSlideStart:o,onSlideMove:c,onSlideEnd:m,onStepKeyDown:x,...h}=t,[l,y]=u.useState(null),R=ft(s,w=>y(w)),k=u.useRef(void 0),v=Xr(n),g=v==="ltr",E=g&&!i||!g&&i;function p(w){const L=k.current||l.getBoundingClientRect(),d=[0,L.width],S=Cs(d,E?[a,r]:[r,a]);return k.current=L,S(w-L.left)}return e.jsx(Oa,{scope:t.__scopeSlider,startEdge:E?"left":"right",endEdge:E?"right":"left",direction:E?1:-1,size:"width",children:e.jsx(Da,{dir:v,"data-orientation":"horizontal",...h,ref:R,style:{...h.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:w=>{const L=p(w.clientX);o?.(L)},onSlideMove:w=>{const L=p(w.clientX);c?.(L)},onSlideEnd:()=>{k.current=void 0,m?.()},onStepKeyDown:w=>{const d=Ea[E?"from-left":"from-right"].includes(w.key);x?.({event:w,direction:d?-1:1})}})})}),Xn=u.forwardRef((t,s)=>{const{min:a,max:r,inverted:n,onSlideStart:i,onSlideMove:o,onSlideEnd:c,onStepKeyDown:m,...x}=t,h=u.useRef(null),l=ft(s,h),y=u.useRef(void 0),R=!n;function k(v){const g=y.current||h.current.getBoundingClientRect(),E=[0,g.height],w=Cs(E,R?[r,a]:[a,r]);return y.current=g,w(v-g.top)}return e.jsx(Oa,{scope:t.__scopeSlider,startEdge:R?"bottom":"top",endEdge:R?"top":"bottom",size:"height",direction:R?1:-1,children:e.jsx(Da,{"data-orientation":"vertical",...x,ref:l,style:{...x.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:v=>{const g=k(v.clientY);i?.(g)},onSlideMove:v=>{const g=k(v.clientY);o?.(g)},onSlideEnd:()=>{y.current=void 0,c?.()},onStepKeyDown:v=>{const E=Ea[R?"from-bottom":"from-top"].includes(v.key);m?.({event:v,direction:E?-1:1})}})})}),Da=u.forwardRef((t,s)=>{const{__scopeSlider:a,onSlideStart:r,onSlideMove:n,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:c,onStepKeyDown:m,...x}=t,h=Gt(bt,a);return e.jsx(Rt.span,{...x,ref:s,onKeyDown:ot(t.onKeyDown,l=>{l.key==="Home"?(o(l),l.preventDefault()):l.key==="End"?(c(l),l.preventDefault()):ka.concat(Ca).includes(l.key)&&(m(l),l.preventDefault())}),onPointerDown:ot(t.onPointerDown,l=>{const y=l.target;y.setPointerCapture(l.pointerId),l.preventDefault(),h.thumbs.has(y)?y.focus():r(l)}),onPointerMove:ot(t.onPointerMove,l=>{l.target.hasPointerCapture(l.pointerId)&&n(l)}),onPointerUp:ot(t.onPointerUp,l=>{const y=l.target;y.hasPointerCapture(l.pointerId)&&(y.releasePointerCapture(l.pointerId),i(l))})})}),Ma="SliderTrack",Ta=u.forwardRef((t,s)=>{const{__scopeSlider:a,...r}=t,n=Gt(Ma,a);return e.jsx(Rt.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...r,ref:s})});Ta.displayName=Ma;var ps="SliderRange",$a=u.forwardRef((t,s)=>{const{__scopeSlider:a,...r}=t,n=Gt(ps,a),i=Ra(ps,a),o=u.useRef(null),c=ft(s,o),m=n.values.length,x=n.values.map(y=>Fa(y,n.min,n.max)),h=m>1?Math.min(...x):0,l=100-Math.max(...x);return e.jsx(Rt.span,{"data-orientation":n.orientation,"data-disabled":n.disabled?"":void 0,...r,ref:c,style:{...t.style,[i.startEdge]:h+"%",[i.endEdge]:l+"%"}})});$a.displayName=ps;var gs="SliderThumb",Ia=u.forwardRef((t,s)=>{const a=Qn(t.__scopeSlider),[r,n]=u.useState(null),i=ft(s,c=>n(c)),o=u.useMemo(()=>r?a().findIndex(c=>c.ref.current===r):-1,[a,r]);return e.jsx(Zn,{...t,ref:i,index:o})}),Zn=u.forwardRef((t,s)=>{const{__scopeSlider:a,index:r,name:n,...i}=t,o=Gt(gs,a),c=Ra(gs,a),[m,x]=u.useState(null),h=ft(s,p=>x(p)),l=m?o.form||!!m.closest("form"):!0,y=hr(m),R=o.values[r],k=R===void 0?0:Fa(R,o.min,o.max),v=si(r,o.values.length),g=y?.[c.size],E=g?ri(g,k,c.direction):0;return u.useEffect(()=>{if(m)return o.thumbs.add(m),()=>{o.thumbs.delete(m)}},[m,o.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${k}% + ${E}px)`},children:[e.jsx(hs.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(Rt.span,{role:"slider","aria-label":t["aria-label"]||v,"aria-valuemin":o.min,"aria-valuenow":R,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...i,ref:h,style:R===void 0?{display:"none"}:t.style,onFocus:ot(t.onFocus,()=>{o.valueIndexToChangeRef.current=r})})}),l&&e.jsx(La,{name:n??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:R},r)]})});Ia.displayName=gs;var ei="RadioBubbleInput",La=u.forwardRef(({__scopeSlider:t,value:s,...a},r)=>{const n=u.useRef(null),i=ft(n,r),o=pr(s);return u.useEffect(()=>{const c=n.current;if(!c)return;const m=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(m,"value").set;if(o!==s&&h){const l=new Event("input",{bubbles:!0});h.call(c,s),c.dispatchEvent(l)}},[o,s]),e.jsx(Rt.input,{style:{display:"none"},...a,ref:i,defaultValue:s})});La.displayName=ei;function ti(t=[],s,a){const r=[...t];return r[a]=s,r.sort((n,i)=>n-i)}function Fa(t,s,a){const i=100/(a-s)*(t-s);return ma(i,[0,100])}function si(t,s){return s>2?`Value ${t+1} of ${s}`:s===2?["Minimum","Maximum"][t]:void 0}function ai(t,s){if(t.length===1)return 0;const a=t.map(n=>Math.abs(n-s)),r=Math.min(...a);return a.indexOf(r)}function ri(t,s,a){const r=t/2,i=Cs([0,50],[0,r]);return(r-i(s)*a)*a}function ni(t){return t.slice(0,-1).map((s,a)=>t[a+1]-s)}function ii(t,s){if(s>0){const a=ni(t);return Math.min(...a)>=s}return!0}function Cs(t,s){return a=>{if(t[0]===t[1]||s[0]===s[1])return s[0];const r=(s[1]-s[0])/(t[1]-t[0]);return s[0]+r*(a-t[0])}}function oi(t){return(String(t).split(".")[1]||"").length}function li(t,s){const a=Math.pow(10,s);return Math.round(t*a)/a}var za=Pa,ci=Ta,di=$a,mi=Ia;const Ba=u.forwardRef(({className:t,...s},a)=>e.jsxs(za,{ref:a,className:tr("relative flex w-full touch-none select-none items-center",t),...s,children:[e.jsx(ci,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(di,{className:"absolute h-full bg-primary"})}),e.jsx(mi,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Ba.displayName=za.displayName;const ut=[{id:"phone_classic",name:"Som 1 - Telefone",url:"https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"},{id:"phone_urgent",name:"Som 2 - Urgente",url:"https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3"},{id:"phone_retro",name:"Som 3 - Retr√¥",url:"https://assets.mixkit.co/active_storage/sfx/2871/2871-preview.mp3"},{id:"beep_short",name:"Som 4 - Bip curto",url:"https://assets.mixkit.co/active_storage/sfx/2356/2356-preview.mp3"},{id:"beep_long",name:"Som 5 - Bip longo",url:"https://assets.mixkit.co/active_storage/sfx/2357/2357-preview.mp3"},{id:"electronic_ping",name:"Som 6 - Ping",url:"https://assets.mixkit.co/active_storage/sfx/2363/2363-preview.mp3"},{id:"ifood_01",name:"Som 7",url:"https://assets.mixkit.co/active_storage/sfx/2870/2870-preview.mp3"},{id:"ifood_02",name:"Som 8",url:"https://assets.mixkit.co/active_storage/sfx/2872/2872-preview.mp3"}],ui="gestor_notification_config";function qa(t,s=null){return t==="custom"&&s?s:ut.find(a=>a.id===t)?.url||ut[0].url}function xi(){try{const t=localStorage.getItem(ui);if(!t)return{url:ut[0].url,volume:.8};const s=JSON.parse(t);if(s.soundEnabled===!1)return{url:ut[0].url,volume:0};const a=s.soundNewOrder||s.selectedSound||"phone_classic",r=(s.soundVolume??s.volume??80)/100;return{url:qa(a,s.customSoundUrl),volume:r}}catch{return{url:ut[0].url,volume:.8}}}const fs="gestor_notification_config",bs={soundEnabled:!0,soundNewOrder:"phone_classic",soundVolume:80,soundAutoAccept:!0,soundProblemsInactivity:!0,soundNewMessages:!0};function Ka(){try{const t=localStorage.getItem(fs);if(!t)return{...bs};const s=JSON.parse(t);return{soundEnabled:s.soundEnabled!==!1,soundNewOrder:s.soundNewOrder||s.selectedSound||"phone_classic",soundVolume:s.soundVolume??s.volume??80,soundAutoAccept:s.soundAutoAccept!==!1,soundProblemsInactivity:s.soundProblemsInactivity!==!1,soundNewMessages:s.soundNewMessages!==!1}}catch{return{...bs}}}function hi(t){try{const a={...Ka(),...t},r=localStorage.getItem(fs),n=r?{...JSON.parse(r),...a}:a;localStorage.setItem(fs,JSON.stringify(n)),window.dispatchEvent(new CustomEvent("gestorNotificationConfigUpdated",{detail:n}))}catch{}}function wt({url:t,volume:s=.8,disabled:a,className:r}){const[n,i]=u.useState(!1),o=u.useCallback(()=>{if(!t)return;i(!0);const c=new Audio(t);c.volume=s,c.play().catch(()=>{}).finally(()=>i(!1)),c.onended=()=>i(!1)},[t,s]);return e.jsxs(O,{type:"button",variant:"outline",size:"sm",className:`h-8 gap-1 ${r||""}`,onClick:o,disabled:a||n,children:[e.jsx(Zr,{className:"w-3.5 h-3.5"}),n?"...":"Ouvir"]})}function pi(){const[t,s]=u.useState(bs);u.useEffect(()=>{s(Ka())},[]);const a=i=>{s(o=>({...o,...i})),hi(i)},r=t.soundVolume/100,n=qa(t.soundNewOrder);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Alertas de som"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Configure os sons para cada tipo de evento."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Recebimento de pedidos"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Pedido recebido"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Som ao chegar um novo pedido"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs(Oe,{value:t.soundNewOrder,onValueChange:i=>a({soundNewOrder:i}),children:[e.jsx(Re,{className:"w-[140px] h-9 text-sm",children:e.jsx(De,{})}),e.jsx(Me,{children:ut.slice(0,8).map(i=>e.jsx(de,{value:i.id,children:i.name},i.id))})]}),e.jsx(wt,{url:n,volume:r})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Pedidos com aceite autom√°tico"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Tocar som quando o pedido for aceito automaticamente"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(wt,{url:t.soundAutoAccept?n:null,volume:r,disabled:!t.soundAutoAccept}),e.jsx(Te,{checked:t.soundAutoAccept,onCheckedChange:i=>a({soundAutoAccept:i})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Volume"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Volume geral dos alertas de pedidos"})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0 min-w-[200px]",children:[e.jsx(Ba,{value:[t.soundVolume],onValueChange:([i])=>a({soundVolume:i}),max:100,step:5,className:"flex-1"}),e.jsxs("span",{className:"text-sm font-medium text-gray-600 w-10",children:[t.soundVolume,"%"]}),e.jsx(wt,{url:n,volume:r})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Situa√ß√µes com a loja"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Problemas com pedidos ou inatividade"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Alerta quando houver pend√™ncias ou inatividade (ex.: Est√° a√≠?)"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(wt,{url:t.soundProblemsInactivity?n:null,volume:r,disabled:!t.soundProblemsInactivity}),e.jsx(Te,{checked:t.soundProblemsInactivity,onCheckedChange:i=>a({soundProblemsInactivity:i})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Novas mensagens"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Som ao chegar nova mensagem do cliente"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(wt,{url:t.soundNewMessages?n:null,volume:r,disabled:!t.soundNewMessages}),e.jsx(Te,{checked:t.soundNewMessages,onCheckedChange:i=>a({soundNewMessages:i})})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 border border-orange-100 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Na,{className:"w-5 h-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Sons ativados"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Desative para silenciar todos os alertas"})]})]}),e.jsx(Te,{checked:t.soundEnabled,onCheckedChange:i=>a({soundEnabled:i})})]})]})}const Gs=[{id:"alertas",label:"Alertas de som",icon:Pt,group:"gestor"},{id:"logistica",label:"Gest√£o Log√≠stica",icon:$e,group:"gestor"},{id:"impressao",label:"Impress√£o",icon:Et,group:"gestor"},{id:"templates",label:"Templates de Mensagem",icon:Ot,group:"gestor"},{id:"horarios",label:"Hor√°rios",icon:Le,group:"gestor"},{id:"lojas",label:"Gest√£o de lojas",icon:en,group:"conta"},{id:"conta",label:"Minha conta",icon:wa,group:"conta"}];function gi(){const[t,s]=u.useState("alertas"),[a,r]=u.useState({default_prep_time:30,can_alter_prep_per_order:!0,auto_print:!1,sound_notifications:!0,auto_accept:!1,are_you_there_enabled:!1,are_you_there_minutes:15,prep_time_manual_enabled:!0,auto_cancel_mode:"off",auto_cancel_minutes:10}),n=He(),{data:i=[]}=Ae({queryKey:["messageTemplates"],queryFn:()=>W.entities.MessageTemplate.list()}),{data:o=[]}=Ae({queryKey:["store"],queryFn:()=>W.entities.Store.list()}),c=o[0];u.useEffect(()=>{try{const p=localStorage.getItem("gestorSettings");if(p){const w=JSON.parse(p);r(L=>({...L,...w}))}}catch{}},[]);const m=()=>{localStorage.setItem("gestorSettings",JSON.stringify(a)),B.success("Configura√ß√µes salvas!"),window.dispatchEvent(new CustomEvent("gestorSettingsUpdated",{detail:a}))},x=Ce({mutationFn:p=>W.entities.MessageTemplate.create(p),onSuccess:()=>n.invalidateQueries({queryKey:["messageTemplates"]})}),h=Ce({mutationFn:p=>W.entities.MessageTemplate.delete(p),onSuccess:()=>n.invalidateQueries({queryKey:["messageTemplates"]})}),[l,y]=u.useState({title:"",message:""}),R=()=>{!l.title||!l.message||(x.mutate(l),y({title:"",message:""}))},k=()=>{if(typeof W?.auth?.logout=="function")W.auth.logout();else try{localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/"}catch{window.location.href="/"}},v=Gs.filter(p=>p.group==="gestor"),g=Gs.filter(p=>p.group==="conta"),E=p=>`w-full flex items-center gap-2 px-3 py-2 rounded-r-md border-l-4 transition-all duration-200 text-left text-sm ${t===p?"border-orange-500 bg-orange-50 text-orange-600 font-medium":"border-transparent text-gray-600 hover:bg-gray-50"}`;return e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("aside",{className:"lg:w-56 flex-shrink-0",children:e.jsxs("nav",{className:"space-y-1",children:[e.jsx("p",{className:"px-3 py-1.5 text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:"Gestor de pedidos"}),v.map(({id:p,label:w,icon:L})=>e.jsxs("button",{onClick:()=>s(p),className:E(p),children:[e.jsx(L,{className:"w-4 h-4 flex-shrink-0"}),w]},p)),e.jsx("p",{className:"px-3 py-1.5 mt-4 text-[10px] font-semibold text-gray-400 uppercase tracking-wider",children:"Conta"}),g.map(({id:p,label:w,icon:L})=>e.jsxs("button",{onClick:()=>s(p),className:E(p),children:[e.jsx(L,{className:"w-4 h-4 flex-shrink-0"}),w]},p))]})}),e.jsxs("div",{className:"flex-1 min-w-0 bg-white border border-gray-200 rounded-lg p-5",children:[t==="alertas"&&e.jsx(pi,{}),t==="logistica"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Gest√£o Log√≠stica"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Tempo de preparo e alertas de inatividade."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Tempo de preparo manual"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Tempo estimado para preparar pedidos (minutos)"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(he,{type:"number",min:5,max:120,value:a.default_prep_time,onChange:p=>r(w=>({...w,default_prep_time:parseInt(p.target.value)||30})),className:"w-20 h-9 text-center"}),e.jsx("span",{className:"text-sm text-gray-500",children:"min"}),e.jsx(Te,{checked:a.prep_time_manual_enabled!==!1,onCheckedChange:p=>r(w=>({...w,prep_time_manual_enabled:p}))})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Permitir alterar por pedido"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ao aceitar, poder alterar o tempo daquele pedido"})]}),e.jsx(Te,{checked:a.can_alter_prep_per_order!==!1,onCheckedChange:p=>r(w=>({...w,can_alter_prep_per_order:p}))})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Est√° a√≠? (alerta de inatividade)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ap√≥s N minutos sem intera√ß√£o, avisar"})]}),e.jsx(Te,{checked:a.are_you_there_enabled===!0,onCheckedChange:p=>r(w=>({...w,are_you_there_enabled:p}))})]}),a.are_you_there_enabled&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(se,{className:"text-sm font-medium text-gray-700",children:"Ap√≥s quantos minutos?"}),e.jsx("select",{value:a.are_you_there_minutes||15,onChange:p=>r(w=>({...w,are_you_there_minutes:parseInt(p.target.value)})),className:"border rounded-md px-2.5 py-1.5 text-sm w-28",children:[5,10,15,20,30,45,60].map(p=>e.jsxs("option",{value:p,children:[p," min"]},p))})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg space-y-3",children:[e.jsxs("div",{children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Pedidos atrasados (ap√≥s tempo de preparo)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Quando o pedido passar do tempo de preparo + margem, o que fazer?"})]}),e.jsxs("select",{value:a.auto_cancel_mode||"off",onChange:p=>r(w=>({...w,auto_cancel_mode:p.target.value})),className:"border rounded-md px-2.5 py-1.5 text-sm w-full max-w-xs",children:[e.jsx("option",{value:"off",children:"Desligado"}),e.jsx("option",{value:"alert",children:"S√≥ alertar (toast)"}),e.jsx("option",{value:"cancel",children:"Cancelar automaticamente"})]}),(a.auto_cancel_mode==="alert"||a.auto_cancel_mode==="cancel")&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"text-sm text-gray-700",children:"Margem ap√≥s o tempo de preparo (min):"}),e.jsx(he,{type:"number",min:0,max:60,value:a.auto_cancel_minutes??10,onChange:p=>r(w=>({...w,auto_cancel_minutes:parseInt(p.target.value)||10})),className:"w-20 h-9 text-center"})]})]}),e.jsxs(O,{onClick:m,className:"bg-orange-500 hover:bg-orange-600",children:[e.jsx(Ft,{className:"w-4 h-4 mr-2"})," Salvar"]})]}),t==="impressao"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Impress√£o"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Impressora e extens√£o para imprimir pedidos."})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Impress√£o autom√°tica"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Imprimir ao aceitar pedido"})]}),e.jsx(Te,{checked:a.auto_print,onCheckedChange:p=>r(w=>({...w,auto_print:p}))})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Extens√£o da impressora"}),e.jsx(ie,{variant:"outline",className:"bg-red-50 text-red-600 border-red-200",children:"Extens√£o fechada"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"A extens√£o permite enviar pedidos direto para a impressora. Informa√ß√£o atualizada a cada 30 segundos."}),e.jsx("a",{href:"#baixar-extensao",className:"text-sm font-medium text-orange-600 hover:underline",children:"Baixar extens√£o"})]}),e.jsxs(O,{onClick:m,className:"bg-orange-500 hover:bg-orange-600",children:[e.jsx(Ft,{className:"w-4 h-4 mr-2"})," Salvar"]})]}),t==="templates"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Templates de Mensagem"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Respostas r√°pidas para clientes."})]}),e.jsx("div",{className:"space-y-2",children:i.map(p=>e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900 truncate",children:p.title}),e.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:p.message})]}),e.jsx(O,{size:"icon",variant:"ghost",className:"h-8 w-8 text-red-500",onClick:()=>h.mutate(p.id),children:e.jsx(tn,{className:"w-4 h-4"})})]},p.id))}),e.jsxs("div",{className:"border-t pt-4 space-y-2",children:[e.jsx(he,{placeholder:"T√≠tulo",value:l.title,onChange:p=>y(w=>({...w,title:p.target.value}))}),e.jsx(dt,{placeholder:"Mensagem",value:l.message,onChange:p=>y(w=>({...w,message:p.target.value})),className:"min-h-[80px]"}),e.jsxs(O,{onClick:R,variant:"outline",children:[e.jsx(xs,{className:"w-4 h-4 mr-2"})," Adicionar"]})]})]}),t==="horarios"&&c&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Hor√°rio de Funcionamento"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Exibido no card√°pio e no gestor."})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Abertura:"}),e.jsx("span",{className:"font-medium",children:c.opening_time||"08:00"})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Fechamento:"}),e.jsx("span",{className:"font-medium",children:c.closing_time||"18:00"})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Dias:"}),e.jsx("span",{className:"font-medium",children:(c.working_days||[1,2,3,4,5]).map(p=>["Dom","Seg","Ter","Qua","Qui","Sex","S√°b"][p]).join(", ")})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:c.is_open?"text-green-600 font-medium":"text-red-600 font-medium",children:c.is_open?"Aberto":"Fechado"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Para alterar, acesse as configura√ß√µes da loja no painel administrativo."})]}),t==="lojas"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Gest√£o de lojas"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Recebimento e aceite de pedidos."})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Aceite autom√°tico de pedidos"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Aceitar e imprimir automaticamente. Configure a impressora em Ajustes > Impress√£o."})]}),e.jsx(Te,{checked:a.auto_accept,onCheckedChange:p=>r(w=>({...w,auto_accept:p}))})]}),e.jsxs(O,{onClick:m,className:"bg-orange-500 hover:bg-orange-600",children:[e.jsx(Ft,{className:"w-4 h-4 mr-2"})," Salvar"]})]}),t==="conta"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Minha conta"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Trocar de conta ou encerrar sess√£o."})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Trocar de conta"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Encerre a sess√£o para acessar com outra conta."}),e.jsxs("button",{type:"button",onClick:k,className:"mt-2 flex items-center gap-2 text-sm font-medium text-orange-600 hover:text-orange-700",children:[e.jsx(sn,{className:"w-4 h-4"})," Sair da conta"]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx(se,{className:"text-sm font-medium text-gray-900",children:"Sistema"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use se a vers√£o antiga continuar em cache."}),e.jsx("button",{type:"button",onClick:async()=>{try{const p=await navigator.serviceWorker?.getRegistrations?.()||[];for(const w of p)await w.unregister();if("caches"in window){const w=await caches.keys();await Promise.all(w.filter(L=>L!=="meta-json").map(L=>caches.delete(L)))}B.success("Cache limpo. Recarregando..."),window.location.reload()}catch{B.error("Erro ao limpar cache")}},className:"mt-2 text-sm text-orange-600 hover:underline",children:"Limpar cache e recarregar"})]})]})]})]})}var fi=["points","className","baseLinePoints","connectNulls"];function lt(){return lt=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},lt.apply(this,arguments)}function bi(t,s){if(t==null)return{};var a=yi(t,s),r,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function yi(t,s){if(t==null)return{};var a={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(s.indexOf(r)>=0)continue;a[r]=t[r]}return a}function Qs(t){return wi(t)||Ni(t)||ji(t)||vi()}function vi(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ji(t,s){if(t){if(typeof t=="string")return ys(t,s);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ys(t,s)}}function Ni(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function wi(t){if(Array.isArray(t))return ys(t)}function ys(t,s){(s==null||s>t.length)&&(s=t.length);for(var a=0,r=new Array(s);a<s;a++)r[a]=t[a];return r}var Ws=function(s){return s&&s.x===+s.x&&s.y===+s.y},_i=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=[[]];return s.forEach(function(r){Ws(r)?a[a.length-1].push(r):a[a.length-1].length>0&&a.push([])}),Ws(s[0])&&a[a.length-1].push(s[0]),a[a.length-1].length<=0&&(a=a.slice(0,-1)),a},St=function(s,a){var r=_i(s);a&&(r=[r.reduce(function(i,o){return[].concat(Qs(i),Qs(o))},[])]);var n=r.map(function(i){return i.reduce(function(o,c,m){return"".concat(o).concat(m===0?"M":"L").concat(c.x,",").concat(c.y)},"")}).join("");return r.length===1?"".concat(n,"Z"):n},Si=function(s,a,r){var n=St(s,r);return"".concat(n.slice(-1)==="Z"?n.slice(0,-1):n,"L").concat(St(a.reverse(),r).slice(1))},ki=function(s){var a=s.points,r=s.className,n=s.baseLinePoints,i=s.connectNulls,o=bi(s,fi);if(!a||!a.length)return null;var c=Ke("recharts-polygon",r);if(n&&n.length){var m=o.stroke&&o.stroke!=="none",x=Si(a,n,i);return K.createElement("g",{className:c},K.createElement("path",lt({},pe(o,!0),{fill:x.slice(-1)==="Z"?o.fill:"none",stroke:"none",d:x})),m?K.createElement("path",lt({},pe(o,!0),{fill:"none",d:St(a,i)})):null,m?K.createElement("path",lt({},pe(o,!0),{fill:"none",d:St(n,i)})):null)}var h=St(a,i);return K.createElement("path",lt({},pe(o,!0),{fill:h.slice(-1)==="Z"?o.fill:"none",className:c,d:h}))},os,Ys;function Ci(){if(Ys)return os;Ys=1;var t=ha(),s=br(),a=pa();function r(n,i){return n&&n.length?t(n,a(i,2),s):void 0}return os=r,os}var Ei=Ci();const Ai=da(Ei);var ls,Js;function Pi(){if(Js)return ls;Js=1;var t=ha(),s=pa(),a=yr();function r(n,i){return n&&n.length?t(n,s(i,2),a):void 0}return ls=r,ls}var Oi=Pi();const Ri=da(Oi);var Di=["cx","cy","angle","ticks","axisLine"],Mi=["ticks","tick","angle","tickFormatter","stroke"];function ht(t){"@babel/helpers - typeof";return ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},ht(t)}function kt(){return kt=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},kt.apply(this,arguments)}function Xs(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,r)}return a}function Ye(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Xs(Object(a),!0).forEach(function(r){Qt(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Xs(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function Zs(t,s){if(t==null)return{};var a=Ti(t,s),r,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Ti(t,s){if(t==null)return{};var a={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(s.indexOf(r)>=0)continue;a[r]=t[r]}return a}function $i(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function ea(t,s){for(var a=0;a<s.length;a++){var r=s[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ha(r.key),r)}}function Ii(t,s,a){return s&&ea(t.prototype,s),a&&ea(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function Li(t,s,a){return s=Vt(s),Fi(t,Va()?Reflect.construct(s,a||[],Vt(t).constructor):s.apply(t,a))}function Fi(t,s){if(s&&(ht(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zi(t)}function zi(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Va(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Va=function(){return!!t})()}function Vt(t){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Vt(t)}function Bi(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&vs(t,s)}function vs(t,s){return vs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},vs(t,s)}function Qt(t,s,a){return s=Ha(s),s in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function Ha(t){var s=qi(t,"string");return ht(s)=="symbol"?s:s+""}function qi(t,s){if(ht(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(ht(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Wt=(function(t){function s(){return $i(this,s),Li(this,s,arguments)}return Bi(s,t),Ii(s,[{key:"getTickValueCoord",value:function(r){var n=r.coordinate,i=this.props,o=i.angle,c=i.cx,m=i.cy;return Ie(c,m,n,o)}},{key:"getTickTextAnchor",value:function(){var r=this.props.orientation,n;switch(r){case"left":n="end";break;case"right":n="start";break;default:n="middle";break}return n}},{key:"getViewBox",value:function(){var r=this.props,n=r.cx,i=r.cy,o=r.angle,c=r.ticks,m=Ai(c,function(h){return h.coordinate||0}),x=Ri(c,function(h){return h.coordinate||0});return{cx:n,cy:i,startAngle:o,endAngle:o,innerRadius:x.coordinate||0,outerRadius:m.coordinate||0}}},{key:"renderAxisLine",value:function(){var r=this.props,n=r.cx,i=r.cy,o=r.angle,c=r.ticks,m=r.axisLine,x=Zs(r,Di),h=c.reduce(function(k,v){return[Math.min(k[0],v.coordinate),Math.max(k[1],v.coordinate)]},[1/0,-1/0]),l=Ie(n,i,h[0],o),y=Ie(n,i,h[1],o),R=Ye(Ye(Ye({},pe(x,!1)),{},{fill:"none"},pe(m,!1)),{},{x1:l.x,y1:l.y,x2:y.x,y2:y.y});return K.createElement("line",kt({className:"recharts-polar-radius-axis-line"},R))}},{key:"renderTicks",value:function(){var r=this,n=this.props,i=n.ticks,o=n.tick,c=n.angle,m=n.tickFormatter,x=n.stroke,h=Zs(n,Mi),l=this.getTickTextAnchor(),y=pe(h,!1),R=pe(o,!1),k=i.map(function(v,g){var E=r.getTickValueCoord(v),p=Ye(Ye(Ye(Ye({textAnchor:l,transform:"rotate(".concat(90-c,", ").concat(E.x,", ").concat(E.y,")")},y),{},{stroke:"none",fill:x},R),{},{index:g},E),{},{payload:v});return K.createElement(ke,kt({className:Ke("recharts-polar-radius-axis-tick",ga(o)),key:"tick-".concat(v.coordinate)},ks(r.props,v,g)),s.renderTickItem(o,p,m?m(v.value,g):v.value))});return K.createElement(ke,{className:"recharts-polar-radius-axis-ticks"},k)}},{key:"render",value:function(){var r=this.props,n=r.ticks,i=r.axisLine,o=r.tick;return!n||!n.length?null:K.createElement(ke,{className:Ke("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),o&&this.renderTicks(),fa.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(r,n,i){var o;return K.isValidElement(r)?o=K.cloneElement(r,n):Xe(r)?o=r(n):o=K.createElement(Ss,kt({},n,{className:"recharts-polar-radius-axis-tick-value"}),i),o}}])})(u.PureComponent);Qt(Wt,"displayName","PolarRadiusAxis");Qt(Wt,"axisType","radiusAxis");Qt(Wt,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function pt(t){"@babel/helpers - typeof";return pt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},pt(t)}function Ze(){return Ze=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},Ze.apply(this,arguments)}function ta(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,r)}return a}function Je(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ta(Object(a),!0).forEach(function(r){Yt(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ta(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function Ki(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function sa(t,s){for(var a=0;a<s.length;a++){var r=s[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ga(r.key),r)}}function Vi(t,s,a){return s&&sa(t.prototype,s),a&&sa(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hi(t,s,a){return s=Ht(s),Ui(t,Ua()?Reflect.construct(s,a||[],Ht(t).constructor):s.apply(t,a))}function Ui(t,s){if(s&&(pt(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gi(t)}function Gi(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ua(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ua=function(){return!!t})()}function Ht(t){return Ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Ht(t)}function Qi(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&js(t,s)}function js(t,s){return js=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},js(t,s)}function Yt(t,s,a){return s=Ga(s),s in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function Ga(t){var s=Wi(t,"string");return pt(s)=="symbol"?s:s+""}function Wi(t,s){if(pt(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(pt(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Yi=Math.PI/180,aa=1e-5,Jt=(function(t){function s(){return Ki(this,s),Hi(this,s,arguments)}return Qi(s,t),Vi(s,[{key:"getTickLineCoord",value:function(r){var n=this.props,i=n.cx,o=n.cy,c=n.radius,m=n.orientation,x=n.tickSize,h=x||8,l=Ie(i,o,c,r.coordinate),y=Ie(i,o,c+(m==="inner"?-1:1)*h,r.coordinate);return{x1:l.x,y1:l.y,x2:y.x,y2:y.y}}},{key:"getTickTextAnchor",value:function(r){var n=this.props.orientation,i=Math.cos(-r.coordinate*Yi),o;return i>aa?o=n==="outer"?"start":"end":i<-aa?o=n==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var r=this.props,n=r.cx,i=r.cy,o=r.radius,c=r.axisLine,m=r.axisLineType,x=Je(Je({},pe(this.props,!1)),{},{fill:"none"},pe(c,!1));if(m==="circle")return K.createElement(vr,Ze({className:"recharts-polar-angle-axis-line"},x,{cx:n,cy:i,r:o}));var h=this.props.ticks,l=h.map(function(y){return Ie(n,i,o,y.coordinate)});return K.createElement(ki,Ze({className:"recharts-polar-angle-axis-line"},x,{points:l}))}},{key:"renderTicks",value:function(){var r=this,n=this.props,i=n.ticks,o=n.tick,c=n.tickLine,m=n.tickFormatter,x=n.stroke,h=pe(this.props,!1),l=pe(o,!1),y=Je(Je({},h),{},{fill:"none"},pe(c,!1)),R=i.map(function(k,v){var g=r.getTickLineCoord(k),E=r.getTickTextAnchor(k),p=Je(Je(Je({textAnchor:E},h),{},{stroke:"none",fill:x},l),{},{index:v,payload:k,x:g.x2,y:g.y2});return K.createElement(ke,Ze({className:Ke("recharts-polar-angle-axis-tick",ga(o)),key:"tick-".concat(k.coordinate)},ks(r.props,k,v)),c&&K.createElement("line",Ze({className:"recharts-polar-angle-axis-tick-line"},y,g)),o&&s.renderTickItem(o,p,m?m(k.value,v):k.value))});return K.createElement(ke,{className:"recharts-polar-angle-axis-ticks"},R)}},{key:"render",value:function(){var r=this.props,n=r.ticks,i=r.radius,o=r.axisLine;return i<=0||!n||!n.length?null:K.createElement(ke,{className:Ke("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(r,n,i){var o;return K.isValidElement(r)?o=K.cloneElement(r,n):Xe(r)?o=r(n):o=K.createElement(Ss,Ze({},n,{className:"recharts-polar-angle-axis-tick-value"}),i),o}}])})(u.PureComponent);Yt(Jt,"displayName","PolarAngleAxis");Yt(Jt,"axisType","angleAxis");Yt(Jt,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var Bt;function gt(t){"@babel/helpers - typeof";return gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},gt(t)}function ct(){return ct=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},ct.apply(this,arguments)}function ra(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,r)}return a}function ne(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ra(Object(a),!0).forEach(function(r){ye(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ra(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function Ji(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function na(t,s){for(var a=0;a<s.length;a++){var r=s[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wa(r.key),r)}}function Xi(t,s,a){return s&&na(t.prototype,s),a&&na(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zi(t,s,a){return s=Ut(s),eo(t,Qa()?Reflect.construct(s,a||[],Ut(t).constructor):s.apply(t,a))}function eo(t,s){if(s&&(gt(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return to(t)}function to(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qa(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Qa=function(){return!!t})()}function Ut(t){return Ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Ut(t)}function so(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&Ns(t,s)}function Ns(t,s){return Ns=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Ns(t,s)}function ye(t,s,a){return s=Wa(s),s in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function Wa(t){var s=ao(t,"string");return gt(s)=="symbol"?s:s+""}function ao(t,s){if(gt(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(gt(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Fe=(function(t){function s(a){var r;return Ji(this,s),r=Zi(this,s,[a]),ye(r,"pieRef",null),ye(r,"sectorRefs",[]),ye(r,"id",Cr("recharts-pie-")),ye(r,"handleAnimationEnd",function(){var n=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Xe(n)&&n()}),ye(r,"handleAnimationStart",function(){var n=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Xe(n)&&n()}),r.state={isAnimationFinished:!a.isAnimationActive,prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,sectorToFocus:0},r}return so(s,t),Xi(s,[{key:"isActiveIndex",value:function(r){var n=this.props.activeIndex;return Array.isArray(n)?n.indexOf(r)!==-1:r===n}},{key:"hasActiveIndex",value:function(){var r=this.props.activeIndex;return Array.isArray(r)?r.length!==0:r||r===0}},{key:"renderLabels",value:function(r){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.label,c=i.labelLine,m=i.dataKey,x=i.valueKey,h=pe(this.props,!1),l=pe(o,!1),y=pe(c,!1),R=o&&o.offsetRadius||20,k=r.map(function(v,g){var E=(v.startAngle+v.endAngle)/2,p=Ie(v.cx,v.cy,v.outerRadius+R,E),w=ne(ne(ne(ne({},h),v),{},{stroke:"none"},l),{},{index:g,textAnchor:s.getTextAnchor(p.x,v.cx)},p),L=ne(ne(ne(ne({},h),v),{},{fill:"none",stroke:v.fill},y),{},{index:g,points:[Ie(v.cx,v.cy,v.outerRadius,E),p]}),d=m;return mt(m)&&mt(x)?d="value":mt(m)&&(d=x),K.createElement(ke,{key:"label-".concat(v.startAngle,"-").concat(v.endAngle,"-").concat(v.midAngle,"-").concat(g)},c&&s.renderLabelLineItem(c,L,"line"),s.renderLabelItem(o,w,nt(v,d)))});return K.createElement(ke,{className:"recharts-pie-labels"},k)}},{key:"renderSectorsStatically",value:function(r){var n=this,i=this.props,o=i.activeShape,c=i.blendStroke,m=i.inactiveShape;return r.map(function(x,h){if(x?.startAngle===0&&x?.endAngle===0&&r.length!==1)return null;var l=n.isActiveIndex(h),y=m&&n.hasActiveIndex()?m:null,R=l?o:y,k=ne(ne({},x),{},{stroke:c?x.fill:x.stroke,tabIndex:-1});return K.createElement(ke,ct({ref:function(g){g&&!n.sectorRefs.includes(g)&&n.sectorRefs.push(g)},tabIndex:-1,className:"recharts-pie-sector"},ks(n.props,x,h),{key:"sector-".concat(x?.startAngle,"-").concat(x?.endAngle,"-").concat(x.midAngle,"-").concat(h)}),K.createElement(Nr,ct({option:R,isActive:l,shapeType:"sector"},k)))})}},{key:"renderSectorsWithAnimation",value:function(){var r=this,n=this.props,i=n.sectors,o=n.isAnimationActive,c=n.animationBegin,m=n.animationDuration,x=n.animationEasing,h=n.animationId,l=this.state,y=l.prevSectors,R=l.prevIsAnimationActive;return K.createElement(wr,{begin:c,duration:m,isActive:o,easing:x,from:{t:0},to:{t:1},key:"pie-".concat(h,"-").concat(R),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(k){var v=k.t,g=[],E=i&&i[0],p=E.startAngle;return i.forEach(function(w,L){var d=y&&y[L],M=L>0?_r(w,"paddingAngle",0):0;if(d){var S=Is(d.endAngle-d.startAngle,w.endAngle-w.startAngle),P=ne(ne({},w),{},{startAngle:p+M,endAngle:p+S(v)+M});g.push(P),p=P.endAngle}else{var A=w.endAngle,b=w.startAngle,D=Is(0,A-b),z=D(v),V=ne(ne({},w),{},{startAngle:p+M,endAngle:p+z+M});g.push(V),p=V.endAngle}}),K.createElement(ke,null,r.renderSectorsStatically(g))})}},{key:"attachKeyboardHandlers",value:function(r){var n=this;r.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var o=++n.state.sectorToFocus%n.sectorRefs.length;n.sectorRefs[o].focus(),n.setState({sectorToFocus:o});break}case"ArrowRight":{var c=--n.state.sectorToFocus<0?n.sectorRefs.length-1:n.state.sectorToFocus%n.sectorRefs.length;n.sectorRefs[c].focus(),n.setState({sectorToFocus:c});break}case"Escape":{n.sectorRefs[n.state.sectorToFocus].blur(),n.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var r=this.props,n=r.sectors,i=r.isAnimationActive,o=this.state.prevSectors;return i&&n&&n.length&&(!o||!Sr(o,n))?this.renderSectorsWithAnimation():this.renderSectorsStatically(n)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var r=this,n=this.props,i=n.hide,o=n.sectors,c=n.className,m=n.label,x=n.cx,h=n.cy,l=n.innerRadius,y=n.outerRadius,R=n.isAnimationActive,k=this.state.isAnimationFinished;if(i||!o||!o.length||!it(x)||!it(h)||!it(l)||!it(y))return null;var v=Ke("recharts-pie",c);return K.createElement(ke,{tabIndex:this.props.rootTabIndex,className:v,ref:function(E){r.pieRef=E}},this.renderSectors(),m&&this.renderLabels(o),fa.renderCallByParent(this.props,null,!1),(!R||k)&&kr.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(r,n){return n.prevIsAnimationActive!==r.isAnimationActive?{prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:[],isAnimationFinished:!0}:r.isAnimationActive&&r.animationId!==n.prevAnimationId?{prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:n.curSectors,isAnimationFinished:!0}:r.sectors!==n.curSectors?{curSectors:r.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(r,n){return r>n?"start":r<n?"end":"middle"}},{key:"renderLabelLineItem",value:function(r,n,i){if(K.isValidElement(r))return K.cloneElement(r,n);if(Xe(r))return r(n);var o=Ke("recharts-pie-label-line",typeof r!="boolean"?r.className:"");return K.createElement(jr,ct({},n,{key:i,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(r,n,i){if(K.isValidElement(r))return K.cloneElement(r,n);var o=i;if(Xe(r)&&(o=r(n),K.isValidElement(o)))return o;var c=Ke("recharts-pie-label-text",typeof r!="boolean"&&!Xe(r)?r.className:"");return K.createElement(Ss,ct({},n,{alignmentBaseline:"middle",className:c}),o)}}])})(u.PureComponent);Bt=Fe;ye(Fe,"displayName","Pie");ye(Fe,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Er.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});ye(Fe,"parseDeltaAngle",function(t,s){var a=It(s-t),r=Math.min(Math.abs(s-t),360);return a*r});ye(Fe,"getRealPieData",function(t){var s=t.data,a=t.children,r=pe(t,!1),n=Ar(a,ba);return s&&s.length?s.map(function(i,o){return ne(ne(ne({payload:i},r),i),n&&n[o]&&n[o].props)}):n&&n.length?n.map(function(i){return ne(ne({},r),i.props)}):[]});ye(Fe,"parseCoordinateOfPie",function(t,s){var a=s.top,r=s.left,n=s.width,i=s.height,o=Pr(n,i),c=r+Tt(t.cx,n,n/2),m=a+Tt(t.cy,i,i/2),x=Tt(t.innerRadius,o,0),h=Tt(t.outerRadius,o,o*.8),l=t.maxRadius||Math.sqrt(n*n+i*i)/2;return{cx:c,cy:m,innerRadius:x,outerRadius:h,maxRadius:l}});ye(Fe,"getComposedData",function(t){var s=t.item,a=t.offset,r=s.type.defaultProps!==void 0?ne(ne({},s.type.defaultProps),s.props):s.props,n=Bt.getRealPieData(r);if(!n||!n.length)return null;var i=r.cornerRadius,o=r.startAngle,c=r.endAngle,m=r.paddingAngle,x=r.dataKey,h=r.nameKey,l=r.valueKey,y=r.tooltipType,R=Math.abs(r.minAngle),k=Bt.parseCoordinateOfPie(r,a),v=Bt.parseDeltaAngle(o,c),g=Math.abs(v),E=x;mt(x)&&mt(l)?(Ls(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),E="value"):mt(x)&&(Ls(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),E=l);var p=n.filter(function(P){return nt(P,E,0)!==0}).length,w=(g>=360?p:p-1)*m,L=g-p*R-w,d=n.reduce(function(P,A){var b=nt(A,E,0);return P+(it(b)?b:0)},0),M;if(d>0){var S;M=n.map(function(P,A){var b=nt(P,E,0),D=nt(P,h,A),z=(it(b)?b:0)/d,V;A?V=S.endAngle+It(v)*m*(b!==0?1:0):V=o;var ae=V+It(v)*((b!==0?R:0)+z*L),Z=(V+ae)/2,oe=(k.innerRadius+k.outerRadius)/2,le=[{name:D,value:b,payload:P,dataKey:E,type:y}],ee=Ie(k.cx,k.cy,oe,Z);return S=ne(ne(ne({percent:z,cornerRadius:i,name:D,tooltipPayload:le,midAngle:Z,middleRadius:oe,tooltipPosition:ee},P),k),{},{value:nt(P,E),startAngle:V,endAngle:ae,payload:P,paddingAngle:It(v)*m}),S})}return ne(ne({},k),{},{sectors:M,data:n})});var ro=Or({chartName:"PieChart",GraphicalChild:Fe,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Jt},{axisType:"radiusAxis",AxisComp:Wt}],formatAxisMap:Rr,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});function no({orders:t=[],entregadores:s=[],darkMode:a=!1}){const r=Array.isArray(t)?t:[],n=Array.isArray(s)?s:[],i=M=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(M||0),{todayOrders:o,yesterdayOrders:c,totalRevenue:m,pendingOrders:x,inDelivery:h,avgPrepTime:l,activeEntregadores:y,ticketMedio:R,stats:k,chartByHour:v,pieData:g,concludedOrdersCurrentMonth:E,concludedOrdersLastMonth:p,diffFromLastMonth:w}=u.useMemo(()=>{const M=new Date;M.setHours(0,0,0,0);const S=new Date(M);S.setDate(S.getDate()-1);const P=new Date(M);P.setDate(P.getDate()+1);const A=r.filter(C=>{const $=new Date(C.created_date);return $>=M&&$<P}),b=r.filter(C=>{const $=new Date(C.created_date);return $>=S&&$<M}),D=A.filter(C=>C.status==="delivered"),z=D.reduce((C,$)=>C+($.total||0),0),V=D.length>0?z/D.length:0,ae=r.filter(C=>["new","accepted","preparing"].includes(C.status)).length,Z=r.filter(C=>["out_for_delivery","going_to_store","picked_up"].includes(C.status)).length,oe=A.filter(C=>C.accepted_at&&C.ready_at),le=oe.length>0?oe.reduce((C,$)=>C+(new Date($.ready_at)-new Date($.accepted_at))/6e4,0)/oe.length:0,ee=s.filter(C=>C.status==="available"||C.status==="busy").length,_=new Date,F=new Date(_.getFullYear(),_.getMonth(),1),U=new Date(_.getFullYear(),_.getMonth()-1,1),te=r.filter(C=>C.status!=="delivered"?!1:new Date(C.delivered_at||C.created_date)>=F).length,G=r.filter(C=>{if(C.status!=="delivered")return!1;const $=new Date(C.delivered_at||C.created_date);return $>=U&&$<F}).length,N=G>0?((te-G)/G*100).toFixed(1):null,j=b.length,H=A.length,J=j>0?((H-j)/j*100).toFixed(0):null,re=b.filter(C=>C.status==="delivered").reduce((C,$)=>C+($.total||0),0),be=re>0?((z-re)/re*100).toFixed(0):null,tt=[{label:"Pedidos Hoje",value:H,icon:ve,color:"blue",change:J!=null?`${Number(J)>=0?"+":""}${J}%`:null,trend:J!=null?Number(J)>=0?"up":"down":"neutral",subtitle:`${ae} pendentes`},{label:"Receita Hoje",value:i(z),icon:At,color:"green",change:be!=null?`${Number(be)>=0?"+":""}${be}%`:null,trend:be!=null?Number(be)>=0?"up":"down":"neutral",subtitle:`${D.length} entregues`},{label:"Ticket M√©dio",value:i(V),icon:ya,color:"purple",change:null,trend:"neutral",subtitle:"Por pedido entregue"},{label:"Tempo M√©dio",value:`${Math.round(le)}min`,icon:Le,color:"slate",change:null,trend:"neutral",subtitle:"Tempo de preparo"},{label:"Em Entrega",value:Z,icon:$e,color:"orange",change:null,trend:"neutral",subtitle:`${ee} ativos`}],st=Array.from({length:24},(C,$)=>({hora:`${$}h`,quantidade:0}));A.forEach(C=>{const $=new Date(C.created_date).getHours();st[$].quantidade+=1});const yt=st.map((C,$)=>({...C,name:`${$}:00`})),vt=A.filter(C=>["new","accepted","preparing"].includes(C.status)).length,at=A.filter(C=>["ready","going_to_store","arrived_at_store","picked_up"].includes(C.status)).length,f=A.filter(C=>["out_for_delivery","arrived_at_customer"].includes(C.status)).length,q=A.filter(C=>C.status==="delivered").length,Q=[{name:"Em preparo",value:vt,color:"#f97316"},{name:"Prontos",value:at,color:"#22c55e"},{name:"Em rota",value:f,color:"#3b82f6"},{name:"Entregues",value:q,color:"#64748b"}].filter(C=>C.value>0);return{todayOrders:A,yesterdayOrders:b,totalRevenue:z,pendingOrders:ae,inDelivery:Z,avgPrepTime:le,activeEntregadores:ee,ticketMedio:V,stats:tt,chartByHour:yt,pieData:Q,concludedOrdersCurrentMonth:te,concludedOrdersLastMonth:G,diffFromLastMonth:N}},[r,n]),L={blue:a?"from-blue-900/50 to-blue-800/30 border-blue-700":"from-blue-50 to-blue-100 border-blue-200",green:a?"from-green-900/50 to-green-800/30 border-green-700":"from-green-50 to-green-100 border-green-200",purple:a?"from-purple-900/50 to-purple-800/30 border-purple-700":"from-purple-50 to-purple-100 border-purple-200",slate:a?"from-slate-900/50 to-slate-800/30 border-slate-700":"from-slate-50 to-slate-100 border-slate-200",orange:a?"from-orange-900/50 to-orange-800/30 border-orange-700":"from-orange-50 to-orange-100 border-orange-200"},d={blue:"text-blue-600",green:"text-green-600",purple:"text-purple-600",slate:"text-slate-600",orange:"text-orange-600"};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold ${a?"text-white":"text-gray-900"}`,children:"Estat√≠sticas em Tempo Real"}),e.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"}`,children:"Vis√£o geral do desempenho de hoje"})]}),e.jsxs(ie,{className:"bg-green-500 text-white",children:[e.jsx(Kt,{className:"w-3 h-3 mr-1"})," Ao vivo"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:k.map((M,S)=>{const P=M.icon;return e.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:S*.05},whileHover:{scale:1.02,y:-2},className:`bg-gradient-to-br ${L[M.color]} border rounded-2xl p-4 backdrop-blur-sm`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(P,{className:`w-5 h-5 ${d[M.color]}`}),M.trend!=="neutral"&&M.change&&e.jsx("span",{className:`text-xs font-medium ${M.trend==="up"?"text-green-600":"text-red-600"}`,children:M.change})]}),e.jsx("p",{className:`text-xl lg:text-2xl font-bold ${a?"text-white":"text-gray-900"} mb-1`,children:M.value}),e.jsx("p",{className:`text-xs ${a?"text-gray-400":"text-gray-600"} mb-1`,children:M.label}),M.subtitle&&e.jsx("p",{className:"text-[10px] text-gray-500",children:M.subtitle})]},M.label)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:`${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border rounded-2xl p-4`,children:[e.jsx("h3",{className:`font-bold mb-3 ${a?"text-white":"text-gray-900"}`,children:"Pedidos por hora (hoje)"}),e.jsx("div",{className:"h-[200px]",children:e.jsx(Fs,{width:"100%",height:"100%",children:e.jsxs(Dr,{data:v,margin:{top:5,right:5,left:-20,bottom:5},children:[e.jsx(Mr,{dataKey:"hora",tick:{fontSize:10},stroke:a?"#9ca3af":"#6b7280"}),e.jsx(Tr,{tick:{fontSize:10},stroke:a?"#9ca3af":"#6b7280",allowDecimals:!1}),e.jsx(zs,{contentStyle:{fontSize:12,borderRadius:8},formatter:M=>[M,"Pedidos"]}),e.jsx($r,{dataKey:"quantidade",fill:"#ef4444",radius:[4,4,0,0]})]})})})]}),e.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},className:`${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border rounded-2xl p-4`,children:[e.jsx("h3",{className:`font-bold mb-3 ${a?"text-white":"text-gray-900"}`,children:"Status (hoje)"}),e.jsx("div",{className:"h-[200px]",children:g.length>0?e.jsx(Fs,{width:"100%",height:"100%",children:e.jsxs(ro,{children:[e.jsx(Fe,{data:g,cx:"50%",cy:"50%",innerRadius:50,outerRadius:75,paddingAngle:2,dataKey:"value",children:g.map((M,S)=>e.jsx(ba,{fill:M.color},S))}),e.jsx(zs,{formatter:M=>[M,""]}),e.jsx(Ir,{fontSize:11})]})}):e.jsx("div",{className:`flex items-center justify-center h-full ${a?"text-gray-500":"text-gray-400"}`,children:"Nenhum pedido hoje"})})]})]}),e.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},className:`${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border rounded-2xl p-4`,children:[e.jsx("h3",{className:`font-bold mb-3 ${a?"text-white":"text-gray-900"}`,children:"Resumo do m√™s"}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-2xl font-bold ${a?"text-white":"text-gray-900"}`,children:E}),e.jsx("span",{className:`text-sm ml-1 ${a?"text-gray-400":"text-gray-600"}`,children:"conclu√≠dos este m√™s"})]}),e.jsxs("div",{className:`text-sm ${a?"text-gray-400":"text-gray-600"}`,children:["M√™s anterior: ",e.jsx("span",{className:"font-medium",children:p})]}),w!=null&&e.jsxs("span",{className:`text-sm font-medium ${Number(w)>=0?"text-green-600":"text-red-600"}`,children:[Number(w)>=0?"+":"",w,"% em rela√ß√£o ao m√™s passado"]})]})]}),e.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:`${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border rounded-2xl p-6`,children:[e.jsx("h3",{className:`font-bold text-lg mb-4 ${a?"text-white":"text-gray-900"}`,children:"Vis√£o Geral de Performance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${a?"text-gray-300":"text-gray-700"}`,children:"Taxa de Conclus√£o"}),e.jsxs("span",{className:`text-sm font-bold ${a?"text-white":"text-gray-900"}`,children:[o.length>0?(o.filter(M=>M.status==="delivered").length/o.length*100).toFixed(1):0,"%"]})]}),e.jsx(ns,{value:o.filter(M=>M.status==="delivered").length/Math.max(1,o.length)*100,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${a?"text-gray-300":"text-gray-700"}`,children:"Entregadores Ativos"}),e.jsxs("span",{className:`text-sm font-bold ${a?"text-white":"text-gray-900"}`,children:[y," / ",s.length]})]}),e.jsx(ns,{value:y/Math.max(1,s.length)*100,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${a?"text-gray-300":"text-gray-700"}`,children:"Pedidos Pendentes"}),e.jsx("span",{className:`text-sm font-bold ${a?"text-white":"text-gray-900"}`,children:x})]}),e.jsx(ns,{value:Math.min(100,x/Math.max(1,o.length)*100),className:"h-2"})]})]})]})]})}const io=1e4,oo=25e3,lo=35e3;function co(){(async()=>{try{const s=await navigator.serviceWorker?.getRegistrations?.()||[];for(const a of s)await a.unregister();if("caches"in window){const a=await caches.keys();await Promise.all(a.filter(r=>r!=="meta-json").map(r=>caches.delete(r)))}}catch{}window.location.reload()})()}function ia(){const[t,s]=u.useState(0);return u.useEffect(()=>{const a=setTimeout(()=>s(1),io),r=setTimeout(()=>s(2),oo),n=setTimeout(()=>s(3),lo);return()=>{clearTimeout(a),clearTimeout(r),clearTimeout(n)}},[]),e.jsxs("div",{className:"fixed inset-0 flex flex-col items-center justify-center bg-[#7a7775] z-[100]",children:[e.jsx("div",{className:"relative w-24 h-24 flex-shrink-0",children:e.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full","aria-hidden":"true",children:[e.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#f97316",strokeWidth:"7",strokeLinecap:"round",strokeDasharray:"70.69 70.69",style:{transformOrigin:"50px 50px",animation:"gestor-spin 1.7s linear infinite"}}),e.jsx("circle",{cx:"50",cy:"50",r:"37",fill:"none",stroke:"#ffedd5",strokeWidth:"7",strokeLinecap:"round",strokeDasharray:"58.12 58.12",strokeDashoffset:"39.27",style:{transformOrigin:"50px 50px",animation:"gestor-spin-rev 1.7s linear infinite"}})]})}),e.jsx("p",{className:"mt-4 text-white/90 text-sm",children:"Carregando Gestor de Pedidos..."}),e.jsxs("div",{className:"mt-6 text-center max-w-sm px-4",children:[t>=1&&e.jsx("p",{className:"text-[26px] font-bold text-white",children:"Isso est√° demorando mais que o esperado"}),t>=1&&t<2&&e.jsx("p",{className:"text-lg text-white/90 mt-1",children:"Estamos verificando o seu problema!"}),t>=2&&t<3&&e.jsx("p",{className:"text-lg text-white/90 mt-1",children:"Vamos reiniciar seu Gestor de Pedidos. Aguarde."}),t>=3&&e.jsx(O,{onClick:co,className:"rounded mt-4 bg-orange-500 hover:bg-orange-600 uppercase font-bold transition-all duration-100",children:"Recarregar"})]}),e.jsx("style",{children:`
        @keyframes gestor-spin { to { transform: rotate(360deg); } }
        @keyframes gestor-spin-rev { to { transform: rotate(-360deg); } }
        @media (prefers-reduced-motion: reduce) {
          [style*="animation: gestor-spin"] { animation: none; }
          [style*="animation: gestor-spin-rev"] { animation: none; }
        }
      `})]})}const mo=[{id:"atalhos",title:"Atalhos de teclado",description:"K: Quadros | D: Entregadores | R: Resumo | S: Ajustes | H: In√≠cio | N: S√≥ novos | 1-5: Status no modal | Ctrl+F: Buscar | Ctrl+R: Atualizar | Esc: Fechar",backgroundColor:"#f97316",contentFontColor:"#ffffff",internalRoute:null,externalUrl:null,order:1},{id:"cancelar",title:"Como cancelar um pedido",description:"Abra o pedido, Rejeitar, escolha o motivo e confirme. S√≥ em status Novo ou Aceito.",backgroundColor:"#7C609B",contentFontColor:"#ffffff",internalRoute:null,externalUrl:null,order:2},{id:"comandas",title:"Impress√£o de comandas",description:'Use "Imprimir" no pedido ou "Na fila" e depois "Imprimir X comanda(s)" no bot√£o flutuante.',backgroundColor:"#059669",contentFontColor:"#ffffff",internalRoute:null,externalUrl:null,order:3},{id:"notificacoes",title:"Notifica√ß√µes",description:"Em Ajustes ‚Üí Notifica√ß√µes: escolha o som, volume e em quais status deseja ser avisado.",backgroundColor:"#2563eb",contentFontColor:"#ffffff",internalRoute:"settings",externalUrl:null,order:4},{id:"tempo-preparo",title:"Tempo de preparo",description:"Tempo padr√£o em Ajustes. Ao aceitar, voc√™ pode alterar por pedido. O sistema sugere pela m√©dia.",backgroundColor:"#c2410c",contentFontColor:"#ffffff",internalRoute:"settings",externalUrl:null,order:5}],uo={atalhos:an,cancelar:us,comandas:Et,notificacoes:Pt,"tempo-preparo":Le};function xo({onNavigate:t}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vs,{className:"w-5 h-5 text-orange-500"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Dicas e atalhos"})]}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:mo.slice().sort((s,a)=>(s.order||0)-(a.order||0)).map(s=>{const a=uo[s.id]||Vs,r=()=>{s.internalRoute==="settings"&&t&&t("settings"),s.externalUrl&&window.open(s.externalUrl,"_blank")};return e.jsxs("button",{type:"button",onClick:r,className:"rounded-xl p-4 text-left transition hover:shadow-lg hover:scale-[1.02]",style:{backgroundColor:s.backgroundColor||"#f97316",color:s.contentFontColor||"#ffffff"},children:[e.jsx(a,{className:"w-6 h-6 mb-2 opacity-90"}),e.jsx("h3",{className:"font-bold text-sm mb-1",children:s.title}),e.jsx("p",{className:"text-xs opacity-90 leading-relaxed",children:s.description})]},s.id)})})]})}const cs="gestor_saved_filters",oa=[{value:"all",label:"Todos os Status"},{value:"new",label:"Novos"},{value:"accepted",label:"Aceitos"},{value:"preparing",label:"Em Preparo"},{value:"ready",label:"Prontos"},{value:"out_for_delivery",label:"Em Entrega"},{value:"delivered",label:"Entregues"},{value:"cancelled",label:"Cancelados"}],la=[{value:"today",label:"Hoje"},{value:"week",label:"Esta Semana"},{value:"month",label:"Este M√™s"},{value:"all",label:"Todos"}],ca=[{value:"all",label:"Qualquer hor√°rio"},{value:"11",label:"11h"},{value:"12",label:"12h"},{value:"13",label:"13h"},{value:"14",label:"14h"},{value:"18",label:"18h"},{value:"19",label:"19h"},{value:"20",label:"20h"},{value:"21",label:"21h"}];function ho({orders:t=[],onFilterChange:s,searchTerm:a,onSearchChange:r,entregadores:n=[]}){const[i,o]=u.useState(!1),[c,m]=u.useState([]),[x,h]=u.useState(""),[l,y]=u.useState({status:"all",period:"today",searchType:"code",entregador:"all",scheduledHour:"all",paymentMethod:"all",deliveryType:"all",minValue:"",maxValue:"",dateStart:"",dateEnd:"",productName:""}),R=[l.status,l.period,l.entregador,l.scheduledHour,l.paymentMethod,l.deliveryType,l.minValue,l.maxValue,l.dateStart,l.dateEnd,l.productName].filter(d=>d!=="all"&&d!=="today"&&d!=="").length,k=(d,M)=>{const S={...l,[d]:M};y(S),v(S)},v=d=>{let S=[...Array.isArray(t)?t:[]];d.status!=="all"&&(S=S.filter(b=>b.status===d.status));const P=b=>b.created_at||b.created_date,A=new Date;if(d.period==="today"){const b=new Date(A.getFullYear(),A.getMonth(),A.getDate());S=S.filter(D=>{const z=P(D);if(!z)return!0;const V=new Date(z);return isNaN(V.getTime())?!0:V>=b})}else if(d.period==="week"){const b=new Date(A.getTime()-6048e5);S=S.filter(D=>{const z=P(D);if(!z)return!0;const V=new Date(z);return!isNaN(V.getTime())&&V>=b})}else if(d.period==="month"){const b=new Date(A.getTime()-2592e6);S=S.filter(D=>{const z=P(D);if(!z)return!0;const V=new Date(z);return!isNaN(V.getTime())&&V>=b})}if(d.entregador&&d.entregador!=="all"&&(S=S.filter(b=>String(b.entregador_id)===String(d.entregador))),d.scheduledHour&&d.scheduledHour!=="all"&&(S=S.filter(b=>b.scheduled_time&&String(b.scheduled_time).slice(0,2)===String(d.scheduledHour))),d.paymentMethod&&d.paymentMethod!=="all"&&(S=S.filter(b=>b.payment_method===d.paymentMethod)),d.deliveryType&&d.deliveryType!=="all"&&(d.deliveryType==="delivery"?S=S.filter(b=>b.delivery_method==="delivery"):d.deliveryType==="pickup"&&(S=S.filter(b=>b.delivery_method==="pickup"||!b.delivery_method))),d.minValue&&!isNaN(parseFloat(d.minValue))){const b=parseFloat(d.minValue);S=S.filter(D=>(D.total||0)>=b)}if(d.maxValue&&!isNaN(parseFloat(d.maxValue))){const b=parseFloat(d.maxValue);S=S.filter(D=>(D.total||0)<=b)}if(d.dateStart){const b=new Date(d.dateStart);b.setHours(0,0,0,0),S=S.filter(D=>new Date(D.created_at||D.created_date)>=b)}if(d.dateEnd){const b=new Date(d.dateEnd);b.setHours(23,59,59,999),S=S.filter(D=>new Date(D.created_at||D.created_date)<=b)}d.productName&&(S=S.filter(b=>!b.items||!Array.isArray(b.items)?!1:b.items.some(D=>D.dish?.name?.toLowerCase().includes(d.productName.toLowerCase())))),a&&(d.searchType==="code"?S=S.filter(b=>b.order_code?.toLowerCase().includes(a.toLowerCase())):d.searchType==="customer"?S=S.filter(b=>b.customer_name?.toLowerCase().includes(a.toLowerCase())):d.searchType==="phone"&&(S=S.filter(b=>b.customer_phone?.replace(/\D/g,"").includes(a.replace(/\D/g,""))))),S.sort((b,D)=>{const z=b.created_at||b.created_date,V=D.created_at||D.created_date,ae=z?new Date(z).getTime():0;return(V?new Date(V).getTime():0)-ae}),s(S)},g={status:"all",period:"today",searchType:"code",entregador:"all",scheduledHour:"all",paymentMethod:"all",deliveryType:"all",minValue:"",maxValue:"",dateStart:"",dateEnd:"",productName:""},E=()=>{y(g),v(g)};u.useEffect(()=>{try{const d=localStorage.getItem(cs);if(d){const M=JSON.parse(d);m(Array.isArray(M)?M:[])}}catch{}},[]);const p=()=>{const d=(x||"").trim();if(!d){B.error("Digite um nome para a combina√ß√£o");return}const M=[...c.filter(S=>S.name!==d),{name:d,filters:{...l}}];m(M),localStorage.setItem(cs,JSON.stringify(M)),h(""),B.success("Filtros salvos")},w=d=>{y(d.filters),v(d.filters),o(!1),B.success(`Aplicado: ${d.name}`)},L=d=>{const M=c.filter(S=>S.name!==d);m(M),localStorage.setItem(cs,JSON.stringify(M)),B.success("Combina√ß√£o removida")};return K.useEffect(()=>{v(l)},[t,a,l.searchType,l.status,l.period,l.entregador,l.scheduledHour,l.paymentMethod,l.deliveryType,l.minValue,l.maxValue,l.dateStart,l.dateEnd,l.productName]),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px] max-w-md",children:[e.jsx(ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsxs(Oe,{value:l.searchType,onValueChange:d=>k("searchType",d),children:[e.jsx(Re,{className:"absolute left-10 top-1/2 -translate-y-1/2 h-6 w-20 text-xs border-none bg-transparent focus:ring-0 p-0",children:e.jsx(De,{})}),e.jsxs(Me,{children:[e.jsx(de,{value:"code",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:"w-3 h-3"}),"C√≥digo"]})}),e.jsx(de,{value:"customer",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(wa,{className:"w-3 h-3"}),"Cliente"]})}),e.jsx(de,{value:"phone",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ja,{className:"w-3 h-3"}),"Telefone"]})})]})]}),e.jsx(he,{placeholder:`Buscar por ${l.searchType==="code"?"c√≥digo":l.searchType==="customer"?"cliente":"telefone"}...`,value:a,onChange:d=>r(d.target.value),className:"pl-32 h-9"})]}),e.jsxs(rn,{open:i,onOpenChange:o,children:[e.jsx(nn,{asChild:!0,children:e.jsxs(O,{variant:"outline",size:"sm",className:"h-9 relative","data-gestor":"open-filters",children:[e.jsx(xa,{className:"w-4 h-4 mr-2"}),"Filtros",R>0&&e.jsx(ie,{className:"ml-2 h-5 w-5 p-0 flex items-center justify-center text-xs bg-orange-500 text-white",children:R})]})}),e.jsx(on,{className:"w-96 max-h-[80vh] overflow-y-auto",align:"end",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between sticky top-0 bg-white pb-2 border-b",children:[e.jsx("h3",{className:"font-semibold text-sm",children:"Filtros Avan√ßados"}),R>0&&e.jsxs(O,{variant:"ghost",size:"sm",onClick:E,className:"h-7 text-xs text-red-600 hover:text-red-700",children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),"Limpar"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:"Status"}),e.jsxs(Oe,{value:l.status,onValueChange:d=>k("status",d),children:[e.jsx(Re,{className:"h-9",children:e.jsx(De,{})}),e.jsx(Me,{children:oa.map(d=>e.jsx(de,{value:d.value,children:d.label},d.value))})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:[e.jsx(Lt,{className:"w-3 h-3 inline mr-1"}),"Per√≠odo"]}),e.jsxs(Oe,{value:l.period,onValueChange:d=>k("period",d),children:[e.jsx(Re,{className:"h-9",children:e.jsx(De,{})}),e.jsx(Me,{children:la.map(d=>e.jsx(de,{value:d.value,children:d.label},d.value))})]})]}),n.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:"Entregador"}),e.jsxs(Oe,{value:l.entregador,onValueChange:d=>k("entregador",d),children:[e.jsx(Re,{className:"h-9",children:e.jsx(De,{placeholder:"Todos"})}),e.jsxs(Me,{children:[e.jsx(de,{value:"all",children:"Todos"}),n.map(d=>e.jsx(de,{value:String(d.id),children:d.name||d.email},d.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block",children:"Agendado para"}),e.jsxs(Oe,{value:l.scheduledHour,onValueChange:d=>k("scheduledHour",d),children:[e.jsx(Re,{className:"h-9",children:e.jsx(De,{})}),e.jsx(Me,{children:ca.map(d=>e.jsx(de,{value:d.value,children:d.label},d.value))})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block flex items-center gap-1",children:[e.jsx(ln,{className:"w-3 h-3"}),"M√©todo de Pagamento"]}),e.jsxs(Oe,{value:l.paymentMethod,onValueChange:d=>k("paymentMethod",d),children:[e.jsx(Re,{className:"h-9",children:e.jsx(De,{placeholder:"Todos"})}),e.jsxs(Me,{children:[e.jsx(de,{value:"all",children:"Todos"}),e.jsx(de,{value:"pix",children:"PIX"}),e.jsx(de,{value:"dinheiro",children:"Dinheiro"}),e.jsx(de,{value:"cartao_credito",children:"Cart√£o de Cr√©dito"}),e.jsx(de,{value:"cartao_debito",children:"Cart√£o de D√©bito"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-medium text-gray-700 mb-1.5 block flex items-center gap-1",children:[e.jsx($e,{className:"w-3 h-3"}),"Tipo de Entrega"]}),e.jsxs(Oe,{value:l.deliveryType,onValueChange:d=>k("deliveryType",d),children:[e.jsx(Re,{className:"h-9",children:e.jsx(De,{placeholder:"Todos"})}),e.jsxs(Me,{children:[e.jsx(de,{value:"all",children:"Todos"}),e.jsx(de,{value:"delivery",children:"Entrega"}),e.jsx(de,{value:"pickup",children:"Retirada"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsxs(se,{className:"text-xs font-medium text-gray-700 mb-1.5 block flex items-center gap-1",children:[e.jsx(At,{className:"w-3 h-3"}),"Valor M√≠n."]}),e.jsx(he,{type:"number",step:"0.01",placeholder:"0.00",value:l.minValue,onChange:d=>k("minValue",d.target.value),className:"h-9 text-sm"})]}),e.jsxs("div",{children:[e.jsxs(se,{className:"text-xs font-medium text-gray-700 mb-1.5 block flex items-center gap-1",children:[e.jsx(At,{className:"w-3 h-3"}),"Valor M√°x."]}),e.jsx(he,{type:"number",step:"0.01",placeholder:"0.00",value:l.maxValue,onChange:d=>k("maxValue",d.target.value),className:"h-9 text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsxs(se,{className:"text-xs font-medium text-gray-700 mb-1.5 block flex items-center gap-1",children:[e.jsx(Lt,{className:"w-3 h-3"}),"Data In√≠cio"]}),e.jsx(he,{type:"date",value:l.dateStart,onChange:d=>k("dateStart",d.target.value),className:"h-9 text-sm"})]}),e.jsxs("div",{children:[e.jsxs(se,{className:"text-xs font-medium text-gray-700 mb-1.5 block flex items-center gap-1",children:[e.jsx(Lt,{className:"w-3 h-3"}),"Data Fim"]}),e.jsx(he,{type:"date",value:l.dateEnd,onChange:d=>k("dateEnd",d.target.value),className:"h-9 text-sm"})]})]}),e.jsxs("div",{children:[e.jsxs(se,{className:"text-xs font-medium text-gray-700 mb-1.5 block flex items-center gap-1",children:[e.jsx(ve,{className:"w-3 h-3"}),"Produto"]}),e.jsx(he,{placeholder:"Nome do produto...",value:l.productName,onChange:d=>k("productName",d.target.value),className:"h-9 text-sm"})]}),e.jsxs("div",{className:"pt-2 border-t space-y-2",children:[e.jsxs(se,{className:"text-xs font-medium text-gray-700 flex items-center gap-1",children:[e.jsx(Lr,{className:"w-3 h-3"}),"Combina√ß√µes salvas"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(he,{placeholder:"Nome da combina√ß√£o",value:x,onChange:d=>h(d.target.value),className:"h-9 text-sm flex-1"}),e.jsxs(O,{type:"button",size:"sm",variant:"outline",className:"h-9 shrink-0",onClick:p,children:[e.jsx(Ft,{className:"w-3 h-3 mr-1"})," Salvar"]})]}),c.length>0&&e.jsx("ul",{className:"space-y-1",children:c.map(d=>e.jsxs("li",{className:"flex items-center justify-between gap-2 text-sm py-1",children:[e.jsx("button",{type:"button",onClick:()=>w(d),className:"text-left truncate flex-1 text-orange-600 hover:underline",children:d.name}),e.jsx("button",{type:"button",onClick:()=>L(d.name),className:"text-gray-400 hover:text-red-600 p-0.5",title:"Excluir",children:e.jsx(xe,{className:"w-3 h-3"})})]},d.name))})]}),R>0&&e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Filtros ativos:"}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[l.status!=="all"&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:[oa.find(d=>d.value===l.status)?.label,e.jsx("button",{onClick:()=>k("status","all"),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]}),l.period!=="today"&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:[la.find(d=>d.value===l.period)?.label,e.jsx("button",{onClick:()=>k("period","today"),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]}),l.entregador!=="all"&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:[n.find(d=>String(d.id)===l.entregador)?.name||"Entregador",e.jsx("button",{onClick:()=>k("entregador","all"),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]}),l.scheduledHour!=="all"&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:[ca.find(d=>d.value===l.scheduledHour)?.label,e.jsx("button",{onClick:()=>k("scheduledHour","all"),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]}),l.paymentMethod!=="all"&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:[l.paymentMethod==="pix"?"PIX":l.paymentMethod==="dinheiro"?"Dinheiro":l.paymentMethod==="cartao_credito"?"Cart√£o Cr√©dito":"Cart√£o D√©bito",e.jsx("button",{onClick:()=>k("paymentMethod","all"),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]}),l.deliveryType!=="all"&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:[l.deliveryType==="delivery"?"Entrega":"Retirada",e.jsx("button",{onClick:()=>k("deliveryType","all"),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]}),l.minValue&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:["Min: R$ ",parseFloat(l.minValue).toFixed(2),e.jsx("button",{onClick:()=>k("minValue",""),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]}),l.maxValue&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:["M√°x: R$ ",parseFloat(l.maxValue).toFixed(2),e.jsx("button",{onClick:()=>k("maxValue",""),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]}),l.dateStart&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:["De: ",new Date(l.dateStart).toLocaleDateString("pt-BR"),e.jsx("button",{onClick:()=>k("dateStart",""),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]}),l.dateEnd&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:["At√©: ",new Date(l.dateEnd).toLocaleDateString("pt-BR"),e.jsx("button",{onClick:()=>k("dateEnd",""),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]}),l.productName&&e.jsxs(ie,{variant:"outline",className:"text-xs",children:["Produto: ",l.productName,e.jsx("button",{onClick:()=>k("productName",""),className:"ml-1 hover:text-red-600",children:e.jsx(xe,{className:"w-3 h-3"})})]})]})]})]})})]})]})}function ql(){const[t,s]=u.useState("now"),[a,r]=u.useState("kanban"),[n,i]=u.useState(null),[o,c]=u.useState(()=>{try{const T=localStorage.getItem("gestor_notification_config");if(T)return JSON.parse(T).soundEnabled!==!1}catch{}return!0}),[m,x]=u.useState(null),[h,l]=u.useState(""),[y,R]=u.useState([]),[k,v]=u.useState(!1),[g,E]=un("gestor-sidebar-collapsed",!1),[p,w]=u.useState(!1),[L,d]=u.useState([]),[M,S]=u.useState(null),[P,A]=u.useState(!1),[b,D]=u.useState(!1),{requireAuthorization:z,modal:V}=Hr(),ae=u.useRef(!1),Z=u.useRef(null),oe=u.useRef(new Set),le=u.useRef(new Set),ee=He(),{isMaster:_,hasModuleAccess:F,canUpdate:U,loading:te,user:G}=dn(),{slug:N,subscriberEmail:j,inSlugContext:H,loading:J,error:re}=mn(),{canCreateOrder:be,plan:tt,effectiveLimits:st,usage:yt,limitReached:vt}=Fr(),[at,f]=u.useState(!1),q=_||U("gestor_pedidos"),Q=_||F("gestor_pedidos"),C=_?"Admin":"PainelAssinante",$=H&&_&&j?j:void 0,_e=!H||_||(G?.email||"").toLowerCase()===(j||"").toLowerCase()||(G?.subscriber_email||"").toLowerCase()===(j||"").toLowerCase();u.useEffect(()=>{G&&"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()},[G]);const{data:Y=[],isLoading:Ue}=Ae({queryKey:["gestorOrders",$??"me"],queryFn:async()=>{const T=$?{as_subscriber:$}:{};return(await W.entities.Order.list("-created_date",T)).filter(ce=>{const me=ce.order_code?.startsWith("PDV-"),X=ce.delivery_method==="balcao";return!me&&!X})},refetchInterval:3e3}),{data:rt}=Ae({queryKey:["entregadores",$??"me"],queryFn:()=>W.entities.Entregador.list(null,$?{as_subscriber:$}:{}),refetchInterval:3e3,retry:!1}),ze=u.useMemo(()=>rt??[],[rt]),{data:Se=[]}=Ae({queryKey:["store",$??"me"],queryFn:()=>W.entities.Store.list(null,$?{as_subscriber:$}:{})}),ue=Se[0]||{name:"Gestor de Pedidos"};fr(ue);const Ge=()=>{try{const T=localStorage.getItem("gestor_notification_config");if(T){const me=JSON.parse(T);x(me),c(me.soundEnabled!==!1)}const I=localStorage.getItem("gestorSettings");(I?JSON.parse(I):{}).sound_notifications===!1&&c(!1)}catch(T){console.error("Erro ao carregar configura√ß√µes de notifica√ß√£o:",T)}};u.useEffect(()=>{Ge()},[]),u.useEffect(()=>{const T=()=>{Ge()};return window.addEventListener("gestorSettingsUpdated",T),window.addEventListener("gestorNotificationConfigUpdated",T),()=>{window.removeEventListener("gestorSettingsUpdated",T),window.removeEventListener("gestorNotificationConfigUpdated",T)}},[]),u.useEffect(()=>{try{const T=localStorage.getItem("gestorSettings"),I=T?JSON.parse(T):{};if(!I.auto_accept||!Y.length)return;const ce=Math.max(5,Math.min(180,Number(I.default_prep_time)||30)),me=Y.filter(X=>X.status==="new");(async()=>{for(const X of me)if(!le.current.has(X.id)){le.current.add(X.id);try{await W.entities.Order.update(X.id,{status:"accepted",accepted_at:new Date().toISOString(),prep_time:ce},$?{as_subscriber:$}:{}),ee.invalidateQueries({queryKey:["gestorOrders",$??"me"]})}catch{le.current.delete(X.id)}}})()}catch{}},[Y,ee,$]),u.useEffect(()=>{if(!m||Y.length===0||!(X=>m.notifyOnStatus?.[X]!==!1)("new"))return;const I=Y.filter(X=>X.status==="new"),ce=oe.current,me=I.map(X=>X.id).filter(X=>!ce.has(X));I.forEach(X=>ce.add(X.id)),me.length>0&&(o&&m.soundEnabled!==!1&&Ya(),navigator.vibrate&&navigator.vibrate([200,100,200]),m.browserNotificationEnabled!==!1&&"Notification"in window&&Notification.permission==="granted"&&new Notification("Novo Pedido!",{body:`${me.length} novo(s) pedido(s) recebido(s)`,icon:"/favicon.ico",tag:"new-order"}))},[Y,o,m]),u.useEffect(()=>{try{const T=JSON.parse(localStorage.getItem("gestorSettings")||"{}");if(!T.are_you_there_enabled)return;const ce=Math.max(1,Math.min(120,Number(T.are_you_there_minutes)||15))*60*1e3,me=()=>{ae.current||(Z.current&&clearTimeout(Z.current),Z.current=setTimeout(()=>{ae.current||A(!0)},ce))},X=()=>{ae.current||me()};return window.addEventListener("mousemove",X),window.addEventListener("keydown",X),window.addEventListener("click",X),window.addEventListener("scroll",X),me(),()=>{Z.current&&clearTimeout(Z.current),window.removeEventListener("mousemove",X),window.removeEventListener("keydown",X),window.removeEventListener("click",X),window.removeEventListener("scroll",X)}}catch{}},[]),u.useEffect(()=>{const I=setInterval(async()=>{try{const ce=JSON.parse(localStorage.getItem("gestorSettings")||"{}"),me=ce.auto_cancel_mode||"off";if(me==="off")return;const X=Math.max(0,Math.min(60,Number(ce.auto_cancel_minutes)??10)),Zt=new Date;let es=!1;for(const Pe of Y){if(!Pe.accepted_at||["delivered","cancelled"].includes(Pe.status))continue;const jt=new Date(Pe.accepted_at),As=Pe.prep_time||30;if(!((Zt-jt)/1e3/60<=As+X)){if(me==="alert"){B(`Pedido ${Pe.order_code||Pe.id} atrasado (prep ${As} min + ${X} min)`,{icon:"‚ö†Ô∏è",duration:5e3});continue}await W.entities.Order.update(Pe.id,{status:"cancelled",rejection_reason:"Cancelado automaticamente por atraso (tempo de preparo excedido)"},$?{as_subscriber:$}:{}),es=!0}}es&&ee.invalidateQueries({queryKey:["gestorOrders",$??"me"]})}catch{}},6e4);return()=>clearInterval(I)},[Y,ee,$]);const Ya=()=>{try{const{url:T,volume:I}=xi(),ce=new Audio(T);ce.volume=I,ce.play().catch(()=>{})}catch{}};u.useEffect(()=>{const T=I=>{if(!((I.target.tagName==="INPUT"||I.target.tagName==="TEXTAREA"||I.target.isContentEditable)&&!(I.ctrlKey||I.metaKey))){if(I.key==="Escape"){b?D(!1):n?i(null):k&&v(!1);return}if((I.ctrlKey||I.metaKey)&&I.key==="f"){I.preventDefault(),document.querySelector('input[placeholder*="Buscar"]')?.focus();return}if((I.ctrlKey||I.metaKey)&&I.key==="r"){I.preventDefault(),ee.invalidateQueries({queryKey:["gestorOrders",$??"me"]}),B.success("Pedidos atualizados!");return}if(I.target.tagName!=="INPUT"&&I.target.tagName!=="TEXTAREA"&&!I.target.isContentEditable){if(I.key==="k"||I.key==="K"){I.preventDefault(),r("kanban"),B.success("Quadros",{duration:1e3});return}if(I.key==="d"||I.key==="D"){I.preventDefault(),r("delivery"),B.success("Entregadores",{duration:1e3});return}if((I.key==="r"||I.key==="R")&&!(I.ctrlKey||I.metaKey)){I.preventDefault(),r("resumo"),B.success("Resumo",{duration:1e3});return}if((I.key==="s"||I.key==="S")&&!(I.ctrlKey||I.metaKey)){I.preventDefault(),r("settings"),B.success("Ajustes",{duration:1e3});return}if(I.key==="h"||I.key==="H"){I.preventDefault(),r("inicio"),B.success("In√≠cio",{duration:1e3});return}if(I.key==="n"||I.key==="N"){I.preventDefault(),w(!p),B.success(p?"Mostrando todos":"S√≥ novos",{duration:1e3});return}}if(n&&["1","2","3","4","5"].includes(I.key)){S({1:"accepted",2:"preparing",3:"ready",4:"out_for_delivery",5:"delivered"}[I.key]);return}if(I.shiftKey&&I.key==="F"){I.preventDefault(),document.querySelector('[data-gestor="open-filters"]')?.click();return}}};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[n,k,b,p,ee,a]);const Xt=u.useMemo(()=>Y.filter(T=>{const I=T.scheduled_date&&T.scheduled_time;return t==="now"?!I||I&&T.status!=="new":t==="scheduled"?I&&T.status==="new":!0}),[Y,t]),Ja=u.useMemo(()=>{const T=Y.filter(ce=>ce.accepted_at&&ce.ready_at);if(T.length===0)return 30;const I=T.reduce((ce,me)=>ce+(new Date(me.ready_at)-new Date(me.accepted_at))/6e4,0)/T.length;return Math.max(5,Math.min(180,Math.round(I)))||30},[Y]),Xa=p?y.filter(T=>T.status==="new"):y,ge=Y.filter(T=>T.status==="new").length;u.useEffect(()=>{h||R(Xt)},[h,Xt]);const Za=T=>{R(T)},er=()=>E(T=>!T);if(te)return e.jsx(ia,{});if(!G)return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900 p-4",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Sess√£o expirada ou n√£o autenticado."}),e.jsx(Qe,{to:"/login",children:e.jsx(O,{className:"bg-orange-500 hover:bg-orange-600",children:"Fazer login"})})]});if(H&&J)return e.jsx(ia,{});if(H&&re)return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-md text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Link n√£o encontrado."}),e.jsx(Qe,{to:"/",children:e.jsx(O,{children:"Ir ao card√°pio"})})]})});if(H&&j&&!_e)return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-md text-center",children:[e.jsx(Os,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Acesso negado"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Voc√™ n√£o tem permiss√£o para acessar o Gestor deste estabelecimento."}),e.jsx(Qe,{to:"/",className:"mt-4 inline-block",children:e.jsx(O,{variant:"outline",children:"Voltar"})})]})});if(!Q)return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-md text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Os,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Gestor de Pedidos Avan√ßado"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["No plano B√°sico use o ",e.jsx("strong",{children:"Gestor de pedidos"})," no painel (aba Opera√ß√£o). Esta tela avan√ßada est√° dispon√≠vel nos planos Pro e Ultra."]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Qe,{to:ts("PainelAssinante",N||void 0),children:e.jsx(O,{className:"w-full bg-orange-500 hover:bg-orange-600",children:"Voltar ao Painel"})}),e.jsx(Qe,{to:ts("Cardapio",N||void 0),children:e.jsx(O,{variant:"outline",className:"w-full",children:"Ver Card√°pio"})})]})]})});const Es=ts(C,_?void 0:N||void 0);return e.jsxs("div",{className:"min-h-screen min-h-screen-mobile bg-gray-50 flex flex-col",children:[e.jsx(sr,{position:"top-center"}),e.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 h-14 flex-shrink-0",children:e.jsx("div",{className:"px-4 h-full",children:e.jsxs("div",{className:"flex items-center justify-between h-full max-w-screen-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(Qe,{to:Es,className:"lg:hidden flex-shrink-0",children:e.jsx(O,{variant:"ghost",size:"icon",className:"h-9 w-9",children:ue.logo?e.jsx("img",{src:ue.logo,alt:ue.name,className:"w-8 h-8 rounded-lg object-cover"}):e.jsx(ve,{className:"w-5 h-5 text-orange-500"})})}),e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[ue.logo?e.jsx("img",{src:ue.logo,alt:ue.name,className:"w-10 h-10 rounded-lg object-cover flex-shrink-0"}):e.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(ve,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"font-semibold text-base truncate",children:ue.name}),e.jsx("p",{className:`text-xs font-medium ${ue.is_open?"text-green-600":"text-red-600"}`,children:ue.is_open?"Loja aberta":"Loja fechada"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx(xn,{pageName:"Gestor",compact:!0}),e.jsx(O,{variant:"ghost",size:"icon",className:"h-9 w-9 min-h-touch min-w-touch",onClick:()=>c(!o),title:o?"Desligar som":"Ligar som",children:o?e.jsx(Na,{className:"w-4 h-4 text-gray-600"}):e.jsx(Pn,{className:"w-4 h-4 text-gray-400"})}),e.jsx(O,{variant:"ghost",size:"icon",className:"h-9 w-9 min-h-touch min-w-touch",onClick:()=>ee.invalidateQueries({queryKey:["gestorOrders",$??"me"]}),title:"Atualizar",children:e.jsx(ds,{className:`w-4 h-4 text-gray-600 ${Ue?"animate-spin":""}`})}),e.jsx(O,{variant:"ghost",size:"icon",className:"h-9 w-9 min-h-touch min-w-touch hidden sm:flex",onClick:()=>r("resumo"),title:"Resumo",children:e.jsx(yn,{className:"w-4 h-4 text-gray-600"})}),e.jsxs(or,{children:[e.jsx(lr,{asChild:!0,children:e.jsx(O,{variant:"ghost",size:"icon",className:"h-9 w-9 min-h-touch min-w-touch",title:"Ferramentas",children:e.jsx(wn,{className:"w-4 h-4 text-gray-600"})})}),e.jsxs(cr,{align:"end",className:"min-w-[200px]",children:[q&&e.jsxs(e.Fragment,{children:[e.jsxs(We,{onClick:()=>z("exportar",()=>{zr(y,`pedidos_${new Date().toISOString().slice(0,10)}.csv`),B.success("CSV baixado")}),children:[e.jsx(hn,{className:"w-4 h-4 mr-2"}),"Exportar CSV"]}),e.jsx(We,{onClick:()=>z("exportar",()=>{as(Y,"today"),B.success("PDF baixado")}),children:"Relat√≥rio do dia (PDF)"}),e.jsx(We,{onClick:()=>z("exportar",()=>{as(Y,"week"),B.success("PDF baixado")}),children:"√öltimos 7 dias (PDF)"}),e.jsx(We,{onClick:()=>z("exportar",()=>{as(Y,"month"),B.success("PDF baixado")}),children:"√öltimos 30 dias (PDF)"})]}),e.jsxs(We,{onClick:()=>D(!0),children:[e.jsx(Bs,{className:"w-4 h-4 mr-2"}),"Atalhos de teclado"]}),e.jsx(We,{asChild:!0,children:e.jsxs("a",{href:"#suporte",className:"flex items-center",children:[e.jsx(pn,{className:"w-4 h-4 mr-2"}),"Suporte"]})}),e.jsxs(We,{disabled:!0,title:"Em breve",children:[e.jsx(gn,{className:"w-4 h-4 mr-2 opacity-50"}),"Chat"]})]})]}),e.jsx(Qe,{to:Es,className:"hidden lg:inline-flex",children:e.jsx(O,{variant:"outline",size:"sm",className:"h-9",children:"Voltar"})}),e.jsx(cn,{})]})]})})}),a==="kanban"&&e.jsx("div",{className:"bg-white border-b border-gray-200 flex-shrink-0",children:e.jsx("div",{className:"px-4 max-w-screen-2xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex",children:[e.jsx("button",{onClick:()=>s("now"),className:`px-5 py-2.5 font-medium text-sm border-b-2 transition-colors ${t==="now"?"border-orange-500 text-orange-500":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Agora"}),e.jsx("button",{onClick:()=>s("scheduled"),className:`px-5 py-2.5 font-medium text-sm border-b-2 transition-colors ${t==="scheduled"?"border-orange-500 text-orange-500":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Agendados"})]}),e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>v(!0),className:"lg:hidden",children:e.jsx(qs,{className:"w-5 h-5"})})]})})}),e.jsx("aside",{className:`hidden lg:block fixed left-0 top-14 h-[calc(100vh-3.5rem)] bg-white border-r border-gray-200 z-40 transition-all duration-300 ease-in-out ${g?"w-14":"w-52"}`,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"p-2 border-b",children:e.jsx("button",{onClick:er,className:"w-full flex items-center justify-center py-1.5 rounded-md text-gray-400 hover:text-gray-600 hover:bg-gray-50 transition-all",title:g?"Expandir":"Recolher",children:e.jsx(fn,{className:`w-4 h-4 transition-transform duration-300 ${g?"rotate-180":""}`})})}),e.jsxs("nav",{className:"flex-1 p-1.5 space-y-0.5 overflow-y-auto",children:[e.jsxs("button",{onClick:()=>r("inicio"),className:`w-full flex items-center gap-2 px-2 py-2 rounded-r-md border-l-4 transition-all duration-200 ${a==="inicio"?"border-orange-500 bg-orange-50 text-orange-600":"border-transparent text-gray-600 hover:bg-gray-50"}`,title:g?"In√≠cio":"",children:[e.jsx(Ds,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:`text-sm font-medium whitespace-nowrap transition-all duration-300 ${g?"opacity-0 w-0 overflow-hidden":"opacity-100"}`,children:"In√≠cio"})]}),e.jsxs("button",{onClick:()=>r("kanban"),className:`relative w-full flex items-center gap-2 px-2 py-2 rounded-r-md border-l-4 transition-all duration-200 ${a==="kanban"?"border-orange-500 bg-orange-50 text-orange-600":"border-transparent text-gray-600 hover:bg-gray-50"}`,title:g?ge?`Quadros (${ge} novos)`:"Quadros":"",children:[e.jsx(Mt,{className:"w-4 h-4 flex-shrink-0"}),ge>0&&e.jsx("span",{className:"absolute left-6 top-1.5 min-w-[18px] h-[18px] rounded-full bg-orange-500 text-white text-xs font-bold flex items-center justify-center",children:ge>99?"99+":ge}),e.jsxs("span",{className:`text-sm font-medium whitespace-nowrap transition-all duration-300 ${g?"opacity-0 w-0 overflow-hidden":"opacity-100"}`,children:["Quadros ",ge>0&&!g?`(${ge})`:""]})]}),e.jsxs("button",{onClick:()=>r("delivery"),className:`w-full flex items-center gap-2 px-2 py-2 rounded-r-md border-l-4 transition-all duration-200 ${a==="delivery"?"border-orange-500 bg-orange-50 text-orange-600":"border-transparent text-gray-600 hover:bg-gray-50"}`,title:g?"Entregadores":"",children:[e.jsx($e,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:`text-sm font-medium whitespace-nowrap transition-all duration-300 ${g?"opacity-0 w-0 overflow-hidden":"opacity-100"}`,children:"Entregadores"})]}),e.jsxs("button",{onClick:()=>r("resumo"),className:`w-full flex items-center gap-2 px-2 py-2 rounded-r-md border-l-4 transition-all duration-200 ${a==="resumo"?"border-orange-500 bg-orange-50 text-orange-600":"border-transparent text-gray-600 hover:bg-gray-50"}`,title:g?"Resumo":"",children:[e.jsx(At,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:`text-sm font-medium whitespace-nowrap transition-all duration-300 ${g?"opacity-0 w-0 overflow-hidden":"opacity-100"}`,children:"Resumo"})]}),e.jsxs("button",{onClick:()=>r("settings"),className:`w-full flex items-center gap-2 px-2 py-2 rounded-r-md border-l-4 transition-all duration-200 ${a==="settings"?"border-orange-500 bg-orange-50 text-orange-600":"border-transparent text-gray-600 hover:bg-gray-50"}`,title:g?"Ajustes":"",children:[e.jsx(Ks,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:`text-sm font-medium whitespace-nowrap transition-all duration-300 ${g?"opacity-0 w-0 overflow-hidden":"opacity-100"}`,children:"Ajustes"})]})]}),e.jsx("div",{className:"p-2 border-t",children:g?e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-7 h-7 rounded-full bg-orange-500 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-white",children:Y.filter(T=>!["delivered","cancelled"].includes(T.status)).length})})}):e.jsxs("div",{className:"text-center py-1",children:[e.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-wide",children:"Ativos"}),e.jsx("p",{className:"text-xl font-bold text-orange-500",children:Y.filter(T=>!["delivered","cancelled"].includes(T.status)).length})]})})]})}),k&&e.jsx("div",{className:"lg:hidden fixed inset-0 z-50 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:()=>v(!1),children:e.jsxs("div",{className:"w-72 h-full bg-white shadow-2xl animate-in slide-in-from-left duration-300",onClick:T=>T.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qs,{className:"w-5 h-5"}),e.jsx("h2",{className:"font-bold",children:"Menu"})]}),e.jsx("button",{onClick:()=>v(!1),className:"min-h-touch min-w-touch flex items-center justify-center p-2 -m-1 rounded-lg hover:bg-white/20 transition-colors","aria-label":"Fechar menu",children:e.jsx(xe,{className:"w-5 h-5"})})]}),e.jsxs("nav",{className:"p-3 space-y-2",children:[e.jsxs("button",{onClick:()=>{r("inicio"),v(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${a==="inicio"?"bg-orange-500 text-white shadow-sm":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx(Ds,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"In√≠cio"}),a==="inicio"&&e.jsx(fe,{className:"w-4 h-4 ml-auto"})]}),e.jsxs("button",{onClick:()=>{r("kanban"),v(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${a==="kanban"?"bg-orange-500 text-white shadow-sm":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx(Mt,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Quadros"}),ge>0&&e.jsx("span",{className:"ml-auto min-w-[22px] h-[22px] rounded-full bg-orange-500 text-white text-xs font-bold flex items-center justify-center",children:ge>99?"99+":ge}),a==="kanban"&&ge===0&&e.jsx(fe,{className:"w-4 h-4 ml-auto"})]}),e.jsxs("button",{onClick:()=>{r("delivery"),v(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${a==="delivery"?"bg-orange-500 text-white shadow-sm":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx($e,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Entregadores"}),a==="delivery"&&e.jsx(fe,{className:"w-4 h-4 ml-auto"})]}),e.jsxs("button",{onClick:()=>{r("resumo"),v(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${a==="resumo"?"bg-orange-500 text-white shadow-sm":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx(At,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Resumo"}),a==="resumo"&&e.jsx(fe,{className:"w-4 h-4 ml-auto"})]}),e.jsxs("button",{onClick:()=>{r("settings"),v(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${a==="settings"?"bg-orange-500 text-white shadow-sm":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx(Ks,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Ajustes"}),a==="settings"&&e.jsx(fe,{className:"w-4 h-4 ml-auto"})]})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 pt-4 pb-[max(1rem,env(safe-area-inset-bottom))] border-t bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-center",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Pedidos Ativos"}),e.jsx("p",{className:"text-xl font-bold text-orange-500",children:Y.filter(T=>!["delivered","cancelled"].includes(T.status)).length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Novos"}),e.jsx("p",{className:"text-xl font-bold text-orange-500",children:Y.filter(T=>T.status==="new").length})]})]})})]})}),e.jsx("main",{className:`flex-1 transition-all duration-300 pb-20 lg:pb-0 ${g?"lg:ml-14":"lg:ml-52"}`,children:e.jsxs("div",{className:`mx-auto p-4 xl:pr-14 ${a==="kanban"||a==="delivery"?"max-w-screen-2xl":"max-w-[1240px]"}`,children:[a!=="kanban"&&e.jsx("div",{className:"mb-3",children:e.jsxs(O,{variant:"outline",size:"sm",className:"gap-1.5",onClick:()=>r("kanban"),children:[e.jsx(Mt,{className:"w-4 h-4"}),"Voltar para Quadros"]})}),e.jsxs("p",{className:"text-xs text-gray-500 mb-2 font-medium",children:[a==="inicio"&&"In√≠cio",a==="kanban"&&`Quadros ‚Ä¢ ${t==="now"?"Agora":"Agendados"}`,a==="delivery"&&"Entregadores",a==="resumo"&&"Resumo financeiro",a==="settings"&&"Ajustes"]}),a==="inicio"&&e.jsx(xo,{onNavigate:r}),a==="kanban"&&e.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center gap-3 flex-wrap",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx(ho,{orders:Xt,onFilterChange:Za,searchTerm:h,onSearchChange:l,entregadores:ze})}),e.jsxs(O,{variant:p?"default":"outline",size:"sm",onClick:()=>w(!p),className:"h-9 shrink-0",title:"S√≥ novos",children:[e.jsx(Pt,{className:"w-4 h-4 mr-1"}),"S√≥ novos ",Y.filter(T=>T.status==="new").length>0&&`(${Y.filter(T=>T.status==="new").length})`]})]}),a==="kanban"&&e.jsx(Rn,{orders:Xa,onSelectOrder:i,darkMode:!1,isLoading:Ue}),a==="kanban"&&e.jsx("div",{className:"mt-6",children:e.jsx(no,{orders:Y,entregadores:ze,darkMode:!1})}),a==="resumo"&&e.jsx(Br,{orders:Y}),a==="delivery"&&e.jsx(Gn,{entregadores:ze,orders:Y,stores:Se}),a==="settings"&&e.jsx(gi,{})]})}),e.jsxs("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-30 bg-white border-t border-gray-200 safe-bottom flex",children:[e.jsxs("button",{onClick:()=>r("kanban"),className:`relative flex-1 flex flex-col items-center justify-center py-3 min-h-touch gap-0.5 ${a==="kanban"?"text-orange-500 bg-orange-50 font-semibold":"text-gray-500"}`,children:[e.jsx(Mt,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"Quadros"}),ge>0&&e.jsx("span",{className:"absolute top-2 right-1/3 min-w-[18px] h-[18px] rounded-full bg-orange-500 text-white text-[10px] font-bold flex items-center justify-center",children:ge>99?"99+":ge})]}),e.jsxs("button",{onClick:()=>r("delivery"),className:`flex-1 flex flex-col items-center justify-center py-3 min-h-touch gap-0.5 ${a==="delivery"?"text-orange-500 bg-orange-50 font-semibold":"text-gray-500"}`,children:[e.jsx($e,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"Entregadores"})]})]}),e.jsx("footer",{className:"hidden lg:block flex-shrink-0 border-t border-gray-200 bg-gray-100 py-2 px-4",children:e.jsxs("div",{className:"max-w-screen-2xl mx-auto flex items-center justify-center gap-2 text-sm text-gray-600",children:[e.jsx(Ct,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{children:[ar," ‚Ä¢ Gestor de Pedidos"]})]})}),e.jsx("a",{href:"#avalie",className:"fixed right-0 top-1/2 -translate-y-1/2 z-40 hidden xl:flex items-center justify-center w-10 h-24 bg-gray-800 hover:bg-gray-700 text-white text-xs font-medium rounded-l-lg shadow-lg writing-mode-vertical cursor-pointer",style:{writingMode:"vertical-rl",textOrientation:"mixed"},title:"Avalie a plataforma",children:"Avalie a plataforma"}),L.length>0&&e.jsxs("button",{onClick:()=>{qr(Y,L),d([]),B.success(`${L.length} comanda(s) enviada(s) para impress√£o`)},className:"fixed right-4 z-50 flex items-center gap-2 bg-orange-500 hover:bg-orange-600 text-white px-4 py-3 rounded-xl shadow-lg bottom-20 lg:bottom-6",children:[e.jsx(Et,{className:"w-5 h-5"}),"Imprimir ",L.length," comanda(s)"]}),e.jsx(je,{open:P,onOpenChange:T=>{T||A(!1)},children:e.jsxs(Ne,{className:"max-w-sm",children:[e.jsx(we,{children:"Voc√™ ainda est√° a√≠?"}),e.jsx("p",{className:"text-sm text-gray-600",children:"O gestor est√° pausado. Toque em Continuar para seguir recebendo avisos."}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(O,{onClick:()=>A(!1),className:"flex-1 bg-orange-500 hover:bg-orange-600 uppercase font-bold",children:"Continuar"}),e.jsx(O,{variant:"outline",onClick:()=>{ae.current=!0,A(!1)},className:"flex-1",children:"Desligar (sess√£o)"})]})]})}),e.jsx(je,{open:b,onOpenChange:D,children:e.jsxs(Ne,{className:"sm:max-w-md",children:[e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(Bs,{className:"w-5 h-5 text-orange-500"}),"Atalhos de teclado"]}),e.jsxs("div",{className:"grid gap-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"K"})," Quadros"]}),e.jsxs("p",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"D"})," Entregadores"]}),e.jsxs("p",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"R"})," Resumo"]}),e.jsxs("p",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"S"})," Ajustes"]}),e.jsxs("p",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"H"})," In√≠cio"]}),e.jsxs("p",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"N"})," S√≥ novos"]}),e.jsxs("p",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"1"}),"-",e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"5"})," Status (com modal aberto)"]}),e.jsxs("p",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"Ctrl+F"})," Buscar"]}),e.jsxs("p",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"Ctrl+R"})," Atualizar"]}),e.jsxs("p",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-gray-100 font-mono",children:"Esc"})," Fechar modal"]})]})]})}),V,n&&e.jsx(In,{order:n,entregadores:ze,onClose:()=>i(null),onUpdate:T=>{ee.invalidateQueries({queryKey:["gestorOrders",$??"me"]}),i(T??null)},user:G,asSub:$,suggestedPrepTime:Ja,quickStatusKey:M,onClearQuickStatus:()=>S(null),onViewMap:()=>{r("delivery"),i(null)},onDuplicate:T=>{z("duplicar",async()=>{if(!be){f(!0);return}const{id:I,order_code:ce,created_date:me,delivered_at:X,accepted_at:Zt,ready_at:es,...Pe}=T;try{const jt={...Pe,status:"new",created_date:new Date().toISOString(),...$&&{as_subscriber:$}};await W.entities.Order.create(jt),ee.invalidateQueries({queryKey:["gestorOrders",$??"me"]}),B.success("Pedido duplicado."),i(null)}catch(jt){B.error(jt?.message||"Erro ao duplicar.")}})},onAddToPrintQueue:()=>d(T=>T.includes(n.id)?T:[...T,n.id])}),!_&&e.jsx(Kr,{open:at,onOpenChange:f,type:"orders",plan:tt,limit:st?.orders_per_month??0,used:yt?.ordersCurrentMonth??0,suggestion:vt?.orders?"Pro libera at√© 3.000 pedidos/m√™s e equipe de 5 pessoas.":void 0})]})}export{ql as default};
